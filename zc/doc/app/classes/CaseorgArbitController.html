<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE html 
     PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
     "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <title>Class: CaseorgArbitController</title>
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
  <meta http-equiv="Content-Script-Type" content="text/javascript" />
  <link rel="stylesheet" href=".././rdoc-style.css" type="text/css" media="screen" />
  <script type="text/javascript">
  // <![CDATA[

  function popupCode( url ) {
    window.open(url, "Code", "resizable=yes,scrollbars=yes,toolbar=no,status=no,height=150,width=400")
  }

  function toggleCode( id ) {
    if ( document.getElementById )
      elem = document.getElementById( id );
    else if ( document.all )
      elem = eval( "document.all." + id );
    else
      return false;

    elemStyle = elem.style;
    
    if ( elemStyle.display != "block" ) {
      elemStyle.display = "block"
    } else {
      elemStyle.display = "none"
    }

    return true;
  }
  
  // Make codeblocks hidden by default
  document.writeln( "<style type=\"text/css\">div.method-source-code { display: none }</style>" )
  
  // ]]>
  </script>

</head>
<body>



    <div id="classHeader">
        <table class="header-table">
        <tr class="top-aligned-row">
          <td><strong>Class</strong></td>
          <td class="class-name-in-header">CaseorgArbitController</td>
        </tr>
        <tr class="top-aligned-row">
            <td><strong>In:</strong></td>
            <td>
                <a href="../files/app/controllers/caseorg_arbit_controller_rb.html">
                app/controllers/caseorg_arbit_controller.rb
                </a>
        <br />
            </td>
        </tr>

        <tr class="top-aligned-row">
            <td><strong>Parent:</strong></td>
            <td>
                <a href="ApplicationController.html">
                ApplicationController
               </a>
            </td>
        </tr>
        </table>
    </div>
  <!-- banner header -->

  <div id="bodyContent">



  <div id="contextContent">

    <div id="description">
      <p>
2009-12-9 niell 仲裁员信息
</p>

    </div>


   </div>

    <div id="method-list">
      <h3 class="section-bar">Methods</h3>

      <div class="name-list">
      <a href="#M001629">arbitman_create</a>&nbsp;&nbsp;
      <a href="#M001630">arbitman_delete</a>&nbsp;&nbsp;
      <a href="#M001626">arbitman_list</a>&nbsp;&nbsp;
      <a href="#M001628">arbitman_new</a>&nbsp;&nbsp;
      <a href="#M001659">book_create</a>&nbsp;&nbsp;
      <a href="#M001662">book_delete</a>&nbsp;&nbsp;
      <a href="#M001666">book_destroy</a>&nbsp;&nbsp;
      <a href="#M001665">book_down</a>&nbsp;&nbsp;
      <a href="#M001660">book_edit</a>&nbsp;&nbsp;
      <a href="#M001657">book_list</a>&nbsp;&nbsp;
      <a href="#M001658">book_new</a>&nbsp;&nbsp;
      <a href="#M001661">book_update</a>&nbsp;&nbsp;
      <a href="#M001663">book_upload</a>&nbsp;&nbsp;
      <a href="#M001664">book_upload_do</a>&nbsp;&nbsp;
      <a href="#M001647">change_create</a>&nbsp;&nbsp;
      <a href="#M001650">change_delete</a>&nbsp;&nbsp;
      <a href="#M001648">change_edit</a>&nbsp;&nbsp;
      <a href="#M001645">change_list</a>&nbsp;&nbsp;
      <a href="#M001646">change_new</a>&nbsp;&nbsp;
      <a href="#M001649">change_update</a>&nbsp;&nbsp;
      <a href="#M001641">disc_create</a>&nbsp;&nbsp;
      <a href="#M001644">disc_delete</a>&nbsp;&nbsp;
      <a href="#M001642">disc_edit</a>&nbsp;&nbsp;
      <a href="#M001639">disc_list</a>&nbsp;&nbsp;
      <a href="#M001640">disc_new</a>&nbsp;&nbsp;
      <a href="#M001643">disc_update</a>&nbsp;&nbsp;
      <a href="#M001633">evite_create</a>&nbsp;&nbsp;
      <a href="#M001638">evite_delete</a>&nbsp;&nbsp;
      <a href="#M001634">evite_edit</a>&nbsp;&nbsp;
      <a href="#M001631">evite_list</a>&nbsp;&nbsp;
      <a href="#M001632">evite_new</a>&nbsp;&nbsp;
      <a href="#M001635">evite_update</a>&nbsp;&nbsp;
      <a href="#M001625">list</a>&nbsp;&nbsp;
      <a href="#M001627">rate_set</a>&nbsp;&nbsp;
      <a href="#M001653">reason_create</a>&nbsp;&nbsp;
      <a href="#M001656">reason_delete</a>&nbsp;&nbsp;
      <a href="#M001654">reason_edit</a>&nbsp;&nbsp;
      <a href="#M001651">reason_list</a>&nbsp;&nbsp;
      <a href="#M001652">reason_new</a>&nbsp;&nbsp;
      <a href="#M001655">reason_update</a>&nbsp;&nbsp;
      <a href="#M001636">remind_change</a>&nbsp;&nbsp;
      <a href="#M001637">remind_update</a>&nbsp;&nbsp;
      </div>
    </div>

  </div>


    <!-- if includes -->

    <div id="section">





      


    <!-- if method_list -->
    <div id="methods">
      <h3 class="section-bar">Public Instance methods</h3>

      <div id="method-M001629" class="method-detail">
        <a name="M001629"></a>

        <div class="method-heading">
          <a href="#M001629" class="method-signature">
          <span class="method-name">arbitman_create</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M001629-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M001629-source">
<pre>
    <span class="ruby-comment cmt"># File app/controllers/caseorg_arbit_controller.rb, line 57</span>
57:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">arbitman_create</span>
58:     <span class="ruby-ivar">@arbitman</span>=<span class="ruby-constant">TbCasearbitman</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">params</span>[<span class="ruby-identifier">:arbitman</span>])
59:     <span class="ruby-ivar">@arbitman</span>.<span class="ruby-identifier">recevice_code</span>=<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]
60:     <span class="ruby-ivar">@arbitman</span>.<span class="ruby-identifier">case_code</span>=<span class="ruby-constant">TbCase</span>.<span class="ruby-identifier">find_by_recevice_code</span>(<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]).<span class="ruby-identifier">case_code</span>
61:     <span class="ruby-ivar">@arbitman</span>.<span class="ruby-identifier">general_code</span>=<span class="ruby-constant">TbCase</span>.<span class="ruby-identifier">find_by_recevice_code</span>(<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]).<span class="ruby-identifier">general_code</span>
62:     <span class="ruby-ivar">@arbitman</span>.<span class="ruby-identifier">org_id</span>=<span class="ruby-identifier">params</span>[<span class="ruby-identifier">:org_id</span>]
63:     <span class="ruby-ivar">@arbitman</span>.<span class="ruby-identifier">u</span>=<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:user_code</span>]
64:     <span class="ruby-ivar">@arbitman</span>.<span class="ruby-identifier">u_t</span>=<span class="ruby-constant">Time</span>.<span class="ruby-identifier">now</span>()
65:     <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@arbitman</span>.<span class="ruby-identifier">save</span>
66:       <span class="ruby-identifier">flash</span>[<span class="ruby-identifier">:notice</span>]=<span class="ruby-value str">&quot;创建成功&quot;</span>
67:       <span class="ruby-identifier">redirect_to</span> <span class="ruby-identifier">:action=</span><span class="ruby-operator">&gt;</span><span class="ruby-value str">&quot;arbitman_list&quot;</span>,<span class="ruby-identifier">:org_id=</span><span class="ruby-operator">&gt;</span><span class="ruby-identifier">params</span>[<span class="ruby-identifier">:org_id</span>],<span class="ruby-identifier">:recevice_code=</span><span class="ruby-operator">&gt;</span><span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]
68:     <span class="ruby-keyword kw">else</span>
69:       <span class="ruby-identifier">flash</span>[<span class="ruby-identifier">:notice</span>]=<span class="ruby-value str">&quot;创建失败&quot;</span>
70:       <span class="ruby-identifier">render</span> <span class="ruby-identifier">:action=</span><span class="ruby-operator">&gt;</span><span class="ruby-value str">&quot;arbitman_new&quot;</span> ,<span class="ruby-identifier">:org_id=</span><span class="ruby-operator">&gt;</span><span class="ruby-identifier">params</span>[<span class="ruby-identifier">:org_id</span>],<span class="ruby-identifier">:recevice_code=</span><span class="ruby-operator">&gt;</span><span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]
71:     <span class="ruby-keyword kw">end</span>
72:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M001630" class="method-detail">
        <a name="M001630"></a>

        <div class="method-heading">
          <a href="#M001630" class="method-signature">
          <span class="method-name">arbitman_delete</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
def arbitman_edit
</p>
<pre>
  @arbitman_now=TbArbitmannow.find_by_sql(&quot;select tb_arbitmen.code as code ,tb_arbitmen.name as name from tb_arbitmen,tb_arbitmannows where tb_arbitmen.code=tb_arbitmannows.arbitman_num order by tb_arbitmen.name&quot;)
  @arbitman=TbCasearbitman.find(params[:id])
</pre>
<p>
end
</p>
<p>
def arbitman_update
</p>
<pre>
  @arbitman=TbCasearbitman.find(params[:id])
  @arbitman.u=session[:user_code]
  @arbitman.u_t=Time.now()
  if @arbitman.update_attributes(params[:arbitman])
    flash[:notice]=&quot;修改成功&quot;
    redirect_to :action=&gt;&quot;arbitman_list&quot;,:org_id=&gt;params[:org_id]
  else
    flash[:notice]=&quot;修改失败&quot;
    render :action=&gt;&quot;arbitman_edit&quot;,:id=&gt;params[:id],:org_id=&gt;params[:org_id]
  end
</pre>
<p>
end
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M001630-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M001630-source">
<pre>
     <span class="ruby-comment cmt"># File app/controllers/caseorg_arbit_controller.rb, line 93</span>
 93:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">arbitman_delete</span>
 94:     <span class="ruby-ivar">@arbitman</span>=<span class="ruby-constant">TbCasearbitman</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">params</span>[<span class="ruby-identifier">:id</span>])
 95:     <span class="ruby-ivar">@arbitman</span>.<span class="ruby-identifier">used</span>=<span class="ruby-value str">&quot;N&quot;</span>
 96:     <span class="ruby-ivar">@arbitman</span>.<span class="ruby-identifier">u</span>=<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:user_code</span>]
 97:     <span class="ruby-ivar">@arbitman</span>.<span class="ruby-identifier">u_t</span>=<span class="ruby-constant">Time</span>.<span class="ruby-identifier">now</span>()
 98:     <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@arbitman</span>.<span class="ruby-identifier">save</span>
 99:       <span class="ruby-identifier">flash</span>[<span class="ruby-identifier">:notice</span>]=<span class="ruby-value str">&quot;删除成功&quot;</span>
100:     <span class="ruby-keyword kw">else</span>
101:       <span class="ruby-identifier">flash</span>[<span class="ruby-identifier">:notice</span>]=<span class="ruby-value str">&quot;删除失败&quot;</span>
102:     <span class="ruby-keyword kw">end</span>
103:     <span class="ruby-identifier">redirect_to</span> <span class="ruby-identifier">:action=</span><span class="ruby-operator">&gt;</span><span class="ruby-value str">&quot;arbitman_list&quot;</span>,<span class="ruby-identifier">:org_id=</span><span class="ruby-operator">&gt;</span><span class="ruby-identifier">params</span>[<span class="ruby-identifier">:org_id</span>],<span class="ruby-identifier">:recevice_code=</span><span class="ruby-operator">&gt;</span><span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]
104:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M001626" class="method-detail">
        <a name="M001626"></a>

        <div class="method-heading">
          <a href="#M001626" class="method-signature">
          <span class="method-name">arbitman_list</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M001626-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M001626-source">
<pre>
    <span class="ruby-comment cmt"># File app/controllers/caseorg_arbit_controller.rb, line 30</span>
30:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">arbitman_list</span>
31:     <span class="ruby-ivar">@case</span>=<span class="ruby-keyword kw">nil</span><span class="ruby-comment cmt">#当前办理案件</span>
32:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]<span class="ruby-operator">==</span><span class="ruby-keyword kw">nil</span>
33:     <span class="ruby-keyword kw">else</span>
34:       <span class="ruby-ivar">@case</span>=<span class="ruby-constant">TbCase</span>.<span class="ruby-identifier">find_by_recevice_code</span>(<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>])
35:       <span class="ruby-ivar">@caseorg</span>=<span class="ruby-constant">TbCaseorg</span>.<span class="ruby-identifier">find_by_recevice_code</span>(<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>])
36:       <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@caseorg!</span>=<span class="ruby-keyword kw">nil</span>
37:         <span class="ruby-identifier">params</span>[<span class="ruby-identifier">:org_id</span>]=<span class="ruby-ivar">@caseorg</span>.<span class="ruby-identifier">id</span>
38:       <span class="ruby-keyword kw">else</span>
39:         <span class="ruby-identifier">params</span>[<span class="ruby-identifier">:org_id</span>]=<span class="ruby-value">0</span>
40:       <span class="ruby-keyword kw">end</span>
41:       <span class="ruby-identifier">c</span>=<span class="ruby-node">&quot;recevice_code='#{session[:recevice_code]}' and used='Y'&quot;</span><span class="ruby-comment cmt">#org_id=#{params[:org_id]}</span>
42:       <span class="ruby-ivar">@arbitman</span>=<span class="ruby-constant">TbCasearbitman</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:all</span>,<span class="ruby-identifier">:order=</span><span class="ruby-operator">&gt;</span><span class="ruby-value str">'id'</span>,<span class="ruby-identifier">:conditions=</span><span class="ruby-operator">&gt;</span><span class="ruby-identifier">c</span>)
43:     <span class="ruby-keyword kw">end</span>
44:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M001628" class="method-detail">
        <a name="M001628"></a>

        <div class="method-heading">
          <a href="#M001628" class="method-signature">
          <span class="method-name">arbitman_new</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M001628-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M001628-source">
<pre>
    <span class="ruby-comment cmt"># File app/controllers/caseorg_arbit_controller.rb, line 52</span>
52:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">arbitman_new</span>
53:     <span class="ruby-comment cmt">#    @arbitman_now=TbArbitmannow.find_by_sql(&quot;select tb_arbitmen.code as code ,tb_arbitmen.name as name from tb_arbitmen,tb_arbitmannows where tb_arbitmen.code=tb_arbitmannows.arbitman_num order by tb_arbitmen.name&quot;)</span>
54:     <span class="ruby-ivar">@arbitman</span>=<span class="ruby-constant">TbCasearbitman</span>.<span class="ruby-identifier">new</span>()
55:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M001659" class="method-detail">
        <a name="M001659"></a>

        <div class="method-heading">
          <a href="#M001659" class="method-signature">
          <span class="method-name">book_create</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M001659-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M001659-source">
<pre>
     <span class="ruby-comment cmt"># File app/controllers/caseorg_arbit_controller.rb, line 468</span>
468:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">book_create</span>
469:     <span class="ruby-ivar">@book</span>=<span class="ruby-constant">CaseBook</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">params</span>[<span class="ruby-identifier">:book</span>])
470:     <span class="ruby-ivar">@book</span>.<span class="ruby-identifier">recevice_code</span>=<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]
471:     <span class="ruby-ivar">@book</span>.<span class="ruby-identifier">case_code</span>=<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:case_code</span>]
472:     <span class="ruby-ivar">@book</span>.<span class="ruby-identifier">general_code</span>=<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:general_code</span>]
473:     <span class="ruby-ivar">@book</span>.<span class="ruby-identifier">typ</span>=<span class="ruby-value str">&quot;0007&quot;</span>
474:     <span class="ruby-ivar">@book</span>.<span class="ruby-identifier">p_id</span>=<span class="ruby-identifier">params</span>[<span class="ruby-identifier">:p_id</span>]
475:     <span class="ruby-ivar">@book</span>.<span class="ruby-identifier">u</span>=<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:user_code</span>]
476:     <span class="ruby-ivar">@book</span>.<span class="ruby-identifier">u_t</span>=<span class="ruby-constant">Time</span>.<span class="ruby-identifier">now</span>()
477:     <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@book</span>.<span class="ruby-identifier">save</span>
478:       <span class="ruby-identifier">flash</span>[<span class="ruby-identifier">:notice</span>]=<span class="ruby-value str">&quot;创建成功&quot;</span>
479:       <span class="ruby-identifier">redirect_to</span> <span class="ruby-identifier">:action=</span><span class="ruby-operator">&gt;</span><span class="ruby-value str">&quot;book_list&quot;</span>,<span class="ruby-identifier">:p_id=</span><span class="ruby-operator">&gt;</span><span class="ruby-identifier">params</span>[<span class="ruby-identifier">:p_id</span>]
480:     <span class="ruby-keyword kw">else</span>
481:       <span class="ruby-identifier">flash</span>[<span class="ruby-identifier">:notice</span>]=<span class="ruby-value str">&quot;创建失败&quot;</span>
482:       <span class="ruby-identifier">render</span> <span class="ruby-identifier">:action=</span><span class="ruby-operator">&gt;</span><span class="ruby-value str">&quot;book_new&quot;</span> ,<span class="ruby-identifier">:p_id=</span><span class="ruby-operator">&gt;</span><span class="ruby-identifier">params</span>[<span class="ruby-identifier">:p_id</span>]
483:     <span class="ruby-keyword kw">end</span>
484:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M001662" class="method-detail">
        <a name="M001662"></a>

        <div class="method-heading">
          <a href="#M001662" class="method-signature">
          <span class="method-name">book_delete</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M001662-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M001662-source">
<pre>
     <span class="ruby-comment cmt"># File app/controllers/caseorg_arbit_controller.rb, line 503</span>
503:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">book_delete</span>
504:     <span class="ruby-ivar">@book</span>=<span class="ruby-constant">CaseBook</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">params</span>[<span class="ruby-identifier">:id</span>])
505:     <span class="ruby-ivar">@book</span>.<span class="ruby-identifier">used</span>=<span class="ruby-value str">&quot;N&quot;</span>
506:     <span class="ruby-ivar">@book</span>.<span class="ruby-identifier">u</span>=<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:user_code</span>]
507:     <span class="ruby-ivar">@book</span>.<span class="ruby-identifier">u_t</span>=<span class="ruby-constant">Time</span>.<span class="ruby-identifier">now</span>()
508:     <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@book</span>.<span class="ruby-identifier">save</span>
509: 
510:       <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@book</span>.<span class="ruby-identifier">book_name!</span>=<span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">and</span> <span class="ruby-ivar">@book</span>.<span class="ruby-identifier">book_name!</span>=<span class="ruby-value str">&quot;&quot;</span>
511:         <span class="ruby-ivar">@case</span>=<span class="ruby-constant">TbCase</span>.<span class="ruby-identifier">find_by_recevice_code</span>(<span class="ruby-ivar">@book</span>.<span class="ruby-identifier">recevice_code</span>)
512:         <span class="ruby-ivar">@yea</span>=<span class="ruby-ivar">@case</span>.<span class="ruby-identifier">recevice_code</span>.<span class="ruby-identifier">slice</span>(<span class="ruby-value">0</span>,<span class="ruby-value">4</span>)
513:         <span class="ruby-constant">File</span>.<span class="ruby-identifier">open</span>(<span class="ruby-node">&quot;#{SysArg.find_by_code(&quot;8010&quot;).val}/casedocs/#{@yea}/#{@book.recevice_code}/#{@book.book_name}&quot;</span>,<span class="ruby-value str">&quot;w+&quot;</span>){}
514:         <span class="ruby-keyword kw">if</span> <span class="ruby-constant">File</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-node">&quot;#{SysArg.find_by_code(&quot;8010&quot;).val}/casedocs/#{@yea}/#{@book.recevice_code}/#{@book.book_name}&quot;</span>)<span class="ruby-operator">==</span><span class="ruby-value">1</span>
515:           <span class="ruby-ivar">@book</span>.<span class="ruby-identifier">book_u</span>=<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:user_code</span>]
516:           <span class="ruby-ivar">@book</span>.<span class="ruby-identifier">book_dat</span>=<span class="ruby-constant">Time</span>.<span class="ruby-identifier">now</span>
517:           <span class="ruby-ivar">@book</span>.<span class="ruby-identifier">book_name</span>=<span class="ruby-value str">&quot;&quot;</span>
518:           <span class="ruby-ivar">@book</span>.<span class="ruby-identifier">save</span>
519:         <span class="ruby-keyword kw">end</span>
520:       <span class="ruby-keyword kw">end</span>
521: 
522:       <span class="ruby-identifier">flash</span>[<span class="ruby-identifier">:notice</span>]=<span class="ruby-value str">&quot;删除成功&quot;</span>
523:     <span class="ruby-keyword kw">else</span>
524:       <span class="ruby-identifier">flash</span>[<span class="ruby-identifier">:notice</span>]=<span class="ruby-value str">&quot;删除失败&quot;</span>
525:     <span class="ruby-keyword kw">end</span>
526:     <span class="ruby-identifier">redirect_to</span> <span class="ruby-identifier">:action=</span><span class="ruby-operator">&gt;</span><span class="ruby-value str">&quot;book_list&quot;</span>,<span class="ruby-identifier">:p_id=</span><span class="ruby-operator">&gt;</span><span class="ruby-identifier">params</span>[<span class="ruby-identifier">:p_id</span>]
527:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M001666" class="method-detail">
        <a name="M001666"></a>

        <div class="method-heading">
          <a href="#M001666" class="method-signature">
          <span class="method-name">book_destroy</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M001666-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M001666-source">
<pre>
     <span class="ruby-comment cmt"># File app/controllers/caseorg_arbit_controller.rb, line 592</span>
592:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">book_destroy</span>
593:     <span class="ruby-ivar">@doc</span>=<span class="ruby-constant">CaseBook</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">params</span>[<span class="ruby-identifier">:id</span>])
594:     <span class="ruby-ivar">@case</span>=<span class="ruby-constant">TbCase</span>.<span class="ruby-identifier">find_by_recevice_code</span>(<span class="ruby-ivar">@doc</span>.<span class="ruby-identifier">recevice_code</span>)
595:     <span class="ruby-ivar">@yea</span>=<span class="ruby-ivar">@case</span>.<span class="ruby-identifier">recevice_code</span>.<span class="ruby-identifier">slice</span>(<span class="ruby-value">0</span>,<span class="ruby-value">4</span>)
596:     <span class="ruby-constant">File</span>.<span class="ruby-identifier">open</span>(<span class="ruby-node">&quot;#{SysArg.find_by_code(&quot;8010&quot;).val}/casedocs/#{@yea}/#{@doc.recevice_code}/#{@doc.book_name}&quot;</span>,<span class="ruby-value str">&quot;w+&quot;</span>){}
597:     <span class="ruby-keyword kw">if</span> <span class="ruby-constant">File</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-node">&quot;#{SysArg.find_by_code(&quot;8010&quot;).val}/casedocs/#{@yea}/#{@doc.recevice_code}/#{@doc.book_name}&quot;</span>)<span class="ruby-operator">==</span><span class="ruby-value">1</span>
598:       <span class="ruby-ivar">@doc</span>.<span class="ruby-identifier">book_u</span>=<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:user_code</span>]
599:       <span class="ruby-ivar">@doc</span>.<span class="ruby-identifier">book_dat</span>=<span class="ruby-constant">Time</span>.<span class="ruby-identifier">now</span>
600:       <span class="ruby-ivar">@doc</span>.<span class="ruby-identifier">book_name</span>=<span class="ruby-value str">&quot;&quot;</span>
601:       <span class="ruby-ivar">@doc</span>.<span class="ruby-identifier">save</span>
602:       <span class="ruby-identifier">flash</span>[<span class="ruby-identifier">:notice</span>] = <span class="ruby-value str">&quot;文件删除成功&quot;</span>
603:     <span class="ruby-keyword kw">else</span>
604:       <span class="ruby-identifier">flash</span>[<span class="ruby-identifier">:notice</span>] = <span class="ruby-value str">&quot;文件删除失败&quot;</span>
605:     <span class="ruby-keyword kw">end</span>
606:     <span class="ruby-identifier">redirect_to</span> <span class="ruby-identifier">:action=</span><span class="ruby-operator">&gt;</span><span class="ruby-value str">&quot;book_list&quot;</span>,<span class="ruby-identifier">:p_id=</span><span class="ruby-operator">&gt;</span><span class="ruby-ivar">@doc</span>.<span class="ruby-identifier">p_id</span>
607:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M001665" class="method-detail">
        <a name="M001665"></a>

        <div class="method-heading">
          <a href="#M001665" class="method-signature">
          <span class="method-name">book_down</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M001665-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M001665-source">
<pre>
     <span class="ruby-comment cmt"># File app/controllers/caseorg_arbit_controller.rb, line 585</span>
585:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">book_down</span>
586:     <span class="ruby-ivar">@doc</span>=<span class="ruby-constant">CaseBook</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">params</span>[<span class="ruby-identifier">:id</span>])
587:     <span class="ruby-ivar">@case</span>=<span class="ruby-constant">TbCase</span>.<span class="ruby-identifier">find_by_recevice_code</span>(<span class="ruby-ivar">@doc</span>.<span class="ruby-identifier">recevice_code</span>)
588:     <span class="ruby-ivar">@yea</span>=<span class="ruby-ivar">@case</span>.<span class="ruby-identifier">recevice_code</span>.<span class="ruby-identifier">slice</span>(<span class="ruby-value">0</span>,<span class="ruby-value">4</span>)
589:     <span class="ruby-identifier">send_file</span>(<span class="ruby-node">&quot;#{SysArg.find_by_code(&quot;8010&quot;).val}/casedocs/#{@yea}/#{@doc.recevice_code}/#{@doc.book_name}&quot;</span>)
590:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M001660" class="method-detail">
        <a name="M001660"></a>

        <div class="method-heading">
          <a href="#M001660" class="method-signature">
          <span class="method-name">book_edit</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M001660-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M001660-source">
<pre>
     <span class="ruby-comment cmt"># File app/controllers/caseorg_arbit_controller.rb, line 486</span>
486:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">book_edit</span>
487:     <span class="ruby-ivar">@book</span>=<span class="ruby-constant">CaseBook</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">params</span>[<span class="ruby-identifier">:id</span>])
488:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M001657" class="method-detail">
        <a name="M001657"></a>

        <div class="method-heading">
          <a href="#M001657" class="method-signature">
          <span class="method-name">book_list</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M001657-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M001657-source">
<pre>
     <span class="ruby-comment cmt"># File app/controllers/caseorg_arbit_controller.rb, line 459</span>
459:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">book_list</span>
460:     <span class="ruby-identifier">c</span>=<span class="ruby-node">&quot;p_id=#{params[:p_id]} and typ='0007' and used='Y'&quot;</span>
461:     <span class="ruby-ivar">@book</span>=<span class="ruby-constant">CaseBook</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:all</span>,<span class="ruby-identifier">:order=</span><span class="ruby-operator">&gt;</span><span class="ruby-value str">'id'</span>,<span class="ruby-identifier">:conditions=</span><span class="ruby-operator">&gt;</span><span class="ruby-identifier">c</span>)
462:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M001658" class="method-detail">
        <a name="M001658"></a>

        <div class="method-heading">
          <a href="#M001658" class="method-signature">
          <span class="method-name">book_new</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M001658-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M001658-source">
<pre>
     <span class="ruby-comment cmt"># File app/controllers/caseorg_arbit_controller.rb, line 464</span>
464:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">book_new</span>
465:     <span class="ruby-ivar">@book</span>=<span class="ruby-constant">CaseBook</span>.<span class="ruby-identifier">new</span>()
466:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M001661" class="method-detail">
        <a name="M001661"></a>

        <div class="method-heading">
          <a href="#M001661" class="method-signature">
          <span class="method-name">book_update</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M001661-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M001661-source">
<pre>
     <span class="ruby-comment cmt"># File app/controllers/caseorg_arbit_controller.rb, line 490</span>
490:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">book_update</span>
491:     <span class="ruby-ivar">@book</span>=<span class="ruby-constant">CaseBook</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">params</span>[<span class="ruby-identifier">:id</span>])
492:     <span class="ruby-ivar">@book</span>.<span class="ruby-identifier">u</span>=<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:user_code</span>]
493:     <span class="ruby-ivar">@book</span>.<span class="ruby-identifier">u_t</span>=<span class="ruby-constant">Time</span>.<span class="ruby-identifier">now</span>()
494:     <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@book</span>.<span class="ruby-identifier">update_attributes</span>(<span class="ruby-identifier">params</span>[<span class="ruby-identifier">:book</span>])
495:       <span class="ruby-identifier">flash</span>[<span class="ruby-identifier">:notice</span>]=<span class="ruby-value str">&quot;修改成功&quot;</span>
496:       <span class="ruby-identifier">redirect_to</span> <span class="ruby-identifier">:action=</span><span class="ruby-operator">&gt;</span><span class="ruby-value str">&quot;book_list&quot;</span>,<span class="ruby-identifier">:p_id=</span><span class="ruby-operator">&gt;</span><span class="ruby-identifier">params</span>[<span class="ruby-identifier">:p_id</span>]
497:     <span class="ruby-keyword kw">else</span>
498:       <span class="ruby-identifier">flash</span>[<span class="ruby-identifier">:notice</span>]=<span class="ruby-value str">&quot;修改失败&quot;</span>
499:       <span class="ruby-identifier">render</span> <span class="ruby-identifier">:action=</span><span class="ruby-operator">&gt;</span><span class="ruby-value str">&quot;book_edit&quot;</span> ,<span class="ruby-identifier">:p_id=</span><span class="ruby-operator">&gt;</span><span class="ruby-identifier">params</span>[<span class="ruby-identifier">:p_id</span>]
500:     <span class="ruby-keyword kw">end</span>
501:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M001663" class="method-detail">
        <a name="M001663"></a>

        <div class="method-heading">
          <a href="#M001663" class="method-signature">
          <span class="method-name">book_upload</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M001663-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M001663-source">
<pre>
     <span class="ruby-comment cmt"># File app/controllers/caseorg_arbit_controller.rb, line 529</span>
529:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">book_upload</span>
530:     <span class="ruby-ivar">@book</span>=<span class="ruby-constant">CaseBook</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">params</span>[<span class="ruby-identifier">:id</span>])
531:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M001664" class="method-detail">
        <a name="M001664"></a>

        <div class="method-heading">
          <a href="#M001664" class="method-signature">
          <span class="method-name">book_upload_do</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M001664-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M001664-source">
<pre>
     <span class="ruby-comment cmt"># File app/controllers/caseorg_arbit_controller.rb, line 533</span>
533:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">book_upload_do</span>
534:     <span class="ruby-ivar">@sitting</span>=<span class="ruby-constant">TbEvite</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">params</span>[<span class="ruby-identifier">:p_id</span>])
535:     <span class="ruby-comment cmt">#@sitting.book_num=@sitting.book_num + 1</span>
536:     <span class="ruby-ivar">@doc</span>=<span class="ruby-constant">CaseBook</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">params</span>[<span class="ruby-identifier">:id</span>])
537:     <span class="ruby-ivar">@case</span>=<span class="ruby-constant">TbCase</span>.<span class="ruby-identifier">find_by_recevice_code</span>(<span class="ruby-ivar">@doc</span>.<span class="ruby-identifier">recevice_code</span>)
538:     <span class="ruby-comment cmt">#########################################</span>
539:     <span class="ruby-ivar">@yea</span>=<span class="ruby-ivar">@case</span>.<span class="ruby-identifier">recevice_code</span>.<span class="ruby-identifier">slice</span>(<span class="ruby-value">0</span>,<span class="ruby-value">4</span>)
540:     <span class="ruby-ivar">@doc</span>.<span class="ruby-identifier">book_u</span>=<span class="ruby-ivar">@case</span>.<span class="ruby-identifier">clerk</span>
541:     <span class="ruby-ivar">@doc</span>.<span class="ruby-identifier">book_dat</span>=<span class="ruby-constant">Time</span>.<span class="ruby-identifier">now</span>
542: 
543:     <span class="ruby-identifier">utf8_to_gbk</span>  = <span class="ruby-constant">Iconv</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value str">'gbk'</span>,<span class="ruby-value str">'utf-8'</span>)
544:     <span class="ruby-identifier">gbk_to_utf8</span> = <span class="ruby-constant">Iconv</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value str">'utf-8'</span>,<span class="ruby-value str">'gbk'</span>)
545:     <span class="ruby-comment cmt">#f_name = params[&quot;filedata&quot;].original_filename</span>
546:     <span class="ruby-identifier">file</span> = <span class="ruby-identifier">params</span>[<span class="ruby-value str">&quot;file&quot;</span>]   <span class="ruby-comment cmt">#获取文档，此处为tempfile类型的</span>
547:     <span class="ruby-comment cmt">#设置文档保存的路径，自由设置</span>
548:     <span class="ruby-keyword kw">if</span> <span class="ruby-operator">!</span><span class="ruby-constant">File</span>.<span class="ruby-identifier">exists?</span>(<span class="ruby-node">&quot;#{SysArg.find_by_code(&quot;8010&quot;).val}/casedocs&quot;</span>)
549:       <span class="ruby-constant">Dir</span>.<span class="ruby-identifier">mkdir</span>(<span class="ruby-node">&quot;#{SysArg.find_by_code(&quot;8010&quot;).val}/casedocs/&quot;</span>)
550:     <span class="ruby-keyword kw">end</span>
551:     <span class="ruby-keyword kw">if</span> <span class="ruby-operator">!</span><span class="ruby-constant">File</span>.<span class="ruby-identifier">exists?</span>(<span class="ruby-node">&quot;#{SysArg.find_by_code(&quot;8010&quot;).val}/casedocs/#{@yea}&quot;</span>)
552:       <span class="ruby-constant">Dir</span>.<span class="ruby-identifier">mkdir</span>(<span class="ruby-node">&quot;#{SysArg.find_by_code(&quot;8010&quot;).val}/casedocs/#{@yea}&quot;</span>)
553:     <span class="ruby-keyword kw">end</span>
554:     <span class="ruby-keyword kw">if</span> <span class="ruby-operator">!</span><span class="ruby-constant">File</span>.<span class="ruby-identifier">exists?</span>(<span class="ruby-node">&quot;#{SysArg.find_by_code(&quot;8010&quot;).val}/casedocs/#{@yea}/#{@doc.recevice_code}&quot;</span>)
555:       <span class="ruby-constant">Dir</span>.<span class="ruby-identifier">mkdir</span>(<span class="ruby-node">&quot;#{SysArg.find_by_code(&quot;8010&quot;).val}/casedocs/#{@yea}/#{@doc.recevice_code}&quot;</span>)
556:     <span class="ruby-keyword kw">end</span>
557:     <span class="ruby-comment cmt">#读取文档的内容，目前不用编码转换即可正常显示，在存入数据库中时或许涉及到编码转换</span>
558:     <span class="ruby-identifier">file_arry</span> = <span class="ruby-identifier">file</span>.<span class="ruby-identifier">original_filename</span>.<span class="ruby-identifier">split</span>(<span class="ruby-value str">&quot;.&quot;</span>)
559:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">file_arry</span>.<span class="ruby-identifier">size</span> <span class="ruby-operator">&gt;</span> <span class="ruby-value">1</span>
560:       <span class="ruby-ivar">@doc</span>.<span class="ruby-identifier">book_name</span>=<span class="ruby-node">&quot;#{@doc.typ}_#{@doc.recevice_code}_#{@sitting.id}_#{@doc.id}.&quot;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">file</span>.<span class="ruby-identifier">original_filename</span>.<span class="ruby-identifier">split</span>(<span class="ruby-value str">&quot;.&quot;</span>)[<span class="ruby-identifier">file_arry</span>.<span class="ruby-identifier">size</span> <span class="ruby-operator">-</span> <span class="ruby-value">1</span>]
561:     <span class="ruby-keyword kw">else</span>
562:       <span class="ruby-ivar">@doc</span>.<span class="ruby-identifier">book_name</span>=<span class="ruby-node">&quot;#{@doc.typ}_#{@doc.recevice_code}_#{@sitting.id}_#{@doc.id}&quot;</span>
563:     <span class="ruby-keyword kw">end</span>
564: 
565:     <span class="ruby-keyword kw">begin</span>
566:       <span class="ruby-identifier">content</span> = <span class="ruby-identifier">file</span>.<span class="ruby-identifier">read</span>  <span class="ruby-comment cmt">#gbk_to_utf8.iconv</span>
567:       <span class="ruby-comment cmt">#新建同名文件，读取修改的文件内容用以覆盖源文件，注意路径要与读取的一致</span>
568:       <span class="ruby-identifier">f</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">new</span>(<span class="ruby-node">&quot;#{SysArg.find_by_code(&quot;8010&quot;).val}/casedocs/#{@yea}/#{@doc.recevice_code}/#{@doc.book_name}&quot;</span>, <span class="ruby-value str">&quot;wb&quot;</span>)
569:       <span class="ruby-identifier">f</span>.<span class="ruby-identifier">write</span>(<span class="ruby-identifier">content</span>)
570:       <span class="ruby-identifier">f</span>.<span class="ruby-identifier">close</span>
571:       <span class="ruby-keyword kw">if</span> <span class="ruby-operator">!</span><span class="ruby-identifier">file</span>.<span class="ruby-identifier">original_filename</span>.<span class="ruby-identifier">empty?</span>
572:         <span class="ruby-ivar">@doc</span>.<span class="ruby-identifier">save</span>
573:         <span class="ruby-comment cmt">#@sitting.save</span>
574:         <span class="ruby-identifier">flash</span>[<span class="ruby-identifier">:notice</span>] = <span class="ruby-value str">&quot;文件上传成功&quot;</span>
575:       <span class="ruby-keyword kw">else</span>
576:         <span class="ruby-identifier">flash</span>[<span class="ruby-identifier">:notice</span>] = <span class="ruby-value str">&quot;文件上传失败&quot;</span>
577: 
578:       <span class="ruby-keyword kw">end</span>
579:     <span class="ruby-keyword kw">rescue</span>
580:       <span class="ruby-identifier">flash</span>[<span class="ruby-identifier">:notice</span>] = <span class="ruby-value str">&quot;文件上传失败！&quot;</span>
581:     <span class="ruby-keyword kw">end</span>
582:     <span class="ruby-identifier">redirect_to</span> <span class="ruby-identifier">:action=</span><span class="ruby-operator">&gt;</span><span class="ruby-value str">&quot;book_list&quot;</span>,<span class="ruby-identifier">:p_id=</span><span class="ruby-operator">&gt;</span><span class="ruby-identifier">params</span>[<span class="ruby-identifier">:p_id</span>]
583:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M001647" class="method-detail">
        <a name="M001647"></a>

        <div class="method-heading">
          <a href="#M001647" class="method-signature">
          <span class="method-name">change_create</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M001647-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M001647-source">
<pre>
     <span class="ruby-comment cmt"># File app/controllers/caseorg_arbit_controller.rb, line 320</span>
320:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">change_create</span>
321:     <span class="ruby-ivar">@arbitman_1</span>=<span class="ruby-constant">TbCasearbitman</span>.<span class="ruby-identifier">new</span>()
322:     <span class="ruby-ivar">@change</span>=<span class="ruby-constant">TbChange</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">params</span>[<span class="ruby-identifier">:change</span>])
323:     <span class="ruby-ivar">@change</span>.<span class="ruby-identifier">recevice_code</span>=<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]
324:     <span class="ruby-ivar">@change</span>.<span class="ruby-identifier">case_code</span>=<span class="ruby-constant">TbCase</span>.<span class="ruby-identifier">find_by_recevice_code</span>(<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]).<span class="ruby-identifier">case_code</span>
325:     <span class="ruby-ivar">@change</span>.<span class="ruby-identifier">general_code</span>=<span class="ruby-constant">TbCase</span>.<span class="ruby-identifier">find_by_recevice_code</span>(<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]).<span class="ruby-identifier">general_code</span>
326:     <span class="ruby-ivar">@change</span>.<span class="ruby-identifier">org_id</span>=<span class="ruby-identifier">params</span>[<span class="ruby-identifier">:org_id</span>]
327:     <span class="ruby-ivar">@change</span>.<span class="ruby-identifier">u</span>=<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:user_code</span>]
328:     <span class="ruby-ivar">@change</span>.<span class="ruby-identifier">u_t</span>=<span class="ruby-constant">Time</span>.<span class="ruby-identifier">now</span>()
329: 
330:     <span class="ruby-ivar">@arbitman</span>=<span class="ruby-constant">TbCasearbitman</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:first</span>,<span class="ruby-identifier">:conditions=</span><span class="ruby-operator">&gt;</span>[<span class="ruby-value str">&quot;used='Y' and recevice_code=? and arbitman=?&quot;</span>,<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>],<span class="ruby-identifier">params</span>[<span class="ruby-identifier">:change</span>][<span class="ruby-identifier">:arbitman_1</span>]])
331:     <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@arbitman!</span>=<span class="ruby-keyword kw">nil</span>
332:       <span class="ruby-ivar">@arbitman</span>.<span class="ruby-identifier">used</span>=<span class="ruby-value str">'N'</span>
333:       <span class="ruby-comment cmt">#原来的仲裁员逻辑删除，新建立一条记录</span>
334:       <span class="ruby-ivar">@arbitman_1</span>.<span class="ruby-identifier">used</span>=<span class="ruby-value str">'Y'</span>
335:       <span class="ruby-ivar">@arbitman_1</span>.<span class="ruby-identifier">recevice_code</span>=<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]
336:       <span class="ruby-ivar">@arbitman_1</span>.<span class="ruby-identifier">case_code</span>=<span class="ruby-ivar">@arbitman</span>.<span class="ruby-identifier">case_code</span>
337:       <span class="ruby-ivar">@arbitman_1</span>.<span class="ruby-identifier">general_code</span>=<span class="ruby-ivar">@arbitman</span>.<span class="ruby-identifier">general_code</span>
338:       <span class="ruby-ivar">@arbitman_1</span>.<span class="ruby-identifier">org_id</span>=<span class="ruby-identifier">params</span>[<span class="ruby-identifier">:org_id</span>]
339:       <span class="ruby-ivar">@arbitman_1</span>.<span class="ruby-identifier">u</span>=<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:user_code</span>]
340:       <span class="ruby-ivar">@arbitman_1</span>.<span class="ruby-identifier">u_t</span>=<span class="ruby-constant">Time</span>.<span class="ruby-identifier">now</span>()
341:       <span class="ruby-ivar">@arbitman_1</span>.<span class="ruby-identifier">arbitman</span>=<span class="ruby-identifier">params</span>[<span class="ruby-identifier">:change</span>][<span class="ruby-identifier">:arbitman</span>]
342:       <span class="ruby-ivar">@arbitman_1</span>.<span class="ruby-identifier">arbitmansign</span>=<span class="ruby-identifier">params</span>[<span class="ruby-identifier">:change</span>][<span class="ruby-identifier">:arbitmansign</span>]
343:       <span class="ruby-ivar">@arbitman_1</span>.<span class="ruby-identifier">currency</span>=<span class="ruby-identifier">params</span>[<span class="ruby-identifier">:change</span>][<span class="ruby-identifier">:currency</span>]
344:       <span class="ruby-ivar">@arbitman_1</span>.<span class="ruby-identifier">f_money</span>=<span class="ruby-identifier">params</span>[<span class="ruby-identifier">:change</span>][<span class="ruby-identifier">:f_money</span>]
345:       <span class="ruby-ivar">@arbitman_1</span>.<span class="ruby-identifier">arbitmantype</span>=<span class="ruby-ivar">@arbitman</span>.<span class="ruby-identifier">arbitmantype</span>
346:       <span class="ruby-ivar">@change</span>.<span class="ruby-identifier">arbitmantype</span>=<span class="ruby-ivar">@arbitman</span>.<span class="ruby-identifier">arbitmantype</span>
347:     <span class="ruby-keyword kw">end</span>
348:     
349: 
350:     <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@change</span>.<span class="ruby-identifier">save</span> <span class="ruby-keyword kw">and</span> <span class="ruby-ivar">@arbitman</span>.<span class="ruby-identifier">save</span> <span class="ruby-keyword kw">and</span> <span class="ruby-ivar">@arbitman_1</span>.<span class="ruby-identifier">save</span>
351:       <span class="ruby-identifier">flash</span>[<span class="ruby-identifier">:notice</span>]=<span class="ruby-value str">&quot;创建成功&quot;</span>
352:       <span class="ruby-identifier">redirect_to</span> <span class="ruby-identifier">:action=</span><span class="ruby-operator">&gt;</span><span class="ruby-value str">&quot;change_list&quot;</span>,<span class="ruby-identifier">:org_id=</span><span class="ruby-operator">&gt;</span><span class="ruby-identifier">params</span>[<span class="ruby-identifier">:org_id</span>],<span class="ruby-identifier">:recevice_code=</span><span class="ruby-operator">&gt;</span><span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]
353:     <span class="ruby-keyword kw">else</span>
354:       <span class="ruby-identifier">flash</span>[<span class="ruby-identifier">:notice</span>]=<span class="ruby-value str">&quot;创建失败&quot;</span>
355:       <span class="ruby-identifier">render</span> <span class="ruby-identifier">:action=</span><span class="ruby-operator">&gt;</span><span class="ruby-value str">&quot;change_new&quot;</span> ,<span class="ruby-identifier">:org_id=</span><span class="ruby-operator">&gt;</span><span class="ruby-identifier">params</span>[<span class="ruby-identifier">:org_id</span>],<span class="ruby-identifier">:recevice_code=</span><span class="ruby-operator">&gt;</span><span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]
356:     <span class="ruby-keyword kw">end</span>
357: 
358:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M001650" class="method-detail">
        <a name="M001650"></a>

        <div class="method-heading">
          <a href="#M001650" class="method-signature">
          <span class="method-name">change_delete</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M001650-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M001650-source">
<pre>
     <span class="ruby-comment cmt"># File app/controllers/caseorg_arbit_controller.rb, line 378</span>
378:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">change_delete</span>
379:     <span class="ruby-ivar">@change</span>=<span class="ruby-constant">TbChange</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">params</span>[<span class="ruby-identifier">:id</span>])
380:     <span class="ruby-ivar">@change</span>.<span class="ruby-identifier">used</span>=<span class="ruby-value str">&quot;N&quot;</span>
381:     <span class="ruby-ivar">@change</span>.<span class="ruby-identifier">u</span>=<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:user_code</span>]
382:     <span class="ruby-ivar">@change</span>.<span class="ruby-identifier">u_t</span>=<span class="ruby-constant">Time</span>.<span class="ruby-identifier">now</span>()
383:     <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@change</span>.<span class="ruby-identifier">save</span>
384:       <span class="ruby-identifier">flash</span>[<span class="ruby-identifier">:notice</span>]=<span class="ruby-value str">&quot;删除成功&quot;</span>
385:     <span class="ruby-keyword kw">else</span>
386:       <span class="ruby-identifier">flash</span>[<span class="ruby-identifier">:notice</span>]=<span class="ruby-value str">&quot;删除失败&quot;</span>
387:     <span class="ruby-keyword kw">end</span>
388:     <span class="ruby-identifier">redirect_to</span> <span class="ruby-identifier">:action=</span><span class="ruby-operator">&gt;</span><span class="ruby-value str">&quot;change_list&quot;</span>,<span class="ruby-identifier">:org_id=</span><span class="ruby-operator">&gt;</span><span class="ruby-identifier">params</span>[<span class="ruby-identifier">:org_id</span>],<span class="ruby-identifier">:recevice_code=</span><span class="ruby-operator">&gt;</span><span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]
389:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M001648" class="method-detail">
        <a name="M001648"></a>

        <div class="method-heading">
          <a href="#M001648" class="method-signature">
          <span class="method-name">change_edit</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M001648-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M001648-source">
<pre>
     <span class="ruby-comment cmt"># File app/controllers/caseorg_arbit_controller.rb, line 360</span>
360:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">change_edit</span>
361:     <span class="ruby-ivar">@arbitman_now</span>=<span class="ruby-constant">TbArbitmannow</span>.<span class="ruby-identifier">find_by_sql</span>(<span class="ruby-node">&quot;select distinct tb_arbitmen.code as code ,tb_arbitmen.name as name from tb_arbitmen,tb_casearbitmen where tb_casearbitmen.recevice_code='#{session[:recevice_code]}' and  tb_arbitmen.code=tb_casearbitmen.arbitman order by tb_arbitmen.name&quot;</span>)
362:     <span class="ruby-ivar">@change</span>=<span class="ruby-constant">TbChange</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">params</span>[<span class="ruby-identifier">:id</span>])
363:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M001645" class="method-detail">
        <a name="M001645"></a>

        <div class="method-heading">
          <a href="#M001645" class="method-signature">
          <span class="method-name">change_list</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M001645-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M001645-source">
<pre>
     <span class="ruby-comment cmt"># File app/controllers/caseorg_arbit_controller.rb, line 296</span>
296:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">change_list</span>
297:     <span class="ruby-ivar">@case</span>=<span class="ruby-keyword kw">nil</span><span class="ruby-comment cmt">#当前办理案件</span>
298:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]<span class="ruby-operator">==</span><span class="ruby-keyword kw">nil</span>
299:     <span class="ruby-keyword kw">else</span>
300:       <span class="ruby-ivar">@case</span>=<span class="ruby-constant">TbCase</span>.<span class="ruby-identifier">find_by_recevice_code</span>(<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>])
301:       <span class="ruby-ivar">@caseorg</span>=<span class="ruby-constant">TbCaseorg</span>.<span class="ruby-identifier">find_by_recevice_code</span>(<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>])
302:       <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@caseorg!</span>=<span class="ruby-keyword kw">nil</span>
303:         <span class="ruby-identifier">params</span>[<span class="ruby-identifier">:org_id</span>]=<span class="ruby-ivar">@caseorg</span>.<span class="ruby-identifier">id</span>
304:       <span class="ruby-keyword kw">else</span>
305:         <span class="ruby-identifier">params</span>[<span class="ruby-identifier">:org_id</span>]=<span class="ruby-value">0</span>
306:       <span class="ruby-keyword kw">end</span>
307:       <span class="ruby-ivar">@spilu</span>={<span class="ruby-value str">&quot;Y&quot;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value str">&quot;是&quot;</span>,<span class="ruby-value str">&quot;N&quot;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value str">&quot;否&quot;</span>}
308:       <span class="ruby-identifier">c</span>=<span class="ruby-node">&quot;recevice_code='#{session[:recevice_code]}' and used='Y'&quot;</span><span class="ruby-comment cmt">#org_id=#{params[:org_id]}</span>
309:       <span class="ruby-ivar">@change</span>=<span class="ruby-constant">TbChange</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:all</span>,<span class="ruby-identifier">:order=</span><span class="ruby-operator">&gt;</span><span class="ruby-value str">'id'</span>,<span class="ruby-identifier">:conditions=</span><span class="ruby-operator">&gt;</span><span class="ruby-identifier">c</span>)
310:     <span class="ruby-keyword kw">end</span>
311:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M001646" class="method-detail">
        <a name="M001646"></a>

        <div class="method-heading">
          <a href="#M001646" class="method-signature">
          <span class="method-name">change_new</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M001646-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M001646-source">
<pre>
     <span class="ruby-comment cmt"># File app/controllers/caseorg_arbit_controller.rb, line 313</span>
313:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">change_new</span>
314:     <span class="ruby-comment cmt">#    @arbitman_now=TbArbitmannow.find_by_sql(&quot;select distinct tb_arbitmen.code as code ,tb_arbitmen.name as name from tb_arbitmen,tb_casearbitmen where tb_casearbitmen.recevice_code='#{session[:recevice_code]}' and  tb_arbitmen.code=tb_casearbitmen.arbitman order by tb_arbitmen.name&quot;)</span>
315:     <span class="ruby-ivar">@change</span>=<span class="ruby-constant">TbChange</span>.<span class="ruby-identifier">new</span>()
316:     <span class="ruby-ivar">@change</span>.<span class="ruby-identifier">changedate</span>=<span class="ruby-constant">Date</span>.<span class="ruby-identifier">today</span>
317:     <span class="ruby-ivar">@arbitman_1</span>=<span class="ruby-constant">TbCasearbitman</span>.<span class="ruby-identifier">new</span>()
318:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M001649" class="method-detail">
        <a name="M001649"></a>

        <div class="method-heading">
          <a href="#M001649" class="method-signature">
          <span class="method-name">change_update</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M001649-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M001649-source">
<pre>
     <span class="ruby-comment cmt"># File app/controllers/caseorg_arbit_controller.rb, line 365</span>
365:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">change_update</span>
366:     <span class="ruby-ivar">@change</span>=<span class="ruby-constant">TbChange</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">params</span>[<span class="ruby-identifier">:id</span>])
367:     <span class="ruby-ivar">@change</span>.<span class="ruby-identifier">u</span>=<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:user_code</span>]
368:     <span class="ruby-ivar">@change</span>.<span class="ruby-identifier">u_t</span>=<span class="ruby-constant">Time</span>.<span class="ruby-identifier">now</span>()
369:     <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@change</span>.<span class="ruby-identifier">update_attributes</span>(<span class="ruby-identifier">params</span>[<span class="ruby-identifier">:change</span>])
370:       <span class="ruby-identifier">flash</span>[<span class="ruby-identifier">:notice</span>]=<span class="ruby-value str">&quot;修改成功&quot;</span>
371:       <span class="ruby-identifier">redirect_to</span> <span class="ruby-identifier">:action=</span><span class="ruby-operator">&gt;</span><span class="ruby-value str">&quot;change_list&quot;</span>,<span class="ruby-identifier">:org_id=</span><span class="ruby-operator">&gt;</span><span class="ruby-identifier">params</span>[<span class="ruby-identifier">:org_id</span>],<span class="ruby-identifier">:recevice_code=</span><span class="ruby-operator">&gt;</span><span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]
372:     <span class="ruby-keyword kw">else</span>
373:       <span class="ruby-identifier">flash</span>[<span class="ruby-identifier">:notice</span>]=<span class="ruby-value str">&quot;修改失败&quot;</span>
374:       <span class="ruby-identifier">render</span> <span class="ruby-identifier">:action=</span><span class="ruby-operator">&gt;</span><span class="ruby-value str">&quot;change_edit&quot;</span>,<span class="ruby-identifier">:id=</span><span class="ruby-operator">&gt;</span><span class="ruby-identifier">params</span>[<span class="ruby-identifier">:id</span>],<span class="ruby-identifier">:org_id=</span><span class="ruby-operator">&gt;</span><span class="ruby-identifier">params</span>[<span class="ruby-identifier">:org_id</span>],<span class="ruby-identifier">:recevice_code=</span><span class="ruby-operator">&gt;</span><span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]
375:     <span class="ruby-keyword kw">end</span>
376:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M001641" class="method-detail">
        <a name="M001641"></a>

        <div class="method-heading">
          <a href="#M001641" class="method-signature">
          <span class="method-name">disc_create</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M001641-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M001641-source">
<pre>
     <span class="ruby-comment cmt"># File app/controllers/caseorg_arbit_controller.rb, line 247</span>
247:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">disc_create</span>
248:     <span class="ruby-ivar">@disc</span>=<span class="ruby-constant">TbDisclosure</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">params</span>[<span class="ruby-identifier">:disc</span>])
249:     <span class="ruby-ivar">@disc</span>.<span class="ruby-identifier">recevice_code</span>=<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]
250:     <span class="ruby-ivar">@disc</span>.<span class="ruby-identifier">case_code</span>=<span class="ruby-constant">TbCase</span>.<span class="ruby-identifier">find_by_recevice_code</span>(<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]).<span class="ruby-identifier">case_code</span>
251:     <span class="ruby-ivar">@disc</span>.<span class="ruby-identifier">general_code</span>=<span class="ruby-constant">TbCase</span>.<span class="ruby-identifier">find_by_recevice_code</span>(<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]).<span class="ruby-identifier">general_code</span>
252:     <span class="ruby-ivar">@disc</span>.<span class="ruby-identifier">org_id</span>=<span class="ruby-identifier">params</span>[<span class="ruby-identifier">:org_id</span>]
253:     <span class="ruby-ivar">@disc</span>.<span class="ruby-identifier">u</span>=<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:user_code</span>]
254:     <span class="ruby-ivar">@disc</span>.<span class="ruby-identifier">u_t</span>=<span class="ruby-constant">Time</span>.<span class="ruby-identifier">now</span>()
255:     <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@disc</span>.<span class="ruby-identifier">save</span>
256:       <span class="ruby-identifier">flash</span>[<span class="ruby-identifier">:notice</span>]=<span class="ruby-value str">&quot;创建成功&quot;</span>
257:       <span class="ruby-identifier">redirect_to</span> <span class="ruby-identifier">:action=</span><span class="ruby-operator">&gt;</span><span class="ruby-value str">&quot;disc_list&quot;</span>,<span class="ruby-identifier">:org_id=</span><span class="ruby-operator">&gt;</span><span class="ruby-identifier">params</span>[<span class="ruby-identifier">:org_id</span>],<span class="ruby-identifier">:recevice_code=</span><span class="ruby-operator">&gt;</span><span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]
258:     <span class="ruby-keyword kw">else</span>
259:       <span class="ruby-identifier">flash</span>[<span class="ruby-identifier">:notice</span>]=<span class="ruby-value str">&quot;创建失败&quot;</span>
260:       <span class="ruby-identifier">render</span> <span class="ruby-identifier">:action=</span><span class="ruby-operator">&gt;</span><span class="ruby-value str">&quot;disc_new&quot;</span>,<span class="ruby-identifier">:org_id=</span><span class="ruby-operator">&gt;</span><span class="ruby-identifier">params</span>[<span class="ruby-identifier">:org_id</span>],<span class="ruby-identifier">:recevice_code=</span><span class="ruby-operator">&gt;</span><span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]
261:     <span class="ruby-keyword kw">end</span>
262:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M001644" class="method-detail">
        <a name="M001644"></a>

        <div class="method-heading">
          <a href="#M001644" class="method-signature">
          <span class="method-name">disc_delete</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M001644-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M001644-source">
<pre>
     <span class="ruby-comment cmt"># File app/controllers/caseorg_arbit_controller.rb, line 283</span>
283:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">disc_delete</span>
284:     <span class="ruby-ivar">@disc</span>=<span class="ruby-constant">TbDisclosure</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">params</span>[<span class="ruby-identifier">:id</span>])
285:     <span class="ruby-ivar">@disc</span>.<span class="ruby-identifier">used</span>=<span class="ruby-value str">&quot;N&quot;</span>
286:     <span class="ruby-ivar">@disc</span>.<span class="ruby-identifier">u</span>=<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:user_code</span>]
287:     <span class="ruby-ivar">@disc</span>.<span class="ruby-identifier">u_t</span>=<span class="ruby-constant">Time</span>.<span class="ruby-identifier">now</span>()
288:     <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@disc</span>.<span class="ruby-identifier">save</span>
289:       <span class="ruby-identifier">flash</span>[<span class="ruby-identifier">:notice</span>]=<span class="ruby-value str">&quot;删除成功&quot;</span>
290:     <span class="ruby-keyword kw">else</span>
291:       <span class="ruby-identifier">flash</span>[<span class="ruby-identifier">:notice</span>]=<span class="ruby-value str">&quot;删除失败&quot;</span>
292:     <span class="ruby-keyword kw">end</span>
293:     <span class="ruby-identifier">redirect_to</span> <span class="ruby-identifier">:action=</span><span class="ruby-operator">&gt;</span><span class="ruby-value str">&quot;disc_list&quot;</span>,<span class="ruby-identifier">:org_id=</span><span class="ruby-operator">&gt;</span><span class="ruby-identifier">params</span>[<span class="ruby-identifier">:org_id</span>],<span class="ruby-identifier">:recevice_code=</span><span class="ruby-operator">&gt;</span><span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]
294:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M001642" class="method-detail">
        <a name="M001642"></a>

        <div class="method-heading">
          <a href="#M001642" class="method-signature">
          <span class="method-name">disc_edit</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M001642-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M001642-source">
<pre>
     <span class="ruby-comment cmt"># File app/controllers/caseorg_arbit_controller.rb, line 264</span>
264:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">disc_edit</span>
265:     <span class="ruby-ivar">@arbitman_now</span>=<span class="ruby-constant">TbArbitmannow</span>.<span class="ruby-identifier">find_by_sql</span>(<span class="ruby-node">&quot;select distinct tb_arbitmen.code as code ,tb_arbitmen.name as name from tb_arbitmen,tb_casearbitmen where tb_casearbitmen.recevice_code='#{session[:recevice_code]}' and  tb_arbitmen.code=tb_casearbitmen.arbitman order by tb_arbitmen.name&quot;</span>)
266:     <span class="ruby-ivar">@disc</span>=<span class="ruby-constant">TbDisclosure</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">params</span>[<span class="ruby-identifier">:id</span>])
267:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M001639" class="method-detail">
        <a name="M001639"></a>

        <div class="method-heading">
          <a href="#M001639" class="method-signature">
          <span class="method-name">disc_list</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M001639-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M001639-source">
<pre>
     <span class="ruby-comment cmt"># File app/controllers/caseorg_arbit_controller.rb, line 222</span>
222:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">disc_list</span>
223:     <span class="ruby-ivar">@case</span>=<span class="ruby-keyword kw">nil</span><span class="ruby-comment cmt">#当前办理案件</span>
224:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]<span class="ruby-operator">==</span><span class="ruby-keyword kw">nil</span>
225:     <span class="ruby-keyword kw">else</span>
226:       <span class="ruby-ivar">@case</span>=<span class="ruby-constant">TbCase</span>.<span class="ruby-identifier">find_by_recevice_code</span>(<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>])
227:       <span class="ruby-ivar">@caseorg</span>=<span class="ruby-constant">TbCaseorg</span>.<span class="ruby-identifier">find_by_recevice_code</span>(<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>])
228:       <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@caseorg!</span>=<span class="ruby-keyword kw">nil</span>
229:         <span class="ruby-identifier">params</span>[<span class="ruby-identifier">:org_id</span>]=<span class="ruby-ivar">@caseorg</span>.<span class="ruby-identifier">id</span>
230:       <span class="ruby-keyword kw">else</span>
231:         <span class="ruby-identifier">params</span>[<span class="ruby-identifier">:org_id</span>]=<span class="ruby-value">0</span>
232:       <span class="ruby-keyword kw">end</span>
233:       <span class="ruby-ivar">@spilu</span>={<span class="ruby-value str">&quot;Y&quot;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value str">&quot;是&quot;</span>,<span class="ruby-value str">&quot;N&quot;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value str">&quot;否&quot;</span>}
234:       <span class="ruby-identifier">c</span>=<span class="ruby-node">&quot;recevice_code='#{session[:recevice_code]}' and used='Y'&quot;</span><span class="ruby-comment cmt">#org_id=#{params[:org_id]}</span>
235:       <span class="ruby-ivar">@disc</span>=<span class="ruby-constant">TbDisclosure</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:all</span>,<span class="ruby-identifier">:order=</span><span class="ruby-operator">&gt;</span><span class="ruby-value str">'id'</span>,<span class="ruby-identifier">:conditions=</span><span class="ruby-operator">&gt;</span><span class="ruby-identifier">c</span>)
236:     <span class="ruby-keyword kw">end</span>
237:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M001640" class="method-detail">
        <a name="M001640"></a>

        <div class="method-heading">
          <a href="#M001640" class="method-signature">
          <span class="method-name">disc_new</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M001640-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M001640-source">
<pre>
     <span class="ruby-comment cmt"># File app/controllers/caseorg_arbit_controller.rb, line 239</span>
239:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">disc_new</span>
240:     <span class="ruby-comment cmt">#    @arbitman_now=TbArbitmannow.find_by_sql(&quot;select distinct tb_arbitmen.code as code ,tb_arbitmen.name as name from tb_arbitmen,tb_casearbitmen where tb_casearbitmen.recevice_code='#{session[:recevice_code]}' and  tb_arbitmen.code=tb_casearbitmen.arbitman order by tb_arbitmen.name&quot;)</span>
241:     <span class="ruby-ivar">@disc</span>=<span class="ruby-constant">TbDisclosure</span>.<span class="ruby-identifier">new</span>()
242:     <span class="ruby-ivar">@disc</span>.<span class="ruby-identifier">pdate</span>=<span class="ruby-constant">Date</span>.<span class="ruby-identifier">today</span>
243:     <span class="ruby-ivar">@disc</span>.<span class="ruby-identifier">sendrdate</span>=<span class="ruby-constant">Date</span>.<span class="ruby-identifier">today</span>
244:     <span class="ruby-ivar">@disc</span>.<span class="ruby-identifier">sendbdate</span>=<span class="ruby-constant">Date</span>.<span class="ruby-identifier">today</span>
245:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M001643" class="method-detail">
        <a name="M001643"></a>

        <div class="method-heading">
          <a href="#M001643" class="method-signature">
          <span class="method-name">disc_update</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M001643-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M001643-source">
<pre>
     <span class="ruby-comment cmt"># File app/controllers/caseorg_arbit_controller.rb, line 269</span>
269:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">disc_update</span>
270:     <span class="ruby-ivar">@disc</span>=<span class="ruby-constant">TbDisclosure</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">params</span>[<span class="ruby-identifier">:id</span>])
271:     <span class="ruby-ivar">@disc</span>.<span class="ruby-identifier">u</span>=<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:user_code</span>]
272:     <span class="ruby-ivar">@disc</span>.<span class="ruby-identifier">u_t</span>=<span class="ruby-constant">Time</span>.<span class="ruby-identifier">now</span>()
273:     <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@disc</span>.<span class="ruby-identifier">update_attributes</span>(<span class="ruby-identifier">params</span>[<span class="ruby-identifier">:disc</span>])
274:       <span class="ruby-identifier">flash</span>[<span class="ruby-identifier">:notice</span>]=<span class="ruby-value str">&quot;修改成功&quot;</span>
275:       <span class="ruby-identifier">redirect_to</span> <span class="ruby-identifier">:action=</span><span class="ruby-operator">&gt;</span><span class="ruby-value str">&quot;disc_list&quot;</span>,<span class="ruby-identifier">:org_id=</span><span class="ruby-operator">&gt;</span><span class="ruby-identifier">params</span>[<span class="ruby-identifier">:org_id</span>],<span class="ruby-identifier">:recevice_code=</span><span class="ruby-operator">&gt;</span><span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]
276:     <span class="ruby-keyword kw">else</span>
277:       <span class="ruby-identifier">flash</span>[<span class="ruby-identifier">:notice</span>]=<span class="ruby-value str">&quot;修改失败&quot;</span>
278:       <span class="ruby-identifier">render</span> <span class="ruby-identifier">:action=</span><span class="ruby-operator">&gt;</span><span class="ruby-value str">&quot;disc_edit&quot;</span>,<span class="ruby-identifier">:id=</span><span class="ruby-operator">&gt;</span><span class="ruby-identifier">params</span>[<span class="ruby-identifier">:id</span>],<span class="ruby-identifier">:org_id=</span><span class="ruby-operator">&gt;</span><span class="ruby-identifier">params</span>[<span class="ruby-identifier">:org_id</span>],<span class="ruby-identifier">:recevice_code=</span><span class="ruby-operator">&gt;</span><span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]
279:     <span class="ruby-keyword kw">end</span>
280: 
281:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M001633" class="method-detail">
        <a name="M001633"></a>

        <div class="method-heading">
          <a href="#M001633" class="method-signature">
          <span class="method-name">evite_create</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M001633-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M001633-source">
<pre>
     <span class="ruby-comment cmt"># File app/controllers/caseorg_arbit_controller.rb, line 130</span>
130:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">evite_create</span>
131:     <span class="ruby-ivar">@recevice_code</span>=<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]
132:     <span class="ruby-ivar">@evite</span>=<span class="ruby-constant">TbEvite</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">params</span>[<span class="ruby-identifier">:evite</span>])
133:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">params</span>[<span class="ruby-identifier">:condi</span>]<span class="ruby-operator">!=</span><span class="ruby-value str">''</span>
134:       <span class="ruby-ivar">@s1</span> = <span class="ruby-identifier">params</span>[<span class="ruby-identifier">:condi</span>].<span class="ruby-identifier">slice</span>(<span class="ruby-value">0</span>, <span class="ruby-value">1</span>)
135:       <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@s1</span><span class="ruby-operator">==</span><span class="ruby-value str">'a'</span>
136:         <span class="ruby-ivar">@evite</span>.<span class="ruby-identifier">submitman</span>=<span class="ruby-value str">'0001'</span> <span class="ruby-comment cmt">#申请人</span>
137:       <span class="ruby-keyword kw">elsif</span> <span class="ruby-ivar">@s1</span><span class="ruby-operator">==</span><span class="ruby-value str">'b'</span>
138:         <span class="ruby-ivar">@evite</span>.<span class="ruby-identifier">submitman</span>=<span class="ruby-value str">'0002'</span> <span class="ruby-comment cmt">#被申请人</span>
139:       <span class="ruby-keyword kw">else</span>
140:         <span class="ruby-ivar">@evite</span>.<span class="ruby-identifier">submitman</span>=<span class="ruby-keyword kw">nil</span>
141:       <span class="ruby-keyword kw">end</span>
142:       <span class="ruby-ivar">@evite</span>.<span class="ruby-identifier">requestman</span> = <span class="ruby-identifier">params</span>[<span class="ruby-identifier">:condi</span>].<span class="ruby-identifier">slice</span>(<span class="ruby-value">1</span>, <span class="ruby-identifier">params</span>[<span class="ruby-identifier">:condi</span>].<span class="ruby-identifier">length</span><span class="ruby-operator">-</span><span class="ruby-value">1</span>)
143:     <span class="ruby-keyword kw">end</span>
144:     <span class="ruby-ivar">@evite</span>.<span class="ruby-identifier">recevice_code</span>=<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]
145:     <span class="ruby-ivar">@evite</span>.<span class="ruby-identifier">case_code</span>=<span class="ruby-constant">TbCase</span>.<span class="ruby-identifier">find_by_recevice_code</span>(<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]).<span class="ruby-identifier">case_code</span>
146:     <span class="ruby-ivar">@evite</span>.<span class="ruby-identifier">general_code</span>=<span class="ruby-constant">TbCase</span>.<span class="ruby-identifier">find_by_recevice_code</span>(<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]).<span class="ruby-identifier">general_code</span>
147:     <span class="ruby-ivar">@evite</span>.<span class="ruby-identifier">org_id</span>=<span class="ruby-identifier">params</span>[<span class="ruby-identifier">:org_id</span>]
148:     <span class="ruby-ivar">@evite</span>.<span class="ruby-identifier">u</span>=<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:user_code</span>]
149:     <span class="ruby-ivar">@evite</span>.<span class="ruby-identifier">u_t</span>=<span class="ruby-constant">Time</span>.<span class="ruby-identifier">now</span>()
150:     <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@evite</span>.<span class="ruby-identifier">save</span>
151:       <span class="ruby-identifier">flash</span>[<span class="ruby-identifier">:notice</span>]=<span class="ruby-value str">&quot;创建成功&quot;</span>
152:       <span class="ruby-identifier">redirect_to</span> <span class="ruby-identifier">:action=</span><span class="ruby-operator">&gt;</span><span class="ruby-value str">&quot;evite_list&quot;</span>,<span class="ruby-identifier">:org_id=</span><span class="ruby-operator">&gt;</span><span class="ruby-identifier">params</span>[<span class="ruby-identifier">:org_id</span>],<span class="ruby-identifier">:recevice_code=</span><span class="ruby-operator">&gt;</span><span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]
153:     <span class="ruby-keyword kw">else</span>
154:       <span class="ruby-identifier">flash</span>[<span class="ruby-identifier">:notice</span>]=<span class="ruby-value str">&quot;创建失败&quot;</span>
155:       <span class="ruby-identifier">render</span> <span class="ruby-identifier">:action=</span><span class="ruby-operator">&gt;</span><span class="ruby-value str">&quot;evite_new&quot;</span>,<span class="ruby-identifier">:org_id=</span><span class="ruby-operator">&gt;</span><span class="ruby-identifier">params</span>[<span class="ruby-identifier">:org_id</span>],<span class="ruby-identifier">:recevice_code=</span><span class="ruby-operator">&gt;</span><span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]
156:     <span class="ruby-keyword kw">end</span>
157: 
158:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M001638" class="method-detail">
        <a name="M001638"></a>

        <div class="method-heading">
          <a href="#M001638" class="method-signature">
          <span class="method-name">evite_delete</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M001638-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M001638-source">
<pre>
     <span class="ruby-comment cmt"># File app/controllers/caseorg_arbit_controller.rb, line 209</span>
209:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">evite_delete</span>
210:     <span class="ruby-ivar">@evite</span>=<span class="ruby-constant">TbEvite</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">params</span>[<span class="ruby-identifier">:id</span>])
211:     <span class="ruby-ivar">@evite</span>.<span class="ruby-identifier">used</span>=<span class="ruby-value str">&quot;N&quot;</span>
212:     <span class="ruby-ivar">@evite</span>.<span class="ruby-identifier">u</span>=<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:user_code</span>]
213:     <span class="ruby-ivar">@evite</span>.<span class="ruby-identifier">u_t</span>=<span class="ruby-constant">Time</span>.<span class="ruby-identifier">now</span>()
214:     <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@evite</span>.<span class="ruby-identifier">save</span>
215:       <span class="ruby-identifier">flash</span>[<span class="ruby-identifier">:notice</span>]=<span class="ruby-value str">&quot;删除成功&quot;</span>
216:     <span class="ruby-keyword kw">else</span>
217:       <span class="ruby-identifier">flash</span>[<span class="ruby-identifier">:notice</span>]=<span class="ruby-value str">&quot;删除失败&quot;</span>
218:     <span class="ruby-keyword kw">end</span>
219:     <span class="ruby-identifier">redirect_to</span> <span class="ruby-identifier">:action=</span><span class="ruby-operator">&gt;</span><span class="ruby-value str">&quot;evite_list&quot;</span>,<span class="ruby-identifier">:org_id=</span><span class="ruby-operator">&gt;</span><span class="ruby-identifier">params</span>[<span class="ruby-identifier">:org_id</span>],<span class="ruby-identifier">:recevice_code=</span><span class="ruby-operator">&gt;</span><span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]
220:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M001634" class="method-detail">
        <a name="M001634"></a>

        <div class="method-heading">
          <a href="#M001634" class="method-signature">
          <span class="method-name">evite_edit</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M001634-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M001634-source">
<pre>
     <span class="ruby-comment cmt"># File app/controllers/caseorg_arbit_controller.rb, line 160</span>
160:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">evite_edit</span>
161:     <span class="ruby-ivar">@recevice_code</span>=<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]
162:     <span class="ruby-ivar">@arbitman_now</span>=<span class="ruby-constant">TbArbitmannow</span>.<span class="ruby-identifier">find_by_sql</span>(<span class="ruby-node">&quot;select distinct tb_arbitmen.code as code ,tb_arbitmen.name as name from tb_arbitmen,tb_casearbitmen where tb_casearbitmen.recevice_code='#{session[:recevice_code]}' and  tb_arbitmen.code=tb_casearbitmen.arbitman order by tb_arbitmen.name&quot;</span>)
163:     <span class="ruby-ivar">@evite</span>=<span class="ruby-constant">TbEvite</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">params</span>[<span class="ruby-identifier">:id</span>])
164:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M001631" class="method-detail">
        <a name="M001631"></a>

        <div class="method-heading">
          <a href="#M001631" class="method-signature">
          <span class="method-name">evite_list</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M001631-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M001631-source">
<pre>
     <span class="ruby-comment cmt"># File app/controllers/caseorg_arbit_controller.rb, line 106</span>
106:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">evite_list</span>
107:     <span class="ruby-ivar">@case</span>=<span class="ruby-keyword kw">nil</span><span class="ruby-comment cmt">#当前办理案件</span>
108:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]<span class="ruby-operator">==</span><span class="ruby-keyword kw">nil</span>
109:     <span class="ruby-keyword kw">else</span>
110:       <span class="ruby-ivar">@case</span>=<span class="ruby-constant">TbCase</span>.<span class="ruby-identifier">find_by_recevice_code</span>(<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>])
111:       <span class="ruby-ivar">@caseorg</span>=<span class="ruby-constant">TbCaseorg</span>.<span class="ruby-identifier">find_by_recevice_code</span>(<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>])
112:       <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@caseorg!</span>=<span class="ruby-keyword kw">nil</span>
113:         <span class="ruby-identifier">params</span>[<span class="ruby-identifier">:org_id</span>]=<span class="ruby-ivar">@caseorg</span>.<span class="ruby-identifier">id</span>
114:       <span class="ruby-keyword kw">else</span>
115:         <span class="ruby-identifier">params</span>[<span class="ruby-identifier">:org_id</span>]=<span class="ruby-value">0</span>
116:       <span class="ruby-keyword kw">end</span>
117:       <span class="ruby-ivar">@e</span>={<span class="ruby-value">1</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value str">&quot;提醒&quot;</span>,<span class="ruby-value">2</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value str">&quot;不提醒&quot;</span>}
118:       <span class="ruby-identifier">c</span>=<span class="ruby-node">&quot;recevice_code='#{session[:recevice_code]}' and used='Y'&quot;</span><span class="ruby-comment cmt">#org_id=#{params[:org_id]}</span>
119:       <span class="ruby-ivar">@evite</span>=<span class="ruby-constant">TbEvite</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:all</span>,<span class="ruby-identifier">:order=</span><span class="ruby-operator">&gt;</span><span class="ruby-value str">'id'</span>,<span class="ruby-identifier">:conditions=</span><span class="ruby-operator">&gt;</span><span class="ruby-identifier">c</span>)
120:     <span class="ruby-keyword kw">end</span>
121:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M001632" class="method-detail">
        <a name="M001632"></a>

        <div class="method-heading">
          <a href="#M001632" class="method-signature">
          <span class="method-name">evite_new</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M001632-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M001632-source">
<pre>
     <span class="ruby-comment cmt"># File app/controllers/caseorg_arbit_controller.rb, line 123</span>
123:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">evite_new</span>
124:     <span class="ruby-ivar">@recevice_code</span>=<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]
125:     <span class="ruby-comment cmt">#    @arbitman_now=TbArbitmannow.find_by_sql(&quot;select distinct tb_arbitmen.code as code ,tb_arbitmen.name as name from tb_arbitmen,tb_casearbitmen where tb_casearbitmen.recevice_code='#{session[:recevice_code]}' and  tb_arbitmen.code=tb_casearbitmen.arbitman order by tb_arbitmen.name&quot;)</span>
126:     <span class="ruby-ivar">@evite</span>=<span class="ruby-constant">TbEvite</span>.<span class="ruby-identifier">new</span>()
127:     <span class="ruby-ivar">@evite</span>.<span class="ruby-identifier">requestdate</span>=<span class="ruby-constant">Date</span>.<span class="ruby-identifier">today</span>
128:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M001635" class="method-detail">
        <a name="M001635"></a>

        <div class="method-heading">
          <a href="#M001635" class="method-signature">
          <span class="method-name">evite_update</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M001635-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M001635-source">
<pre>
     <span class="ruby-comment cmt"># File app/controllers/caseorg_arbit_controller.rb, line 166</span>
166:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">evite_update</span>
167:     <span class="ruby-ivar">@evite</span>=<span class="ruby-constant">TbEvite</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">params</span>[<span class="ruby-identifier">:id</span>])
168:     <span class="ruby-ivar">@recevice_code</span>=<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]
169:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">params</span>[<span class="ruby-identifier">:condi</span>]<span class="ruby-operator">!=</span><span class="ruby-value str">''</span>
170:       <span class="ruby-ivar">@s1</span> = <span class="ruby-identifier">params</span>[<span class="ruby-identifier">:condi</span>].<span class="ruby-identifier">slice</span>(<span class="ruby-value">0</span>, <span class="ruby-value">1</span>)
171:       <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@s1</span><span class="ruby-operator">==</span><span class="ruby-value str">'a'</span>
172:         <span class="ruby-ivar">@evite</span>.<span class="ruby-identifier">submitman</span>=<span class="ruby-value str">'0001'</span> <span class="ruby-comment cmt">#申请人</span>
173:       <span class="ruby-keyword kw">elsif</span> <span class="ruby-ivar">@s1</span><span class="ruby-operator">==</span><span class="ruby-value str">'b'</span>
174:         <span class="ruby-ivar">@evite</span>.<span class="ruby-identifier">submitman</span>=<span class="ruby-value str">'0002'</span> <span class="ruby-comment cmt">#被申请人</span>
175:       <span class="ruby-keyword kw">else</span>
176:         <span class="ruby-ivar">@evite</span>.<span class="ruby-identifier">submitman</span>=<span class="ruby-keyword kw">nil</span>
177:       <span class="ruby-keyword kw">end</span>
178:       <span class="ruby-ivar">@evite</span>.<span class="ruby-identifier">requestman</span> = <span class="ruby-identifier">params</span>[<span class="ruby-identifier">:condi</span>].<span class="ruby-identifier">slice</span>(<span class="ruby-value">1</span>, <span class="ruby-identifier">params</span>[<span class="ruby-identifier">:condi</span>].<span class="ruby-identifier">length</span><span class="ruby-operator">-</span><span class="ruby-value">1</span>)
179:     <span class="ruby-keyword kw">end</span>
180:     <span class="ruby-ivar">@evite</span>.<span class="ruby-identifier">u</span>=<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:user_code</span>]
181:     <span class="ruby-ivar">@evite</span>.<span class="ruby-identifier">u_t</span>=<span class="ruby-constant">Time</span>.<span class="ruby-identifier">now</span>()
182:     <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@evite</span>.<span class="ruby-identifier">update_attributes</span>(<span class="ruby-identifier">params</span>[<span class="ruby-identifier">:evite</span>])
183:       <span class="ruby-identifier">flash</span>[<span class="ruby-identifier">:notice</span>]=<span class="ruby-value str">&quot;修改成功&quot;</span>
184:       <span class="ruby-identifier">redirect_to</span> <span class="ruby-identifier">:action=</span><span class="ruby-operator">&gt;</span><span class="ruby-value str">&quot;evite_list&quot;</span>,<span class="ruby-identifier">:org_id=</span><span class="ruby-operator">&gt;</span><span class="ruby-identifier">params</span>[<span class="ruby-identifier">:org_id</span>],<span class="ruby-identifier">:recevice_code=</span><span class="ruby-operator">&gt;</span><span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]
185:     <span class="ruby-keyword kw">else</span>
186:       <span class="ruby-identifier">flash</span>[<span class="ruby-identifier">:notice</span>]=<span class="ruby-value str">&quot;修改失败&quot;</span>
187:       <span class="ruby-identifier">render</span> <span class="ruby-identifier">:action=</span><span class="ruby-operator">&gt;</span><span class="ruby-value str">&quot;evite_edit&quot;</span>,<span class="ruby-identifier">:id=</span><span class="ruby-operator">&gt;</span><span class="ruby-identifier">params</span>[<span class="ruby-identifier">:id</span>],<span class="ruby-identifier">:org_id=</span><span class="ruby-operator">&gt;</span><span class="ruby-identifier">params</span>[<span class="ruby-identifier">:org_id</span>],<span class="ruby-identifier">:recevice_code=</span><span class="ruby-operator">&gt;</span><span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]
188:     <span class="ruby-keyword kw">end</span>
189: 
190:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M001625" class="method-detail">
        <a name="M001625"></a>

        <div class="method-heading">
          <a href="#M001625" class="method-signature">
          <span class="method-name">list</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M001625-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M001625-source">
<pre>
    <span class="ruby-comment cmt"># File app/controllers/caseorg_arbit_controller.rb, line 3</span>
 3:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">list</span>
 4:     <span class="ruby-ivar">@hant_search_1_page_name</span>=<span class="ruby-value str">&quot;list&quot;</span>
 5:     <span class="ruby-ivar">@hant_search_1</span>=[[<span class="ruby-value str">'char'</span>,<span class="ruby-value str">'tb_cases_case_code'</span>,<span class="ruby-value str">'案号'</span>,<span class="ruby-value str">'text'</span>,[]],[<span class="ruby-value str">'char'</span>,<span class="ruby-value str">'tb_parties_partyname'</span>,<span class="ruby-value str">'当事人名称'</span>,<span class="ruby-value str">'text'</span>,[]],[<span class="ruby-value str">'char'</span>,<span class="ruby-value str">'tb_parties_partytype'</span>,<span class="ruby-value str">'当事人类型'</span>,<span class="ruby-value str">'select'</span>,[[<span class="ruby-value">1</span>,<span class="ruby-value str">'申请人'</span>],[<span class="ruby-value">2</span>,<span class="ruby-value str">'被申请人'</span>]]],[<span class="ruby-value str">'char'</span>,<span class="ruby-value str">'tb_cases_recevice_code'</span>,<span class="ruby-value str">'咨询流水号'</span>,<span class="ruby-value str">'text'</span>,[]]]
 6:     <span class="ruby-ivar">@order</span>=<span class="ruby-identifier">params</span>[<span class="ruby-identifier">:order</span>]
 7:     <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@order</span><span class="ruby-operator">==</span><span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@order</span><span class="ruby-operator">==</span><span class="ruby-value str">&quot;&quot;</span>
 8:       <span class="ruby-ivar">@order</span>=<span class="ruby-value str">&quot;tb_cases_recevice_code desc&quot;</span>
 9:     <span class="ruby-keyword kw">end</span>
10:     <span class="ruby-ivar">@page_lines</span>=<span class="ruby-identifier">params</span>[<span class="ruby-identifier">:page_lines</span>]
11:     <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@page_lines</span><span class="ruby-operator">==</span><span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@page_lines</span><span class="ruby-operator">==</span><span class="ruby-value str">&quot;&quot;</span>
12:       <span class="ruby-ivar">@page_lines</span>=<span class="ruby-value">20</span>
13:     <span class="ruby-keyword kw">end</span>
14:     <span class="ruby-identifier">hant_search_1_word</span>=<span class="ruby-identifier">params</span>[<span class="ruby-identifier">:hant_search_1_word</span>]
15:     <span class="ruby-ivar">@search_condit</span>=<span class="ruby-identifier">params</span>[<span class="ruby-identifier">:search_condit</span>]
16:     <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@search_condit</span><span class="ruby-operator">==</span><span class="ruby-keyword kw">nil</span>
17:       <span class="ruby-ivar">@search_condit</span>=<span class="ruby-value str">&quot;&quot;</span>
18:     <span class="ruby-keyword kw">end</span>
19:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">hant_search_1_word</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-identifier">hant_search_1_word</span> <span class="ruby-operator">==</span><span class="ruby-value str">&quot;&quot;</span>
20:     <span class="ruby-keyword kw">else</span>
21:       <span class="ruby-ivar">@search_condit</span>= <span class="ruby-value str">&quot; and &quot;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">hant_search_1_word</span>
22:     <span class="ruby-keyword kw">end</span>
23:     <span class="ruby-identifier">c</span>=<span class="ruby-node">&quot;tb_cases_state&gt;=4 and tb_cases_state&lt;100 and tb_cases_clerk='#{session[:user_code]}' and tb_cases_end_code='' and tb_cases_state&lt;&gt;2 and tb_cases_state&lt;&gt;3&quot;</span><span class="ruby-comment cmt">#立案未结案</span>
24:     <span class="ruby-identifier">p</span>=<span class="ruby-constant">PubTool</span>.<span class="ruby-identifier">new</span>()
25:     <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@search_condit!</span>= <span class="ruby-value str">&quot; and &quot;</span> <span class="ruby-keyword kw">and</span> <span class="ruby-identifier">p</span>.<span class="ruby-identifier">sql_check_3</span>(<span class="ruby-ivar">@search_condit</span>)<span class="ruby-operator">!=</span><span class="ruby-keyword kw">false</span>
26:       <span class="ruby-identifier">c</span> = <span class="ruby-identifier">c</span> <span class="ruby-operator">+</span> <span class="ruby-ivar">@search_condit</span>
27:     <span class="ruby-keyword kw">end</span>
28:     <span class="ruby-ivar">@case_pages</span>,<span class="ruby-ivar">@case</span>=<span class="ruby-identifier">paginate_by_sql</span>(<span class="ruby-constant">VCaseQuery1List1</span>,<span class="ruby-node">&quot;select distinct tb_cases_state,tb_cases_recevice_code,tb_cases_general_code,tb_cases_case_code, tb_cases_end_code,tb_cases_clerk,tb_cases_clerk_2,tb_cases_receivedate,tb_cases_nowdate from v_case_query1_list1s where #{c}  order by #{@order}&quot;</span>,<span class="ruby-ivar">@page_lines</span>.<span class="ruby-identifier">to_i</span>)
29:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M001627" class="method-detail">
        <a name="M001627"></a>

        <div class="method-heading">
          <a href="#M001627" class="method-signature">
          <span class="method-name">rate_set</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M001627-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M001627-source">
<pre>
    <span class="ruby-comment cmt"># File app/controllers/caseorg_arbit_controller.rb, line 45</span>
45:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">rate_set</span>
46:     <span class="ruby-identifier">render</span> <span class="ruby-identifier">:update</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">page</span><span class="ruby-operator">|</span>
47:       <span class="ruby-identifier">page</span>.<span class="ruby-identifier">remove</span> <span class="ruby-value str">'arbitman_currency'</span>
48:       <span class="ruby-identifier">page</span>.<span class="ruby-identifier">remove</span> <span class="ruby-value str">'arbitman_rmb_money'</span>
49:       <span class="ruby-identifier">page</span>.<span class="ruby-identifier">replace_html</span> <span class="ruby-value str">'rate_set'</span>, <span class="ruby-identifier">:partial</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'rate'</span>,<span class="ruby-identifier">:object=</span><span class="ruby-operator">&gt;</span><span class="ruby-constant">Region</span>.<span class="ruby-identifier">find_by_code</span>(<span class="ruby-constant">TbArbitman</span>.<span class="ruby-identifier">find_by_code</span>(<span class="ruby-identifier">params</span>[<span class="ruby-identifier">:arbitman_code</span>])).<span class="ruby-identifier">rate_code</span>
50:     <span class="ruby-keyword kw">end</span>
51:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M001653" class="method-detail">
        <a name="M001653"></a>

        <div class="method-heading">
          <a href="#M001653" class="method-signature">
          <span class="method-name">reason_create</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M001653-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M001653-source">
<pre>
     <span class="ruby-comment cmt"># File app/controllers/caseorg_arbit_controller.rb, line 411</span>
411:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">reason_create</span>
412:     <span class="ruby-ivar">@reason</span>=<span class="ruby-constant">TbChangereason</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">params</span>[<span class="ruby-identifier">:reason</span>])
413:     <span class="ruby-ivar">@reason</span>.<span class="ruby-identifier">recevice_code</span>=<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]
414:     <span class="ruby-ivar">@reason</span>.<span class="ruby-identifier">case_code</span>=<span class="ruby-constant">TbCase</span>.<span class="ruby-identifier">find_by_recevice_code</span>(<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]).<span class="ruby-identifier">case_code</span>
415:     <span class="ruby-ivar">@reason</span>.<span class="ruby-identifier">general_code</span>=<span class="ruby-constant">TbCase</span>.<span class="ruby-identifier">find_by_recevice_code</span>(<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]).<span class="ruby-identifier">general_code</span>
416:     <span class="ruby-ivar">@reason</span>.<span class="ruby-identifier">change_id</span>=<span class="ruby-identifier">params</span>[<span class="ruby-identifier">:change_id</span>]
417:     <span class="ruby-ivar">@reason</span>.<span class="ruby-identifier">u</span>=<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:user_code</span>]
418:     <span class="ruby-ivar">@reason</span>.<span class="ruby-identifier">u_t</span>=<span class="ruby-constant">Time</span>.<span class="ruby-identifier">now</span>()
419:     <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@reason</span>.<span class="ruby-identifier">save</span>
420:       <span class="ruby-identifier">flash</span>[<span class="ruby-identifier">:notice</span>]=<span class="ruby-value str">&quot;创建成功&quot;</span>
421:       <span class="ruby-identifier">redirect_to</span> <span class="ruby-identifier">:action=</span><span class="ruby-operator">&gt;</span><span class="ruby-value str">&quot;reason_list&quot;</span>,<span class="ruby-identifier">:change_id=</span><span class="ruby-operator">&gt;</span><span class="ruby-identifier">params</span>[<span class="ruby-identifier">:change_id</span>],<span class="ruby-identifier">:recevice_code=</span><span class="ruby-operator">&gt;</span><span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]
422:     <span class="ruby-keyword kw">else</span>
423:       <span class="ruby-identifier">flash</span>[<span class="ruby-identifier">:notice</span>]=<span class="ruby-value str">&quot;创建失败&quot;</span>
424:       <span class="ruby-identifier">render</span> <span class="ruby-identifier">:action=</span><span class="ruby-operator">&gt;</span><span class="ruby-value str">&quot;reason_new&quot;</span>,<span class="ruby-identifier">:change_id=</span><span class="ruby-operator">&gt;</span><span class="ruby-identifier">params</span>[<span class="ruby-identifier">:change_id</span>],<span class="ruby-identifier">:recevice_code=</span><span class="ruby-operator">&gt;</span><span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]
425:     <span class="ruby-keyword kw">end</span>
426:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M001656" class="method-detail">
        <a name="M001656"></a>

        <div class="method-heading">
          <a href="#M001656" class="method-signature">
          <span class="method-name">reason_delete</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M001656-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M001656-source">
<pre>
     <span class="ruby-comment cmt"># File app/controllers/caseorg_arbit_controller.rb, line 446</span>
446:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">reason_delete</span>
447:     <span class="ruby-ivar">@reason</span>=<span class="ruby-constant">TbChangereason</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">params</span>[<span class="ruby-identifier">:id</span>])
448:     <span class="ruby-ivar">@reason</span>.<span class="ruby-identifier">used</span>=<span class="ruby-value str">&quot;N&quot;</span>
449:     <span class="ruby-ivar">@reason</span>.<span class="ruby-identifier">u</span>=<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:user_code</span>]
450:     <span class="ruby-ivar">@reason</span>.<span class="ruby-identifier">u_t</span>=<span class="ruby-constant">Time</span>.<span class="ruby-identifier">now</span>()
451:     <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@reason</span>.<span class="ruby-identifier">save</span>
452:       <span class="ruby-identifier">flash</span>[<span class="ruby-identifier">:notice</span>]=<span class="ruby-value str">&quot;删除成功&quot;</span>
453:     <span class="ruby-keyword kw">else</span>
454:       <span class="ruby-identifier">flash</span>[<span class="ruby-identifier">:notice</span>]=<span class="ruby-value str">&quot;删除失败&quot;</span>
455:     <span class="ruby-keyword kw">end</span>
456:     <span class="ruby-identifier">redirect_to</span> <span class="ruby-identifier">:action=</span><span class="ruby-operator">&gt;</span><span class="ruby-value str">&quot;reason_list&quot;</span>,<span class="ruby-identifier">:change_id=</span><span class="ruby-operator">&gt;</span><span class="ruby-identifier">params</span>[<span class="ruby-identifier">:change_id</span>],<span class="ruby-identifier">:recevice_code=</span><span class="ruby-operator">&gt;</span><span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]
457:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M001654" class="method-detail">
        <a name="M001654"></a>

        <div class="method-heading">
          <a href="#M001654" class="method-signature">
          <span class="method-name">reason_edit</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M001654-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M001654-source">
<pre>
     <span class="ruby-comment cmt"># File app/controllers/caseorg_arbit_controller.rb, line 428</span>
428:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">reason_edit</span>
429:     <span class="ruby-ivar">@reason</span>=<span class="ruby-constant">TbChangereason</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">params</span>[<span class="ruby-identifier">:id</span>])
430:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M001651" class="method-detail">
        <a name="M001651"></a>

        <div class="method-heading">
          <a href="#M001651" class="method-signature">
          <span class="method-name">reason_list</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M001651-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M001651-source">
<pre>
     <span class="ruby-comment cmt"># File app/controllers/caseorg_arbit_controller.rb, line 391</span>
391:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">reason_list</span>
392:     <span class="ruby-ivar">@case</span>=<span class="ruby-keyword kw">nil</span><span class="ruby-comment cmt">#当前办理案件</span>
393:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]<span class="ruby-operator">==</span><span class="ruby-keyword kw">nil</span>
394:     <span class="ruby-keyword kw">else</span>
395:       <span class="ruby-ivar">@case</span>=<span class="ruby-constant">TbCase</span>.<span class="ruby-identifier">find_by_recevice_code</span>(<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>])
396:       <span class="ruby-ivar">@caseorg</span>=<span class="ruby-constant">TbCaseorg</span>.<span class="ruby-identifier">find_by_recevice_code</span>(<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>])
397:       <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@caseorg!</span>=<span class="ruby-keyword kw">nil</span>
398:         <span class="ruby-identifier">params</span>[<span class="ruby-identifier">:org_id</span>]=<span class="ruby-ivar">@caseorg</span>.<span class="ruby-identifier">id</span>
399:       <span class="ruby-keyword kw">else</span>
400:         <span class="ruby-identifier">params</span>[<span class="ruby-identifier">:org_id</span>]=<span class="ruby-value">0</span>
401:       <span class="ruby-keyword kw">end</span>
402:       <span class="ruby-identifier">c</span>=<span class="ruby-node">&quot;recevice_code='#{session[:recevice_code]}' and used='Y' and change_id=#{params[:change_id]}&quot;</span>
403:       <span class="ruby-ivar">@reason_pages</span>,<span class="ruby-ivar">@reason</span>=<span class="ruby-identifier">paginate</span>(<span class="ruby-identifier">:tb_changereasons</span>,<span class="ruby-identifier">:order=</span><span class="ruby-operator">&gt;</span><span class="ruby-value str">'id'</span>,<span class="ruby-identifier">:conditions=</span><span class="ruby-operator">&gt;</span><span class="ruby-identifier">c</span>)
404:     <span class="ruby-keyword kw">end</span>
405:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M001652" class="method-detail">
        <a name="M001652"></a>

        <div class="method-heading">
          <a href="#M001652" class="method-signature">
          <span class="method-name">reason_new</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M001652-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M001652-source">
<pre>
     <span class="ruby-comment cmt"># File app/controllers/caseorg_arbit_controller.rb, line 407</span>
407:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">reason_new</span>
408:     <span class="ruby-ivar">@reason</span>=<span class="ruby-constant">TbChangereason</span>.<span class="ruby-identifier">new</span>()
409:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M001655" class="method-detail">
        <a name="M001655"></a>

        <div class="method-heading">
          <a href="#M001655" class="method-signature">
          <span class="method-name">reason_update</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M001655-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M001655-source">
<pre>
     <span class="ruby-comment cmt"># File app/controllers/caseorg_arbit_controller.rb, line 432</span>
432:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">reason_update</span>
433:     <span class="ruby-ivar">@reason</span>=<span class="ruby-constant">TbChangereason</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">params</span>[<span class="ruby-identifier">:id</span>])
434:     <span class="ruby-ivar">@reason</span>.<span class="ruby-identifier">u</span>=<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:user_code</span>]
435:     <span class="ruby-ivar">@reason</span>.<span class="ruby-identifier">u_t</span>=<span class="ruby-constant">Time</span>.<span class="ruby-identifier">now</span>()
436:     <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@reason</span>.<span class="ruby-identifier">update_attributes</span>(<span class="ruby-identifier">params</span>[<span class="ruby-identifier">:reason</span>])
437:       <span class="ruby-identifier">flash</span>[<span class="ruby-identifier">:notice</span>]=<span class="ruby-value str">&quot;修改成功&quot;</span>
438:       <span class="ruby-identifier">redirect_to</span> <span class="ruby-identifier">:action=</span><span class="ruby-operator">&gt;</span><span class="ruby-value str">&quot;reason_list&quot;</span>,<span class="ruby-identifier">:id=</span><span class="ruby-operator">&gt;</span><span class="ruby-identifier">params</span>[<span class="ruby-identifier">:id</span>],<span class="ruby-identifier">:change_id=</span><span class="ruby-operator">&gt;</span><span class="ruby-identifier">params</span>[<span class="ruby-identifier">:change_id</span>],<span class="ruby-identifier">:recevice_code=</span><span class="ruby-operator">&gt;</span><span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]
439:     <span class="ruby-keyword kw">else</span>
440:       <span class="ruby-identifier">flash</span>[<span class="ruby-identifier">:notice</span>]=<span class="ruby-value str">&quot;修改失败&quot;</span>
441:       <span class="ruby-identifier">render</span> <span class="ruby-identifier">:action=</span><span class="ruby-operator">&gt;</span><span class="ruby-value str">&quot;reason_edit&quot;</span>,<span class="ruby-identifier">:id=</span><span class="ruby-operator">&gt;</span><span class="ruby-identifier">params</span>[<span class="ruby-identifier">:id</span>],<span class="ruby-identifier">:change_id=</span><span class="ruby-operator">&gt;</span><span class="ruby-identifier">params</span>[<span class="ruby-identifier">:change_id</span>],<span class="ruby-identifier">:recevice_code=</span><span class="ruby-operator">&gt;</span><span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]
442:     <span class="ruby-keyword kw">end</span>
443: 
444:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M001636" class="method-detail">
        <a name="M001636"></a>

        <div class="method-heading">
          <a href="#M001636" class="method-signature">
          <span class="method-name">remind_change</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M001636-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M001636-source">
<pre>
     <span class="ruby-comment cmt"># File app/controllers/caseorg_arbit_controller.rb, line 192</span>
192:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">remind_change</span>
193:     <span class="ruby-ivar">@evite</span>=<span class="ruby-constant">TbEvite</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">params</span>[<span class="ruby-identifier">:id</span>])
194:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M001637" class="method-detail">
        <a name="M001637"></a>

        <div class="method-heading">
          <a href="#M001637" class="method-signature">
          <span class="method-name">remind_update</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M001637-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M001637-source">
<pre>
     <span class="ruby-comment cmt"># File app/controllers/caseorg_arbit_controller.rb, line 196</span>
196:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">remind_update</span>
197:     <span class="ruby-ivar">@evite</span>=<span class="ruby-constant">TbEvite</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">params</span>[<span class="ruby-identifier">:id</span>])
198:     <span class="ruby-ivar">@evite</span>.<span class="ruby-identifier">remind_t</span>=<span class="ruby-constant">Time</span>.<span class="ruby-identifier">now</span>()
199:     <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@evite</span>.<span class="ruby-identifier">update_attributes</span>(<span class="ruby-identifier">params</span>[<span class="ruby-identifier">:evite</span>])
200:       <span class="ruby-identifier">flash</span>[<span class="ruby-identifier">:notice</span>]=<span class="ruby-value str">&quot;设置成功&quot;</span>
201:       <span class="ruby-identifier">redirect_to</span> <span class="ruby-identifier">:action=</span><span class="ruby-operator">&gt;</span><span class="ruby-value str">&quot;evite_list&quot;</span>,<span class="ruby-identifier">:org_id=</span><span class="ruby-operator">&gt;</span><span class="ruby-identifier">params</span>[<span class="ruby-identifier">:org_id</span>],<span class="ruby-identifier">:recevice_code=</span><span class="ruby-operator">&gt;</span><span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]
202:     <span class="ruby-keyword kw">else</span>
203:       <span class="ruby-identifier">flash</span>[<span class="ruby-identifier">:notice</span>]=<span class="ruby-value str">&quot;设置失败&quot;</span>
204:       <span class="ruby-identifier">render</span> <span class="ruby-identifier">:action=</span><span class="ruby-operator">&gt;</span><span class="ruby-value str">&quot;remind_change&quot;</span>,<span class="ruby-identifier">:id=</span><span class="ruby-operator">&gt;</span><span class="ruby-identifier">params</span>[<span class="ruby-identifier">:id</span>],<span class="ruby-identifier">:org_id=</span><span class="ruby-operator">&gt;</span><span class="ruby-identifier">params</span>[<span class="ruby-identifier">:org_id</span>],<span class="ruby-identifier">:recevice_code=</span><span class="ruby-operator">&gt;</span><span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]
205:     <span class="ruby-keyword kw">end</span>
206: 
207:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>


    </div>


  </div>


<div id="validator-badges">
  <p><small><a href="http://validator.w3.org/check/referer">[Validate]</a></small></p>
</div>

</body>
</html>