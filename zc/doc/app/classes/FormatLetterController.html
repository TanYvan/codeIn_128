<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE html 
     PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
     "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <title>Class: FormatLetterController</title>
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
  <meta http-equiv="Content-Script-Type" content="text/javascript" />
  <link rel="stylesheet" href=".././rdoc-style.css" type="text/css" media="screen" />
  <script type="text/javascript">
  // <![CDATA[

  function popupCode( url ) {
    window.open(url, "Code", "resizable=yes,scrollbars=yes,toolbar=no,status=no,height=150,width=400")
  }

  function toggleCode( id ) {
    if ( document.getElementById )
      elem = document.getElementById( id );
    else if ( document.all )
      elem = eval( "document.all." + id );
    else
      return false;

    elemStyle = elem.style;
    
    if ( elemStyle.display != "block" ) {
      elemStyle.display = "block"
    } else {
      elemStyle.display = "none"
    }

    return true;
  }
  
  // Make codeblocks hidden by default
  document.writeln( "<style type=\"text/css\">div.method-source-code { display: none }</style>" )
  
  // ]]>
  </script>

</head>
<body>



    <div id="classHeader">
        <table class="header-table">
        <tr class="top-aligned-row">
          <td><strong>Class</strong></td>
          <td class="class-name-in-header">FormatLetterController</td>
        </tr>
        <tr class="top-aligned-row">
            <td><strong>In:</strong></td>
            <td>
                <a href="../files/app/controllers/format_letter_controller_rb.html">
                app/controllers/format_letter_controller.rb
                </a>
        <br />
            </td>
        </tr>

        <tr class="top-aligned-row">
            <td><strong>Parent:</strong></td>
            <td>
                <a href="ApplicationController.html">
                ApplicationController
               </a>
            </td>
        </tr>
        </table>
    </div>
  <!-- banner header -->

  <div id="bodyContent">



  <div id="contextContent">

    <div id="description">
      <p>
为每个格式函生成供处理的二维数组的类 添加人 苏获
添加时间 20090615
</p>

    </div>


   </div>

    <div id="method-list">
      <h3 class="section-bar">Methods</h3>

      <div class="name-list">
      <a href="#M000186">add_last_record</a>&nbsp;&nbsp;
      <a href="#M000185">add_record</a>&nbsp;&nbsp;
      <a href="#M000189">applicant_arbit_fee</a>&nbsp;&nbsp;
      <a href="#M000193">applicant_arbitrator</a>&nbsp;&nbsp;
      <a href="#M000187">applicant_litigation_fee</a>&nbsp;&nbsp;
      <a href="#M000192">chief_arbitrator</a>&nbsp;&nbsp;
      <a href="#M000141">format_letter_dfmt04</a>&nbsp;&nbsp;
      <a href="#M000142">format_letter_dfmt05</a>&nbsp;&nbsp;
      <a href="#M000143">format_letter_dfmt06</a>&nbsp;&nbsp;
      <a href="#M000144">format_letter_dfmt07</a>&nbsp;&nbsp;
      <a href="#M000145">format_letter_dfmt09</a>&nbsp;&nbsp;
      <a href="#M000147">format_letter_dfmt26</a>&nbsp;&nbsp;
      <a href="#M000146">format_letter_dfmt26</a>&nbsp;&nbsp;
      <a href="#M000148">format_letter_dfmt31</a>&nbsp;&nbsp;
      <a href="#M000149">format_letter_dfmt32</a>&nbsp;&nbsp;
      <a href="#M000150">format_letter_dfor03</a>&nbsp;&nbsp;
      <a href="#M000151">format_letter_fmt04</a>&nbsp;&nbsp;
      <a href="#M000152">format_letter_fmt05</a>&nbsp;&nbsp;
      <a href="#M000153">format_letter_fmt06</a>&nbsp;&nbsp;
      <a href="#M000154">format_letter_fmt07</a>&nbsp;&nbsp;
      <a href="#M000155">format_letter_fmt09</a>&nbsp;&nbsp;
      <a href="#M000156">format_letter_fmt11a</a>&nbsp;&nbsp;
      <a href="#M000157">format_letter_fmt14</a>&nbsp;&nbsp;
      <a href="#M000158">format_letter_fmt15</a>&nbsp;&nbsp;
      <a href="#M000159">format_letter_fmt17</a>&nbsp;&nbsp;
      <a href="#M000160">format_letter_fmt18</a>&nbsp;&nbsp;
      <a href="#M000161">format_letter_fmt19</a>&nbsp;&nbsp;
      <a href="#M000162">format_letter_fmt20</a>&nbsp;&nbsp;
      <a href="#M000163">format_letter_fmt23b</a>&nbsp;&nbsp;
      <a href="#M000164">format_letter_fmt23e</a>&nbsp;&nbsp;
      <a href="#M000165">format_letter_fmt24</a>&nbsp;&nbsp;
      <a href="#M000166">format_letter_fmt26</a>&nbsp;&nbsp;
      <a href="#M000167">format_letter_fmt27</a>&nbsp;&nbsp;
      <a href="#M000168">format_letter_fmt31</a>&nbsp;&nbsp;
      <a href="#M000169">format_letter_fmt32</a>&nbsp;&nbsp;
      <a href="#M000170">format_letter_fmt33</a>&nbsp;&nbsp;
      <a href="#M000171">format_letter_fmt34</a>&nbsp;&nbsp;
      <a href="#M000172">format_letter_fmt35</a>&nbsp;&nbsp;
      <a href="#M000173">format_letter_fmt36</a>&nbsp;&nbsp;
      <a href="#M000174">format_letter_fmt37</a>&nbsp;&nbsp;
      <a href="#M000175">format_letter_fmt38a</a>&nbsp;&nbsp;
      <a href="#M000176">format_letter_fmt39</a>&nbsp;&nbsp;
      <a href="#M000177">format_letter_fmt40</a>&nbsp;&nbsp;
      <a href="#M000178">format_letter_fmt41</a>&nbsp;&nbsp;
      <a href="#M000179">format_letter_fmt42</a>&nbsp;&nbsp;
      <a href="#M000180">format_letter_fmt44</a>&nbsp;&nbsp;
      <a href="#M000181">format_letter_fmt45</a>&nbsp;&nbsp;
      <a href="#M000182">format_letter_fmt46</a>&nbsp;&nbsp;
      <a href="#M000183">format_letter_fmt47</a>&nbsp;&nbsp;
      <a href="#M000184">format_letter_for03</a>&nbsp;&nbsp;
      <a href="#M000195">independent_arbitrator</a>&nbsp;&nbsp;
      <a href="#M000191">num_papers</a>&nbsp;&nbsp;
      <a href="#M000190">respondent_arbit_fee</a>&nbsp;&nbsp;
      <a href="#M000194">respondent_arbitrator</a>&nbsp;&nbsp;
      <a href="#M000188">respondent_litigation_fee</a>&nbsp;&nbsp;
      <a href="#M000139">show</a>&nbsp;&nbsp;
      <a href="#M000140">up_doc</a>&nbsp;&nbsp;
      </div>
    </div>

  </div>


    <!-- if includes -->

    <div id="section">





      


    <!-- if method_list -->
    <div id="methods">
      <h3 class="section-bar">Public Instance methods</h3>

      <div id="method-M000186" class="method-detail">
        <a name="M000186"></a>

        <div class="method-heading">
          <a href="#M000186" class="method-signature">
          <span class="method-name">add_last_record</span><span class="method-args">(str_src,str_des,str_prm)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
最后一个添加项
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000186-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000186-source">
<pre>
      <span class="ruby-comment cmt"># File app/controllers/format_letter_controller.rb, line 2810</span>
2810:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">add_last_record</span>(<span class="ruby-identifier">str_src</span>,<span class="ruby-identifier">str_des</span>,<span class="ruby-identifier">str_prm</span>)
2811:         <span class="ruby-identifier">str_prm</span> = <span class="ruby-identifier">str_prm</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">str_src</span>.<span class="ruby-identifier">to_s</span>
2812:         <span class="ruby-identifier">str_prm</span> = <span class="ruby-identifier">str_prm</span> <span class="ruby-operator">+</span> <span class="ruby-value str">&quot;,&quot;</span>
2813:         <span class="ruby-identifier">str_prm</span> = <span class="ruby-identifier">str_prm</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">str_des</span>.<span class="ruby-identifier">to_s</span>
2814:         <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">str_prm</span>
2815:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000185" class="method-detail">
        <a name="M000185"></a>

        <div class="method-heading">
          <a href="#M000185" class="method-signature">
          <span class="method-name">add_record</span><span class="method-args">(str_src,str_des,str_prm)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
私有函数
</p>
<p>
添加替换项
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000185-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000185-source">
<pre>
      <span class="ruby-comment cmt"># File app/controllers/format_letter_controller.rb, line 2802</span>
2802:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">add_record</span>(<span class="ruby-identifier">str_src</span>,<span class="ruby-identifier">str_des</span>,<span class="ruby-identifier">str_prm</span>)
2803:         <span class="ruby-identifier">str_prm</span> = <span class="ruby-identifier">str_prm</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">str_src</span>.<span class="ruby-identifier">to_s</span>
2804:         <span class="ruby-identifier">str_prm</span> = <span class="ruby-identifier">str_prm</span> <span class="ruby-operator">+</span> <span class="ruby-value str">&quot;,&quot;</span>
2805:         <span class="ruby-identifier">str_prm</span> = <span class="ruby-identifier">str_prm</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">str_des</span>.<span class="ruby-identifier">to_s</span>
2806:         <span class="ruby-identifier">str_prm</span> = <span class="ruby-identifier">str_prm</span> <span class="ruby-operator">+</span> <span class="ruby-value str">&quot;;&quot;</span>
2807:         <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">str_prm</span>
2808:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000189" class="method-detail">
        <a name="M000189"></a>

        <div class="method-heading">
          <a href="#M000189" class="method-signature">
          <span class="method-name">applicant_arbit_fee</span><span class="method-args">(code)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
申请人处理费、仲裁费
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000189-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000189-source">
<pre>
      <span class="ruby-comment cmt"># File app/controllers/format_letter_controller.rb, line 2833</span>
2833:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">applicant_arbit_fee</span>(<span class="ruby-identifier">code</span>)
2834:         <span class="ruby-ivar">@applicant_arbit_fee</span> = <span class="ruby-constant">TbShouldCharge</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:first</span>, <span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">&quot;used = 'Y' and recevice_code = ? and typ = '0001' and payment = '0001'&quot;</span>,<span class="ruby-identifier">code</span>])  
2835:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@applicant_arbit_fee</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span>
2836:             <span class="ruby-keyword kw">return</span> <span class="ruby-value str">&quot;no&quot;</span>
2837:         <span class="ruby-keyword kw">end</span>         
2838:         <span class="ruby-keyword kw">return</span> <span class="ruby-ivar">@applicant_arbit_fee</span>.<span class="ruby-identifier">rmb_money</span>
2839:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000193" class="method-detail">
        <a name="M000193"></a>

        <div class="method-heading">
          <a href="#M000193" class="method-signature">
          <span class="method-name">applicant_arbitrator</span><span class="method-args">(code)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
获取案件申请人仲裁员
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000193-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000193-source">
<pre>
      <span class="ruby-comment cmt"># File app/controllers/format_letter_controller.rb, line 2870</span>
2870:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">applicant_arbitrator</span>(<span class="ruby-identifier">code</span>)
2871:         <span class="ruby-ivar">@case_arbitman</span> = <span class="ruby-constant">TbCasearbitman</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:first</span>, <span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">&quot;used = 'Y' and recevice_code = ? and arbitmantype = '0003'&quot;</span>,<span class="ruby-identifier">code</span>])
2872:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@case_arbitman</span> <span class="ruby-operator">!=</span> <span class="ruby-keyword kw">nil</span>
2873:             <span class="ruby-identifier">arbitman_code</span> = <span class="ruby-ivar">@case_arbitman</span>.<span class="ruby-identifier">arbitman</span>
2874:             <span class="ruby-identifier">applicant_arbitrator</span> = <span class="ruby-constant">TbArbitman</span>.<span class="ruby-identifier">find</span>([<span class="ruby-value str">&quot;used = 'Y' and code = ? &quot;</span>,<span class="ruby-identifier">arbitman_code</span>])
2875:             <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">applicant_arbitrator</span> <span class="ruby-operator">!=</span> <span class="ruby-keyword kw">nil</span>
2876:                 <span class="ruby-identifier">applicant_arbitrator</span> = <span class="ruby-identifier">applicant_arbitrator</span>.<span class="ruby-identifier">name</span>
2877:             <span class="ruby-keyword kw">else</span>
2878:                 <span class="ruby-identifier">applicant_arbitrator</span> = <span class="ruby-value str">&quot;no&quot;</span>
2879:             <span class="ruby-keyword kw">end</span>
2880:         <span class="ruby-keyword kw">else</span>
2881:             <span class="ruby-identifier">applicant_arbitrator</span> = <span class="ruby-value str">&quot;no&quot;</span>
2882:         <span class="ruby-keyword kw">end</span>
2883:         <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">applicant_arbitrator</span> 
2884:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000187" class="method-detail">
        <a name="M000187"></a>

        <div class="method-heading">
          <a href="#M000187" class="method-signature">
          <span class="method-name">applicant_litigation_fee</span><span class="method-args">(code)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
申请人受理费
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000187-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000187-source">
<pre>
      <span class="ruby-comment cmt"># File app/controllers/format_letter_controller.rb, line 2817</span>
2817:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">applicant_litigation_fee</span>(<span class="ruby-identifier">code</span>)
2818:         <span class="ruby-ivar">@applicant_litigation_fee</span> = <span class="ruby-constant">TbShouldCharge</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:first</span>, <span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">&quot;used = 'Y' and recevice_code = ? and typ = '0001' and payment = '0001'&quot;</span>,<span class="ruby-identifier">code</span>])  
2819:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@applicant_litigation_fee</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span>
2820:             <span class="ruby-keyword kw">return</span> <span class="ruby-value str">&quot;no&quot;</span>
2821:         <span class="ruby-keyword kw">end</span>
2822:         <span class="ruby-keyword kw">return</span> <span class="ruby-ivar">@applicant_litigation_fee</span>.<span class="ruby-identifier">rmb_money</span>
2823:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000192" class="method-detail">
        <a name="M000192"></a>

        <div class="method-heading">
          <a href="#M000192" class="method-signature">
          <span class="method-name">chief_arbitrator</span><span class="method-args">(code)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
获取案件首席仲裁员
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000192-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000192-source">
<pre>
      <span class="ruby-comment cmt"># File app/controllers/format_letter_controller.rb, line 2853</span>
2853:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">chief_arbitrator</span>(<span class="ruby-identifier">code</span>)
2854:         <span class="ruby-ivar">@case_arbitman</span> = <span class="ruby-constant">TbCasearbitman</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:first</span>, <span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">&quot;used = 'Y' and recevice_code = ? and arbitmantype = '0002'&quot;</span>,<span class="ruby-identifier">code</span>])
2855:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@case_arbitman</span> <span class="ruby-operator">!=</span> <span class="ruby-keyword kw">nil</span>
2856:             <span class="ruby-identifier">arbitman_code</span> = <span class="ruby-ivar">@case_arbitman</span>.<span class="ruby-identifier">arbitman</span>
2857:             <span class="ruby-identifier">chief_arbitrator</span> = <span class="ruby-constant">TbArbitman</span>.<span class="ruby-identifier">find</span>([<span class="ruby-value str">&quot;used = 'Y' and code = ? &quot;</span>,<span class="ruby-identifier">arbitman_code</span>])
2858:             <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">chief_arbitrator</span> <span class="ruby-operator">!=</span> <span class="ruby-keyword kw">nil</span>
2859:                 <span class="ruby-identifier">chief_arbitrator</span> = <span class="ruby-identifier">chief_arbitrator</span>.<span class="ruby-identifier">name</span>
2860:             <span class="ruby-keyword kw">else</span>
2861:                 <span class="ruby-identifier">chief_arbitrator</span> = <span class="ruby-value str">&quot;no&quot;</span>
2862:             <span class="ruby-keyword kw">end</span>
2863:         <span class="ruby-keyword kw">else</span>
2864:             <span class="ruby-identifier">chief_arbitrator</span> = <span class="ruby-value str">&quot;no&quot;</span>
2865:         <span class="ruby-keyword kw">end</span>
2866:         <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">chief_arbitrator</span> 
2867:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000141" class="method-detail">
        <a name="M000141"></a>

        <div class="method-heading">
          <a href="#M000141" class="method-signature">
          <span class="method-name">format_letter_dfmt04</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000141-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000141-source">
<pre>
     <span class="ruby-comment cmt"># File app/controllers/format_letter_controller.rb, line 27</span>
 27:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">format_letter_dfmt04</span>
 28:         <span class="ruby-comment cmt">#拼接字串，初始化</span>
 29:         <span class="ruby-ivar">@format_dfmt04</span> = <span class="ruby-value str">&quot;&quot;</span>  
 30:         <span class="ruby-comment cmt">#函号</span>
 31:         <span class="ruby-ivar">@file_code</span> = <span class="ruby-constant">TbDoc</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:first</span>,<span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">&quot;used = 'Y' and recevice_code = ?&quot;</span>,<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]])
 32:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@file_code</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@file_code</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
 33:             <span class="ruby-ivar">@file_code</span> = <span class="ruby-value str">&quot;no&quot;</span>
 34:         <span class="ruby-keyword kw">else</span>
 35:             <span class="ruby-ivar">@file_code</span> = <span class="ruby-ivar">@file_code</span>.<span class="ruby-identifier">file_code</span>
 36:         <span class="ruby-keyword kw">end</span>
 37:         <span class="ruby-ivar">@format_dfmt04</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;01$$$&gt;&quot;</span>,<span class="ruby-ivar">@file_code</span>,<span class="ruby-ivar">@format_dfmt04</span>)
 38:         <span class="ruby-comment cmt">#申请人</span>
 39:         <span class="ruby-ivar">@applicants</span> = <span class="ruby-constant">TbParty</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:all</span>,<span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">&quot;used = 'Y' and partytype = 1 and recevice_code = ?&quot;</span>,<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]], <span class="ruby-identifier">:order</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;id&quot;</span>)
 40:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@applicants</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@applicants</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
 41:             <span class="ruby-ivar">@applicant</span> = <span class="ruby-value str">&quot;no&quot;</span>
 42:         <span class="ruby-keyword kw">else</span>
 43:             <span class="ruby-ivar">@applicant</span> = <span class="ruby-value str">&quot;&quot;</span>
 44:             <span class="ruby-ivar">@applicants</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">applicant</span><span class="ruby-operator">|</span>
 45:                 <span class="ruby-ivar">@applicant</span> = <span class="ruby-ivar">@applicant</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">applicant</span>.<span class="ruby-identifier">partyname</span>
 46:             <span class="ruby-keyword kw">end</span>
 47:         <span class="ruby-keyword kw">end</span>       
 48:         <span class="ruby-ivar">@format_dfmt04</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;02$$$&gt;&quot;</span>,<span class="ruby-ivar">@applicant</span>,<span class="ruby-ivar">@format_dfmt04</span>)  
 49:         <span class="ruby-ivar">@format_dfmt04</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;03$$$&gt;&quot;</span>,<span class="ruby-ivar">@applicant</span>,<span class="ruby-ivar">@format_dfmt04</span>)
 50:         <span class="ruby-comment cmt">#受理日期</span>
 51:         <span class="ruby-ivar">@date_receive</span> = <span class="ruby-constant">TbCase</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:first</span>,<span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">&quot;used = 'Y' and recevice_code = ?&quot;</span>,<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]]).<span class="ruby-identifier">receivedate</span>
 52:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@date_receive</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@date_receive</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
 53:             <span class="ruby-ivar">@date_receive</span> = <span class="ruby-value str">&quot;no&quot;</span>
 54:             <span class="ruby-ivar">@format_dfmt04</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;04$$$&gt;&quot;</span>,<span class="ruby-ivar">@date_receive</span>,<span class="ruby-ivar">@format_dfmt04</span>) 
 55:             <span class="ruby-ivar">@format_dfmt04</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;05$$$&gt;&quot;</span>,<span class="ruby-ivar">@date_receive</span>,<span class="ruby-ivar">@format_dfmt04</span>)
 56:             <span class="ruby-ivar">@format_dfmt04</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;06$$$&gt;&quot;</span>,<span class="ruby-ivar">@date_receive</span>,<span class="ruby-ivar">@format_dfmt04</span>)
 57:         <span class="ruby-keyword kw">else</span>
 58:             <span class="ruby-identifier">arr_date</span> = <span class="ruby-ivar">@date_receive</span>.<span class="ruby-identifier">to_s</span>.<span class="ruby-identifier">split</span>(<span class="ruby-value str">&quot;-&quot;</span>)
 59:             <span class="ruby-ivar">@format_dfmt04</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;04$$$&gt;&quot;</span>,<span class="ruby-identifier">arr_date</span>[<span class="ruby-value">0</span>],<span class="ruby-ivar">@format_dfmt04</span>) 
 60:             <span class="ruby-ivar">@format_dfmt04</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;05$$$&gt;&quot;</span>,<span class="ruby-identifier">arr_date</span>[<span class="ruby-value">1</span>],<span class="ruby-ivar">@format_dfmt04</span>)
 61:             <span class="ruby-ivar">@format_dfmt04</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;06$$$&gt;&quot;</span>,<span class="ruby-identifier">arr_date</span>[<span class="ruby-value">2</span>],<span class="ruby-ivar">@format_dfmt04</span>)            
 62:         <span class="ruby-keyword kw">end</span>     
 63: 
 64:         <span class="ruby-comment cmt">#被申请人</span>
 65:         <span class="ruby-ivar">@respondents</span> = <span class="ruby-constant">TbParty</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:all</span>,<span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">&quot;used = 'Y' and partytype = 2 and recevice_code = ?&quot;</span>,<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]], <span class="ruby-identifier">:order</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;id&quot;</span>)
 66:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@respondent</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@respondent</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
 67:             <span class="ruby-ivar">@respondent</span> = <span class="ruby-value str">&quot;no&quot;</span>
 68:         <span class="ruby-keyword kw">else</span>
 69:             <span class="ruby-ivar">@respondent</span> = <span class="ruby-value str">&quot;&quot;</span>
 70:             <span class="ruby-ivar">@respondents</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">resp</span><span class="ruby-operator">|</span>
 71:                 <span class="ruby-ivar">@respondent</span> = <span class="ruby-ivar">@respondent</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">resp</span>.<span class="ruby-identifier">partyname</span>
 72:             <span class="ruby-keyword kw">end</span>
 73:         <span class="ruby-keyword kw">end</span>       
 74:         <span class="ruby-ivar">@format_dfmt04</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;07$$$&gt;&quot;</span>,<span class="ruby-ivar">@respondent</span>,<span class="ruby-ivar">@format_dfmt04</span>)
 75:         <span class="ruby-comment cmt">#关于$$$项下争议的仲裁申请文件（合同名称）</span>
 76:         <span class="ruby-ivar">@contract_name</span> = <span class="ruby-constant">TbContractsign</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:first</span>,<span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">&quot;used = 'Y' and recevice_code = ?&quot;</span>,<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]])
 77:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@contract_name</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@contract_name</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
 78:             <span class="ruby-ivar">@contract_name</span> = <span class="ruby-value str">&quot;no&quot;</span>
 79:         <span class="ruby-keyword kw">else</span>
 80:             <span class="ruby-ivar">@contract_name</span> = <span class="ruby-ivar">@contract_name</span>.<span class="ruby-identifier">pactname</span>
 81:         <span class="ruby-keyword kw">end</span>   
 82:         <span class="ruby-ivar">@format_dfmt04</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;08$$$&gt;&quot;</span>,<span class="ruby-ivar">@contract_name</span>,<span class="ruby-ivar">@format_dfmt04</span>)
 83:         <span class="ruby-comment cmt">#受理费</span>
 84:         <span class="ruby-ivar">@litigation_fee</span> = <span class="ruby-identifier">applicant_litigation_fee</span>(<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>])
 85:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@litigation_fee</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@litigation_fee</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
 86:             <span class="ruby-ivar">@litigation_fee</span> = <span class="ruby-value str">&quot;no&quot;</span>
 87:         <span class="ruby-keyword kw">end</span>
 88:         <span class="ruby-ivar">@format_dfmt04</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;09$$$&gt;&quot;</span>,<span class="ruby-ivar">@litigation_fee</span>,<span class="ruby-ivar">@format_dfmt04</span>)    
 89:         <span class="ruby-comment cmt">#处理费</span>
 90:         <span class="ruby-ivar">@processing_fee</span> = <span class="ruby-identifier">applicant_arbit_fee</span>(<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]) 
 91:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@processing_fee</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@processing_fee</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
 92:             <span class="ruby-ivar">@processing_fee</span> = <span class="ruby-value str">&quot;no&quot;</span>
 93:         <span class="ruby-keyword kw">end</span>        
 94:         <span class="ruby-ivar">@format_dfmt04</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;10$$$&gt;&quot;</span>,<span class="ruby-ivar">@processing_fee</span>,<span class="ruby-ivar">@format_dfmt04</span>)     
 95:         <span class="ruby-comment cmt">#合计</span>
 96:         <span class="ruby-ivar">@total_fee</span> = <span class="ruby-ivar">@litigation_fee</span> <span class="ruby-operator">+</span> <span class="ruby-ivar">@processing_fee</span>
 97:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@litigation_fee</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;no&quot;</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@processing_fee</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;no&quot;</span>
 98:             <span class="ruby-ivar">@total_fee</span> = <span class="ruby-value str">&quot;no&quot;</span>
 99:         <span class="ruby-keyword kw">end</span>
100:         <span class="ruby-ivar">@format_dfmt04</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;11$$$&gt;&quot;</span>,<span class="ruby-ivar">@total_fee</span>,<span class="ruby-ivar">@format_dfmt04</span>)        
101:         <span class="ruby-comment cmt">#助理</span>
102:         <span class="ruby-identifier">clerk_code</span> = <span class="ruby-constant">TbCase</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:first</span>,<span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">&quot;used = 'Y' and recevice_code = ?&quot;</span>,<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]]).<span class="ruby-identifier">clerk</span>
103:         <span class="ruby-identifier">clerk</span> = <span class="ruby-constant">User</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:first</span>,<span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">&quot;used = 'Y' and code = ?&quot;</span>,<span class="ruby-identifier">clerk_code</span>])
104:         <span class="ruby-ivar">@case_alerk</span> = <span class="ruby-identifier">clerk</span>.<span class="ruby-identifier">name</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">clerk</span>.<span class="ruby-identifier">sex</span>
105:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@case_alerk</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@case_alerk</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
106:             <span class="ruby-ivar">@case_alerk</span> = <span class="ruby-value str">&quot;no&quot;</span>
107:         <span class="ruby-keyword kw">end</span>       
108:         <span class="ruby-ivar">@format_dfmt04</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;12$$$&gt;&quot;</span>,<span class="ruby-ivar">@case_alerk</span>,<span class="ruby-ivar">@format_dfmt04</span>)  
109:         <span class="ruby-comment cmt">#电话        </span>
110:         <span class="ruby-ivar">@telephone</span> = <span class="ruby-identifier">clerk</span>.<span class="ruby-identifier">telephone</span>
111:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@telephone</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@telephone</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
112:             <span class="ruby-ivar">@telephone</span> = <span class="ruby-value str">&quot;no&quot;</span>
113:         <span class="ruby-keyword kw">end</span>     
114:         <span class="ruby-ivar">@format_dfmt04</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;13$$$&gt;&quot;</span>,<span class="ruby-ivar">@telephone</span>,<span class="ruby-ivar">@format_dfmt04</span>)       
115:         <span class="ruby-comment cmt">#传真</span>
116:         <span class="ruby-ivar">@fax</span> = <span class="ruby-identifier">clerk</span>.<span class="ruby-identifier">fax</span>
117:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@fax</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@fax</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
118:             <span class="ruby-ivar">@fax</span> = <span class="ruby-value str">&quot;no&quot;</span>
119:         <span class="ruby-keyword kw">end</span>    
120:         <span class="ruby-ivar">@format_dfmt04</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;14$$$&gt;&quot;</span>,<span class="ruby-ivar">@fax</span>,<span class="ruby-ivar">@format_dfmt04</span>)     
121:         <span class="ruby-comment cmt">#电子邮箱</span>
122:         <span class="ruby-ivar">@email</span> = <span class="ruby-identifier">clerk</span>.<span class="ruby-identifier">email</span>
123:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@email</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@email</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
124:             <span class="ruby-ivar">@email</span> = <span class="ruby-value str">&quot;no&quot;</span>
125:         <span class="ruby-keyword kw">end</span>  
126:         <span class="ruby-ivar">@format_dfmt04</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;15$$$&gt;&quot;</span>,<span class="ruby-ivar">@email</span>,<span class="ruby-ivar">@format_dfmt04</span>)    
127:         <span class="ruby-comment cmt">#日期</span>
128:         <span class="ruby-ivar">@date_of_letter</span> = <span class="ruby-constant">Time</span>.<span class="ruby-identifier">now</span>.<span class="ruby-identifier">to_s</span>(<span class="ruby-identifier">:db</span>)
129:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@date_of_letter</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@date_of_letter</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
130:             <span class="ruby-ivar">@date_of_letter</span> = <span class="ruby-value str">&quot;no&quot;</span>
131:             <span class="ruby-ivar">@format_dfmt04</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;16$$$&gt;&quot;</span>,<span class="ruby-ivar">@date_of_letter</span>,<span class="ruby-ivar">@format_dfmt04</span>) 
132:             <span class="ruby-ivar">@format_dfmt04</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;17$$$&gt;&quot;</span>,<span class="ruby-ivar">@date_of_letter</span>,<span class="ruby-ivar">@format_dfmt04</span>)
133:             <span class="ruby-ivar">@format_dfmt04</span> = <span class="ruby-identifier">add_last_record</span>(<span class="ruby-value str">&quot;&lt;18$$$&gt;&quot;</span>,<span class="ruby-ivar">@date_of_letter</span>,<span class="ruby-ivar">@format_dfmt04</span>)
134:         <span class="ruby-keyword kw">else</span>
135:             <span class="ruby-identifier">arr_date</span> = <span class="ruby-ivar">@date_of_letter</span>.<span class="ruby-identifier">to_s</span>.<span class="ruby-identifier">split</span>(<span class="ruby-value str">&quot;-&quot;</span>)
136:             <span class="ruby-ivar">@format_dfmt04</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;16$$$&gt;&quot;</span>,<span class="ruby-identifier">arr_date</span>[<span class="ruby-value">0</span>],<span class="ruby-ivar">@format_dfmt04</span>) 
137:             <span class="ruby-ivar">@format_dfmt04</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;17$$$&gt;&quot;</span>,<span class="ruby-identifier">arr_date</span>[<span class="ruby-value">1</span>],<span class="ruby-ivar">@format_dfmt04</span>)
138:             <span class="ruby-ivar">@format_dfmt04</span> = <span class="ruby-identifier">add_last_record</span>(<span class="ruby-value str">&quot;&lt;18$$$&gt;&quot;</span>,<span class="ruby-identifier">arr_date</span>[<span class="ruby-value">2</span>].<span class="ruby-identifier">slice</span>(<span class="ruby-value">0</span>, <span class="ruby-value">2</span>),<span class="ruby-ivar">@format_dfmt04</span>)            
139:         <span class="ruby-keyword kw">end</span>   
140:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000142" class="method-detail">
        <a name="M000142"></a>

        <div class="method-heading">
          <a href="#M000142" class="method-signature">
          <span class="method-name">format_letter_dfmt05</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000142-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000142-source">
<pre>
     <span class="ruby-comment cmt"># File app/controllers/format_letter_controller.rb, line 142</span>
142:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">format_letter_dfmt05</span>
143:         <span class="ruby-comment cmt">#拼接字串，初始化</span>
144:         <span class="ruby-ivar">@format_dfmt05</span> = <span class="ruby-value str">&quot;&quot;</span>  
145:         <span class="ruby-comment cmt">#函号</span>
146:         <span class="ruby-ivar">@file_code</span> = <span class="ruby-constant">TbDoc</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:first</span>,<span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">&quot;used = 'Y' and recevice_code = ?&quot;</span>,<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]])
147:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@file_code</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@file_code</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
148:             <span class="ruby-ivar">@file_code</span> = <span class="ruby-value str">&quot;no&quot;</span>
149:         <span class="ruby-keyword kw">else</span>
150:             <span class="ruby-ivar">@file_code</span> = <span class="ruby-ivar">@file_code</span>.<span class="ruby-identifier">file_code</span>
151:         <span class="ruby-keyword kw">end</span>
152:         <span class="ruby-ivar">@format_dfmt05</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;01$$$&gt;&quot;</span>,<span class="ruby-ivar">@file_code</span>,<span class="ruby-ivar">@format_dfmt05</span>)
153:         <span class="ruby-comment cmt">#立案号</span>
154:         <span class="ruby-ivar">@case_code</span> = <span class="ruby-constant">TbCase</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:first</span>, <span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">&quot;used = 'Y' and recevice_code = ?&quot;</span>,<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]]).<span class="ruby-identifier">case_code</span>
155:         <span class="ruby-ivar">@format_dfmt05</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;02$$$&gt;&quot;</span>,<span class="ruby-ivar">@case_code</span>,<span class="ruby-ivar">@format_dfmt05</span>) 
156:         <span class="ruby-ivar">@format_dfmt05</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;06$$$&gt;&quot;</span>,<span class="ruby-ivar">@case_code</span>,<span class="ruby-ivar">@format_dfmt05</span>)
157:         <span class="ruby-comment cmt">#被申请人</span>
158:         <span class="ruby-ivar">@respondents</span> = <span class="ruby-constant">TbParty</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:all</span>,<span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">&quot;used = 'Y' and partytype = 2 and recevice_code = ?&quot;</span>,<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]], <span class="ruby-identifier">:order</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;id&quot;</span>)
159:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@respondent</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@respondent</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
160:             <span class="ruby-ivar">@respondent</span> = <span class="ruby-value str">&quot;no&quot;</span>
161:         <span class="ruby-keyword kw">else</span>
162:             <span class="ruby-ivar">@respondent</span> = <span class="ruby-value str">&quot;&quot;</span>
163:             <span class="ruby-ivar">@respondents</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">resp</span><span class="ruby-operator">|</span>
164:                 <span class="ruby-ivar">@respondent</span> = <span class="ruby-ivar">@respondent</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">resp</span>.<span class="ruby-identifier">partyname</span>
165:             <span class="ruby-keyword kw">end</span>
166:         <span class="ruby-keyword kw">end</span>   
167:         <span class="ruby-ivar">@format_dfmt05</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;03$$$&gt;&quot;</span>,<span class="ruby-ivar">@respondent</span>,<span class="ruby-ivar">@format_dfmt05</span>)
168:         <span class="ruby-comment cmt">#申请人</span>
169:         <span class="ruby-ivar">@applicants</span> = <span class="ruby-constant">TbParty</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:all</span>,<span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">&quot;used = 'Y' and partytype = 1 and recevice_code = ?&quot;</span>,<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]], <span class="ruby-identifier">:order</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;id&quot;</span>)
170:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@applicants</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@applicants</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
171:             <span class="ruby-ivar">@applicant</span> = <span class="ruby-value str">&quot;no&quot;</span>
172:         <span class="ruby-keyword kw">else</span>
173:             <span class="ruby-ivar">@applicant</span> = <span class="ruby-value str">&quot;&quot;</span>
174:             <span class="ruby-ivar">@applicants</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">applicant</span><span class="ruby-operator">|</span>
175:                 <span class="ruby-ivar">@applicant</span> = <span class="ruby-ivar">@applicant</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">applicant</span>.<span class="ruby-identifier">partyname</span>
176:             <span class="ruby-keyword kw">end</span>
177:         <span class="ruby-keyword kw">end</span>       
178:         <span class="ruby-ivar">@format_dfmt05</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;04$$$&gt;&quot;</span>,<span class="ruby-ivar">@applicant</span>,<span class="ruby-ivar">@format_dfmt05</span>) 
179:         <span class="ruby-comment cmt">#签订的$$$所引起的争议（合同名称）</span>
180:         <span class="ruby-ivar">@contract_name</span> = <span class="ruby-constant">TbContractsign</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:first</span>,<span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">&quot;used = 'Y' and recevice_code = ?&quot;</span>,<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]])
181:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@contract_name</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@contract_name</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
182:             <span class="ruby-ivar">@contract_name</span> = <span class="ruby-value str">&quot;no&quot;</span>
183:         <span class="ruby-keyword kw">else</span>
184:             <span class="ruby-ivar">@contract_name</span> = <span class="ruby-ivar">@contract_name</span>.<span class="ruby-identifier">pactname</span>
185:         <span class="ruby-keyword kw">end</span>   
186:         <span class="ruby-ivar">@format_dfmt05</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;05$$$&gt;&quot;</span>,<span class="ruby-ivar">@contract_name</span>,<span class="ruby-ivar">@format_dfmt05</span>)
187:         <span class="ruby-comment cmt">#文件份数</span>
188:         <span class="ruby-ivar">@copies</span> = <span class="ruby-identifier">num_papers</span>(<span class="ruby-ivar">@applicants</span>.<span class="ruby-identifier">size</span>)
189:         <span class="ruby-ivar">@format_dfmt05</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;07$$$&gt;&quot;</span>,<span class="ruby-ivar">@copies</span>,<span class="ruby-ivar">@format_dfmt05</span>) 
190:         <span class="ruby-ivar">@format_dfmt05</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;08$$$&gt;&quot;</span>,<span class="ruby-ivar">@copies</span>,<span class="ruby-ivar">@format_dfmt05</span>)
191:         <span class="ruby-ivar">@format_dfmt05</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;09$$$&gt;&quot;</span>,<span class="ruby-ivar">@copies</span>,<span class="ruby-ivar">@format_dfmt05</span>)                       
192:         <span class="ruby-comment cmt">#助理</span>
193:         <span class="ruby-identifier">clerk_code</span> = <span class="ruby-constant">TbCase</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:first</span>,<span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">&quot;used = 'Y' and recevice_code = ?&quot;</span>,<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]]).<span class="ruby-identifier">clerk</span>
194:         <span class="ruby-identifier">clerk</span> = <span class="ruby-constant">User</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:first</span>,<span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">&quot;used = 'Y' and code = ?&quot;</span>,<span class="ruby-identifier">clerk_code</span>])
195:         <span class="ruby-ivar">@case_alerk</span> = <span class="ruby-identifier">clerk</span>.<span class="ruby-identifier">name</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">clerk</span>.<span class="ruby-identifier">sex</span>
196:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@case_alerk</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@case_alerk</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
197:             <span class="ruby-ivar">@case_alerk</span> = <span class="ruby-value str">&quot;no&quot;</span>
198:         <span class="ruby-keyword kw">end</span>       
199:         <span class="ruby-ivar">@format_dfmt05</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;10$$$&gt;&quot;</span>,<span class="ruby-ivar">@case_alerk</span>,<span class="ruby-ivar">@format_dfmt05</span>)  
200:         <span class="ruby-comment cmt">#电话        </span>
201:         <span class="ruby-ivar">@telephone</span> = <span class="ruby-identifier">clerk</span>.<span class="ruby-identifier">telephone</span>
202:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@telephone</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@telephone</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
203:             <span class="ruby-ivar">@telephone</span> = <span class="ruby-value str">&quot;no&quot;</span>
204:         <span class="ruby-keyword kw">end</span>     
205:         <span class="ruby-ivar">@format_dfmt05</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;11$$$&gt;&quot;</span>,<span class="ruby-ivar">@telephone</span>,<span class="ruby-ivar">@format_dfmt05</span>)       
206:         <span class="ruby-comment cmt">#传真</span>
207:         <span class="ruby-ivar">@fax</span> = <span class="ruby-identifier">clerk</span>.<span class="ruby-identifier">fax</span>
208:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@fax</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@fax</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
209:             <span class="ruby-ivar">@fax</span> = <span class="ruby-value str">&quot;no&quot;</span>
210:         <span class="ruby-keyword kw">end</span>    
211:         <span class="ruby-ivar">@format_dfmt05</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;12$$$&gt;&quot;</span>,<span class="ruby-ivar">@fax</span>,<span class="ruby-ivar">@format_dfmt05</span>)     
212:         <span class="ruby-comment cmt">#电子邮箱</span>
213:         <span class="ruby-ivar">@email</span> = <span class="ruby-identifier">clerk</span>.<span class="ruby-identifier">email</span>
214:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@email</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@email</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
215:             <span class="ruby-ivar">@email</span> = <span class="ruby-value str">&quot;no&quot;</span>
216:         <span class="ruby-keyword kw">end</span>  
217:         <span class="ruby-ivar">@format_dfmt05</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;13$$$&gt;&quot;</span>,<span class="ruby-ivar">@email</span>,<span class="ruby-ivar">@format_dfmt05</span>)    
218:         <span class="ruby-comment cmt">#日期</span>
219:         <span class="ruby-ivar">@date_of_letter</span> = <span class="ruby-constant">Time</span>.<span class="ruby-identifier">now</span>.<span class="ruby-identifier">to_s</span>(<span class="ruby-identifier">:db</span>)
220:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@date_of_letter</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@date_of_letter</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
221:             <span class="ruby-ivar">@date_of_letter</span> = <span class="ruby-value str">&quot;no&quot;</span>
222:             <span class="ruby-ivar">@format_dfmt05</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;14$$$&gt;&quot;</span>,<span class="ruby-ivar">@date_of_letter</span>,<span class="ruby-ivar">@format_dfmt05</span>) 
223:             <span class="ruby-ivar">@format_dfmt05</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;15$$$&gt;&quot;</span>,<span class="ruby-ivar">@date_of_letter</span>,<span class="ruby-ivar">@format_dfmt05</span>)
224:             <span class="ruby-ivar">@format_dfmt05</span> = <span class="ruby-identifier">add_last_record</span>(<span class="ruby-value str">&quot;&lt;16$$$&gt;&quot;</span>,<span class="ruby-ivar">@date_of_letter</span>,<span class="ruby-ivar">@format_dfmt05</span>)
225:         <span class="ruby-keyword kw">else</span>
226:             <span class="ruby-identifier">arr_date</span> = <span class="ruby-ivar">@date_of_letter</span>.<span class="ruby-identifier">to_s</span>.<span class="ruby-identifier">split</span>(<span class="ruby-value str">&quot;-&quot;</span>)
227:             <span class="ruby-ivar">@format_dfmt05</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;14$$$&gt;&quot;</span>,<span class="ruby-identifier">arr_date</span>[<span class="ruby-value">0</span>],<span class="ruby-ivar">@format_dfmt05</span>) 
228:             <span class="ruby-ivar">@format_dfmt05</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;15$$$&gt;&quot;</span>,<span class="ruby-identifier">arr_date</span>[<span class="ruby-value">1</span>],<span class="ruby-ivar">@format_dfmt05</span>)
229:             <span class="ruby-ivar">@format_dfmt05</span> = <span class="ruby-identifier">add_last_record</span>(<span class="ruby-value str">&quot;&lt;16$$$&gt;&quot;</span>,<span class="ruby-identifier">arr_date</span>[<span class="ruby-value">2</span>].<span class="ruby-identifier">slice</span>(<span class="ruby-value">0</span>, <span class="ruby-value">2</span>),<span class="ruby-ivar">@format_dfmt05</span>)            
230:         <span class="ruby-keyword kw">end</span>          
231:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000143" class="method-detail">
        <a name="M000143"></a>

        <div class="method-heading">
          <a href="#M000143" class="method-signature">
          <span class="method-name">format_letter_dfmt06</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000143-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000143-source">
<pre>
     <span class="ruby-comment cmt"># File app/controllers/format_letter_controller.rb, line 233</span>
233:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">format_letter_dfmt06</span>
234:         <span class="ruby-comment cmt">#拼接字串，初始化</span>
235:         <span class="ruby-ivar">@format_dfmt06</span> = <span class="ruby-value str">&quot;&quot;</span>  
236:         <span class="ruby-comment cmt">#函号</span>
237:         <span class="ruby-ivar">@file_code</span> = <span class="ruby-constant">TbDoc</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:first</span>,<span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">&quot;used = 'Y' and recevice_code = ?&quot;</span>,<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]])
238:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@file_code</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@file_code</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
239:             <span class="ruby-ivar">@file_code</span> = <span class="ruby-value str">&quot;no&quot;</span>
240:         <span class="ruby-keyword kw">else</span>
241:             <span class="ruby-ivar">@file_code</span> = <span class="ruby-ivar">@file_code</span>.<span class="ruby-identifier">file_code</span>
242:         <span class="ruby-keyword kw">end</span>
243:         <span class="ruby-ivar">@format_dfmt06</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;01$$$&gt;&quot;</span>,<span class="ruby-ivar">@file_code</span>,<span class="ruby-ivar">@format_dfmt06</span>)
244:         <span class="ruby-comment cmt">#立案号</span>
245:         <span class="ruby-ivar">@case_code</span> = <span class="ruby-constant">TbCase</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:first</span>, <span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">&quot;used = 'Y' and recevice_code = ?&quot;</span>,<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]]).<span class="ruby-identifier">case_code</span>
246:         <span class="ruby-ivar">@format_dfmt06</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;02$$$&gt;&quot;</span>,<span class="ruby-ivar">@case_code</span>,<span class="ruby-ivar">@format_dfmt06</span>)  
247:         <span class="ruby-ivar">@format_dfmt06</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;08$$$&gt;&quot;</span>,<span class="ruby-ivar">@case_code</span>,<span class="ruby-ivar">@format_dfmt06</span>)
248:         <span class="ruby-comment cmt">#申请人</span>
249:         <span class="ruby-ivar">@applicants</span> = <span class="ruby-constant">TbParty</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:all</span>,<span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">&quot;used = 'Y' and partytype = 1 and recevice_code = ?&quot;</span>,<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]], <span class="ruby-identifier">:order</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;id&quot;</span>)
250:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@applicants</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@applicants</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
251:             <span class="ruby-ivar">@applicant</span> = <span class="ruby-value str">&quot;no&quot;</span>
252:         <span class="ruby-keyword kw">else</span>
253:             <span class="ruby-ivar">@applicant</span> = <span class="ruby-value str">&quot;&quot;</span>
254:             <span class="ruby-ivar">@applicants</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">applicant</span><span class="ruby-operator">|</span>
255:                 <span class="ruby-ivar">@applicant</span> = <span class="ruby-ivar">@applicant</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">applicant</span>.<span class="ruby-identifier">partyname</span>
256:             <span class="ruby-keyword kw">end</span>
257:         <span class="ruby-keyword kw">end</span>        
258:         <span class="ruby-ivar">@format_dfmt06</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;03$$$&gt;&quot;</span>,<span class="ruby-ivar">@applicant</span>,<span class="ruby-ivar">@format_dfmt06</span>)
259:         <span class="ruby-comment cmt">#被申请人</span>
260:         <span class="ruby-ivar">@respondents</span> = <span class="ruby-constant">TbParty</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:all</span>,<span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">&quot;used = 'Y' and partytype = 2 and recevice_code = ?&quot;</span>,<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]], <span class="ruby-identifier">:order</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;id&quot;</span>)
261:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@respondent</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@respondent</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
262:             <span class="ruby-ivar">@respondent</span> = <span class="ruby-value str">&quot;no&quot;</span>
263:         <span class="ruby-keyword kw">else</span>
264:             <span class="ruby-ivar">@respondent</span> = <span class="ruby-value str">&quot;&quot;</span>
265:             <span class="ruby-ivar">@respondents</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">resp</span><span class="ruby-operator">|</span>
266:                 <span class="ruby-ivar">@respondent</span> = <span class="ruby-ivar">@respondent</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">resp</span>.<span class="ruby-identifier">partyname</span>
267:             <span class="ruby-keyword kw">end</span>
268:         <span class="ruby-keyword kw">end</span>       
269:         <span class="ruby-ivar">@format_dfmt06</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;04$$$&gt;&quot;</span>,<span class="ruby-ivar">@respondent</span>,<span class="ruby-ivar">@format_dfmt06</span>)
270:         <span class="ruby-comment cmt">#文件份数</span>
271:         <span class="ruby-ivar">@copies</span> = <span class="ruby-identifier">num_papers</span>(<span class="ruby-ivar">@respondents</span>.<span class="ruby-identifier">size</span>)
272:         <span class="ruby-ivar">@format_dfmt06</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;05$$$&gt;&quot;</span>,<span class="ruby-ivar">@copies</span>,<span class="ruby-ivar">@format_dfmt06</span>)  
273:         <span class="ruby-comment cmt">#仲裁费</span>
274:         <span class="ruby-ivar">@arbit_fee</span> = <span class="ruby-identifier">applicant_arbit_fee</span>(<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]) 
275:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@arbit_fee</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@arbit_fee</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
276:             <span class="ruby-ivar">@arbit_fee</span> = <span class="ruby-value str">&quot;no&quot;</span>
277:         <span class="ruby-keyword kw">end</span>        
278:         <span class="ruby-ivar">@format_dfmt06</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;06$$$&gt;&quot;</span>,<span class="ruby-ivar">@arbit_fee</span>,<span class="ruby-ivar">@format_dfmt06</span>)           
279:         <span class="ruby-comment cmt">#关于$$$项下争议的仲裁申请文件（合同名称）</span>
280:         <span class="ruby-ivar">@contract_name</span> = <span class="ruby-constant">TbContractsign</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:first</span>,<span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">&quot;used = 'Y' and recevice_code = ?&quot;</span>,<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]])
281:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@contract_name</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@contract_name</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
282:             <span class="ruby-ivar">@contract_name</span> = <span class="ruby-value str">&quot;no&quot;</span>
283:         <span class="ruby-keyword kw">else</span>
284:             <span class="ruby-ivar">@contract_name</span> = <span class="ruby-ivar">@contract_name</span>.<span class="ruby-identifier">pactname</span>
285:         <span class="ruby-keyword kw">end</span>   
286:         <span class="ruby-ivar">@format_dfmt06</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;07$$$&gt;&quot;</span>,<span class="ruby-ivar">@contract_name</span>,<span class="ruby-ivar">@format_dfmt06</span>)
287:        
288:         <span class="ruby-comment cmt">#助理</span>
289:         <span class="ruby-identifier">clerk_code</span> = <span class="ruby-constant">TbCase</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:first</span>,<span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">&quot;used = 'Y' and recevice_code = ?&quot;</span>,<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]]).<span class="ruby-identifier">clerk</span>
290:         <span class="ruby-identifier">clerk</span> = <span class="ruby-constant">User</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:first</span>,<span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">&quot;used = 'Y' and code = ?&quot;</span>,<span class="ruby-identifier">clerk_code</span>])
291:         <span class="ruby-ivar">@case_alerk</span> = <span class="ruby-identifier">clerk</span>.<span class="ruby-identifier">name</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">clerk</span>.<span class="ruby-identifier">sex</span>
292:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@case_alerk</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@case_alerk</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
293:             <span class="ruby-ivar">@case_alerk</span> = <span class="ruby-value str">&quot;no&quot;</span>
294:         <span class="ruby-keyword kw">end</span>       
295:         <span class="ruby-ivar">@format_dfmt06</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;09$$$&gt;&quot;</span>,<span class="ruby-ivar">@case_alerk</span>,<span class="ruby-ivar">@format_dfmt06</span>)  
296:         <span class="ruby-comment cmt">#电话        </span>
297:         <span class="ruby-ivar">@telephone</span> = <span class="ruby-identifier">clerk</span>.<span class="ruby-identifier">telephone</span>
298:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@telephone</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@telephone</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
299:             <span class="ruby-ivar">@telephone</span> = <span class="ruby-value str">&quot;no&quot;</span>
300:         <span class="ruby-keyword kw">end</span>     
301:         <span class="ruby-ivar">@format_dfmt06</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;10$$$&gt;&quot;</span>,<span class="ruby-ivar">@telephone</span>,<span class="ruby-ivar">@format_dfmt06</span>)       
302:         <span class="ruby-comment cmt">#传真</span>
303:         <span class="ruby-ivar">@fax</span> = <span class="ruby-identifier">clerk</span>.<span class="ruby-identifier">fax</span>
304:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@fax</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@fax</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
305:             <span class="ruby-ivar">@fax</span> = <span class="ruby-value str">&quot;no&quot;</span>
306:         <span class="ruby-keyword kw">end</span>    
307:         <span class="ruby-ivar">@format_dfmt06</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;11$$$&gt;&quot;</span>,<span class="ruby-ivar">@fax</span>,<span class="ruby-ivar">@format_dfmt06</span>)     
308:         <span class="ruby-comment cmt">#电子邮箱</span>
309:         <span class="ruby-ivar">@email</span> = <span class="ruby-identifier">clerk</span>.<span class="ruby-identifier">email</span>
310:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@email</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@email</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
311:             <span class="ruby-ivar">@email</span> = <span class="ruby-value str">&quot;no&quot;</span>
312:         <span class="ruby-keyword kw">end</span>  
313:         <span class="ruby-ivar">@format_dfmt06</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;12$$$&gt;&quot;</span>,<span class="ruby-ivar">@email</span>,<span class="ruby-ivar">@format_dfmt06</span>)    
314:         <span class="ruby-comment cmt">#日期</span>
315:         <span class="ruby-ivar">@date_of_letter</span> = <span class="ruby-constant">Time</span>.<span class="ruby-identifier">now</span>.<span class="ruby-identifier">to_s</span>(<span class="ruby-identifier">:db</span>)
316:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@date_of_letter</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@date_of_letter</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
317:             <span class="ruby-ivar">@date_of_letter</span> = <span class="ruby-value str">&quot;no&quot;</span>
318:             <span class="ruby-ivar">@format_dfmt06</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;13$$$&gt;&quot;</span>,<span class="ruby-ivar">@date_of_letter</span>,<span class="ruby-ivar">@format_dfmt06</span>) 
319:             <span class="ruby-ivar">@format_dfmt06</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;14$$$&gt;&quot;</span>,<span class="ruby-ivar">@date_of_letter</span>,<span class="ruby-ivar">@format_dfmt06</span>)
320:             <span class="ruby-ivar">@format_dfmt06</span> = <span class="ruby-identifier">add_last_record</span>(<span class="ruby-value str">&quot;&lt;15$$$&gt;&quot;</span>,<span class="ruby-ivar">@date_of_letter</span>,<span class="ruby-ivar">@format_dfmt06</span>)
321:         <span class="ruby-keyword kw">else</span>
322:             <span class="ruby-identifier">arr_date</span> = <span class="ruby-ivar">@date_of_letter</span>.<span class="ruby-identifier">to_s</span>.<span class="ruby-identifier">split</span>(<span class="ruby-value str">&quot;-&quot;</span>)
323:             <span class="ruby-ivar">@format_dfmt06</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;13$$$&gt;&quot;</span>,<span class="ruby-identifier">arr_date</span>[<span class="ruby-value">0</span>],<span class="ruby-ivar">@format_dfmt06</span>) 
324:             <span class="ruby-ivar">@format_dfmt06</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;14$$$&gt;&quot;</span>,<span class="ruby-identifier">arr_date</span>[<span class="ruby-value">1</span>],<span class="ruby-ivar">@format_dfmt06</span>)
325:             <span class="ruby-ivar">@format_dfmt06</span> = <span class="ruby-identifier">add_last_record</span>(<span class="ruby-value str">&quot;&lt;15$$$&gt;&quot;</span>,<span class="ruby-identifier">arr_date</span>[<span class="ruby-value">2</span>].<span class="ruby-identifier">slice</span>(<span class="ruby-value">0</span>, <span class="ruby-value">2</span>),<span class="ruby-ivar">@format_dfmt06</span>)            
326:         <span class="ruby-keyword kw">end</span>   
327:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000144" class="method-detail">
        <a name="M000144"></a>

        <div class="method-heading">
          <a href="#M000144" class="method-signature">
          <span class="method-name">format_letter_dfmt07</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
<a
href="FormatLetterController.html#M000144">format_letter_dfmt07</a>涉及到页面选项，暂时空缺
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000144-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000144-source">
<pre>
     <span class="ruby-comment cmt"># File app/controllers/format_letter_controller.rb, line 331</span>
331:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">format_letter_dfmt07</span>
332:         <span class="ruby-comment cmt">#拼接字串，初始化</span>
333:         <span class="ruby-ivar">@format_dfmt07</span> = <span class="ruby-value str">&quot;&quot;</span>  
334:         <span class="ruby-comment cmt">#函号</span>
335:         <span class="ruby-ivar">@file_code</span> = <span class="ruby-constant">TbDoc</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:first</span>,<span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">&quot;used = 'Y' and recevice_code = ?&quot;</span>,<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]])
336:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@file_code</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@file_code</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
337:             <span class="ruby-ivar">@file_code</span> = <span class="ruby-value str">&quot;no&quot;</span>
338:         <span class="ruby-keyword kw">else</span>
339:             <span class="ruby-ivar">@file_code</span> = <span class="ruby-ivar">@file_code</span>.<span class="ruby-identifier">file_code</span>
340:         <span class="ruby-keyword kw">end</span>
341:         <span class="ruby-ivar">@format_dfmt07</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;01$$$&gt;&quot;</span>,<span class="ruby-ivar">@file_code</span>,<span class="ruby-ivar">@format_dfmt07</span>)
342:         <span class="ruby-comment cmt">#立案号</span>
343:         <span class="ruby-ivar">@case_code</span> = <span class="ruby-constant">TbCase</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:first</span>, <span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">&quot;used = 'Y' and recevice_code = ?&quot;</span>,<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]]).<span class="ruby-identifier">case_code</span>
344:         <span class="ruby-ivar">@format_dfmt07</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;02$$$&gt;&quot;</span>,<span class="ruby-ivar">@case_code</span>,<span class="ruby-ivar">@format_dfmt07</span>)  
345:         <span class="ruby-ivar">@format_dfmt07</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;08$$$&gt;&quot;</span>,<span class="ruby-ivar">@case_code</span>,<span class="ruby-ivar">@format_dfmt07</span>)
346:         <span class="ruby-comment cmt">#申请人</span>
347:         <span class="ruby-ivar">@applicants</span> = <span class="ruby-constant">TbParty</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:all</span>,<span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">&quot;used = 'Y' and partytype = 1 and recevice_code = ?&quot;</span>,<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]], <span class="ruby-identifier">:order</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;id&quot;</span>)
348:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@applicants</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@applicants</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
349:             <span class="ruby-ivar">@applicant</span> = <span class="ruby-value str">&quot;no&quot;</span>
350:         <span class="ruby-keyword kw">else</span>
351:             <span class="ruby-ivar">@applicant</span> = <span class="ruby-value str">&quot;&quot;</span>
352:             <span class="ruby-ivar">@applicants</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">applicant</span><span class="ruby-operator">|</span>
353:                 <span class="ruby-ivar">@applicant</span> = <span class="ruby-ivar">@applicant</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">applicant</span>.<span class="ruby-identifier">partyname</span>
354:             <span class="ruby-keyword kw">end</span>
355:         <span class="ruby-keyword kw">end</span>        
356:         <span class="ruby-ivar">@format_dfmt07</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;03$$$&gt;&quot;</span>,<span class="ruby-ivar">@applicant</span>,<span class="ruby-ivar">@format_dfmt07</span>)
357:         <span class="ruby-comment cmt">#被申请人</span>
358:         <span class="ruby-ivar">@respondents</span> = <span class="ruby-constant">TbParty</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:all</span>,<span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">&quot;used = 'Y' and partytype = 2 and recevice_code = ?&quot;</span>,<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]], <span class="ruby-identifier">:order</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;id&quot;</span>)
359:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@respondent</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@respondent</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
360:             <span class="ruby-ivar">@respondent</span> = <span class="ruby-value str">&quot;no&quot;</span>
361:         <span class="ruby-keyword kw">else</span>
362:             <span class="ruby-ivar">@respondent</span> = <span class="ruby-value str">&quot;&quot;</span>
363:             <span class="ruby-ivar">@respondents</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">resp</span><span class="ruby-operator">|</span>
364:                 <span class="ruby-ivar">@respondent</span> = <span class="ruby-ivar">@respondent</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">resp</span>.<span class="ruby-identifier">partyname</span>
365:             <span class="ruby-keyword kw">end</span>
366:         <span class="ruby-keyword kw">end</span>       
367:         <span class="ruby-ivar">@format_dfmt07</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;04$$$&gt;&quot;</span>,<span class="ruby-ivar">@respondent</span>,<span class="ruby-ivar">@format_dfmt07</span>)
368:         <span class="ruby-comment cmt">#文件份数</span>
369:         <span class="ruby-ivar">@copies</span> = <span class="ruby-identifier">num_papers</span>(<span class="ruby-ivar">@respondents</span>.<span class="ruby-identifier">size</span>)
370:         <span class="ruby-ivar">@format_dfmt07</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;05$$$&gt;&quot;</span>,<span class="ruby-ivar">@copies</span>,<span class="ruby-ivar">@format_dfmt07</span>)  
371:         <span class="ruby-comment cmt">#仲裁费</span>
372:         <span class="ruby-ivar">@arbit_fee</span> = <span class="ruby-identifier">applicant_arbit_fee</span>(<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]) 
373:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@arbit_fee</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@arbit_fee</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
374:             <span class="ruby-ivar">@arbit_fee</span> = <span class="ruby-value str">&quot;no&quot;</span>
375:         <span class="ruby-keyword kw">end</span>        
376:         <span class="ruby-ivar">@format_dfmt07</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;06$$$&gt;&quot;</span>,<span class="ruby-ivar">@arbit_fee</span>,<span class="ruby-ivar">@format_dfmt07</span>)           
377:         <span class="ruby-comment cmt">#关于$$$项下争议的仲裁申请文件（合同名称）</span>
378:         <span class="ruby-ivar">@contract_name</span> = <span class="ruby-constant">TbContractsign</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:first</span>,<span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">&quot;used = 'Y' and recevice_code = ?&quot;</span>,<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]])
379:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@contract_name</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@contract_name</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
380:             <span class="ruby-ivar">@contract_name</span> = <span class="ruby-value str">&quot;no&quot;</span>
381:         <span class="ruby-keyword kw">else</span>
382:             <span class="ruby-ivar">@contract_name</span> = <span class="ruby-ivar">@contract_name</span>.<span class="ruby-identifier">pactname</span>
383:         <span class="ruby-keyword kw">end</span>   
384:         <span class="ruby-ivar">@format_dfmt07</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;07$$$&gt;&quot;</span>,<span class="ruby-ivar">@contract_name</span>,<span class="ruby-ivar">@format_dfmt07</span>)
385:        
386:         <span class="ruby-comment cmt">#助理</span>
387:         <span class="ruby-identifier">clerk_code</span> = <span class="ruby-constant">TbCase</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:first</span>,<span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">&quot;used = 'Y' and recevice_code = ?&quot;</span>,<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]]).<span class="ruby-identifier">clerk</span>
388:         <span class="ruby-identifier">clerk</span> = <span class="ruby-constant">User</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:first</span>,<span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">&quot;used = 'Y' and code = ?&quot;</span>,<span class="ruby-identifier">clerk_code</span>])
389:         <span class="ruby-ivar">@case_alerk</span> = <span class="ruby-identifier">clerk</span>.<span class="ruby-identifier">name</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">clerk</span>.<span class="ruby-identifier">sex</span>
390:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@case_alerk</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@case_alerk</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
391:             <span class="ruby-ivar">@case_alerk</span> = <span class="ruby-value str">&quot;no&quot;</span>
392:         <span class="ruby-keyword kw">end</span>       
393:         <span class="ruby-ivar">@format_dfmt07</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;09$$$&gt;&quot;</span>,<span class="ruby-ivar">@case_alerk</span>,<span class="ruby-ivar">@format_dfmt07</span>)  
394:         <span class="ruby-comment cmt">#电话        </span>
395:         <span class="ruby-ivar">@telephone</span> = <span class="ruby-identifier">clerk</span>.<span class="ruby-identifier">telephone</span>
396:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@telephone</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@telephone</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
397:             <span class="ruby-ivar">@telephone</span> = <span class="ruby-value str">&quot;no&quot;</span>
398:         <span class="ruby-keyword kw">end</span>     
399:         <span class="ruby-ivar">@format_dfmt07</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;10$$$&gt;&quot;</span>,<span class="ruby-ivar">@telephone</span>,<span class="ruby-ivar">@format_dfmt07</span>)       
400:         <span class="ruby-comment cmt">#传真</span>
401:         <span class="ruby-ivar">@fax</span> = <span class="ruby-identifier">clerk</span>.<span class="ruby-identifier">fax</span>
402:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@fax</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@fax</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
403:             <span class="ruby-ivar">@fax</span> = <span class="ruby-value str">&quot;no&quot;</span>
404:         <span class="ruby-keyword kw">end</span>    
405:         <span class="ruby-ivar">@format_dfmt07</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;11$$$&gt;&quot;</span>,<span class="ruby-ivar">@fax</span>,<span class="ruby-ivar">@format_dfmt07</span>)     
406:         <span class="ruby-comment cmt">#电子邮箱</span>
407:         <span class="ruby-ivar">@email</span> = <span class="ruby-identifier">clerk</span>.<span class="ruby-identifier">email</span>
408:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@email</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@email</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
409:             <span class="ruby-ivar">@email</span> = <span class="ruby-value str">&quot;no&quot;</span>
410:         <span class="ruby-keyword kw">end</span>  
411:         <span class="ruby-ivar">@format_dfmt07</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;12$$$&gt;&quot;</span>,<span class="ruby-ivar">@email</span>,<span class="ruby-ivar">@format_dfmt07</span>)    
412:         <span class="ruby-comment cmt">#日期</span>
413:         <span class="ruby-ivar">@date_of_letter</span> = <span class="ruby-constant">Time</span>.<span class="ruby-identifier">now</span>.<span class="ruby-identifier">to_s</span>(<span class="ruby-identifier">:db</span>)
414:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@date_of_letter</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@date_of_letter</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
415:             <span class="ruby-ivar">@date_of_letter</span> = <span class="ruby-value str">&quot;no&quot;</span>
416:             <span class="ruby-ivar">@format_dfmt07</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;13$$$&gt;&quot;</span>,<span class="ruby-ivar">@date_of_letter</span>,<span class="ruby-ivar">@format_dfmt07</span>) 
417:             <span class="ruby-ivar">@format_dfmt07</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;14$$$&gt;&quot;</span>,<span class="ruby-ivar">@date_of_letter</span>,<span class="ruby-ivar">@format_dfmt07</span>)
418:             <span class="ruby-ivar">@format_dfmt07</span> = <span class="ruby-identifier">add_last_record</span>(<span class="ruby-value str">&quot;&lt;15$$$&gt;&quot;</span>,<span class="ruby-ivar">@date_of_letter</span>,<span class="ruby-ivar">@format_dfmt07</span>)
419:         <span class="ruby-keyword kw">else</span>
420:             <span class="ruby-identifier">arr_date</span> = <span class="ruby-ivar">@date_of_letter</span>.<span class="ruby-identifier">to_s</span>.<span class="ruby-identifier">split</span>(<span class="ruby-value str">&quot;-&quot;</span>)
421:             <span class="ruby-ivar">@format_dfmt07</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;13$$$&gt;&quot;</span>,<span class="ruby-identifier">arr_date</span>[<span class="ruby-value">0</span>],<span class="ruby-ivar">@format_dfmt07</span>) 
422:             <span class="ruby-ivar">@format_dfmt07</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;14$$$&gt;&quot;</span>,<span class="ruby-identifier">arr_date</span>[<span class="ruby-value">1</span>],<span class="ruby-ivar">@format_dfmt07</span>)
423:             <span class="ruby-ivar">@format_dfmt07</span> = <span class="ruby-identifier">add_last_record</span>(<span class="ruby-value str">&quot;&lt;15$$$&gt;&quot;</span>,<span class="ruby-identifier">arr_date</span>[<span class="ruby-value">2</span>].<span class="ruby-identifier">slice</span>(<span class="ruby-value">0</span>, <span class="ruby-value">2</span>),<span class="ruby-ivar">@format_dfmt07</span>)            
424:         <span class="ruby-keyword kw">end</span>   
425:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000145" class="method-detail">
        <a name="M000145"></a>

        <div class="method-heading">
          <a href="#M000145" class="method-signature">
          <span class="method-name">format_letter_dfmt09</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000145-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000145-source">
<pre>
     <span class="ruby-comment cmt"># File app/controllers/format_letter_controller.rb, line 427</span>
427:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">format_letter_dfmt09</span>
428:         <span class="ruby-comment cmt">#拼接字串，初始化</span>
429:         <span class="ruby-ivar">@format_dfmt09</span> = <span class="ruby-value str">&quot;&quot;</span>  
430:         <span class="ruby-comment cmt">#函号</span>
431:         <span class="ruby-ivar">@file_code</span> = <span class="ruby-constant">TbDoc</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:first</span>,<span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">&quot;used = 'Y' and recevice_code = ?&quot;</span>,<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]])
432:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@file_code</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@file_code</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
433:             <span class="ruby-ivar">@file_code</span> = <span class="ruby-value str">&quot;no&quot;</span>
434:         <span class="ruby-keyword kw">else</span>
435:             <span class="ruby-ivar">@file_code</span> = <span class="ruby-ivar">@file_code</span>.<span class="ruby-identifier">file_code</span>
436:         <span class="ruby-keyword kw">end</span>
437:         <span class="ruby-ivar">@format_dfmt09</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;01$$$&gt;&quot;</span>,<span class="ruby-ivar">@file_code</span>,<span class="ruby-ivar">@format_dfmt09</span>)
438:         <span class="ruby-comment cmt">#被申请人</span>
439:         <span class="ruby-ivar">@respondents</span> = <span class="ruby-constant">TbParty</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:all</span>,<span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">&quot;used = 'Y' and partytype = 2 and recevice_code = ?&quot;</span>,<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]], <span class="ruby-identifier">:order</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;id&quot;</span>)
440:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@respondent</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@respondent</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
441:             <span class="ruby-ivar">@respondent</span> = <span class="ruby-value str">&quot;no&quot;</span>
442:         <span class="ruby-keyword kw">else</span>
443:             <span class="ruby-ivar">@respondent</span> = <span class="ruby-value str">&quot;&quot;</span>
444:             <span class="ruby-ivar">@respondents</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">resp</span><span class="ruby-operator">|</span>
445:                 <span class="ruby-ivar">@respondent</span> = <span class="ruby-ivar">@respondent</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">resp</span>.<span class="ruby-identifier">partyname</span>
446:             <span class="ruby-keyword kw">end</span>
447:         <span class="ruby-keyword kw">end</span>       
448:         <span class="ruby-ivar">@format_dfmt09</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;02$$$&gt;&quot;</span>,<span class="ruby-ivar">@respondent</span>,<span class="ruby-ivar">@format_dfmt09</span>)   
449:         <span class="ruby-comment cmt">#立案号</span>
450:         <span class="ruby-ivar">@case_code</span> = <span class="ruby-constant">TbCase</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:first</span>, <span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">&quot;used = 'Y' and recevice_code = ?&quot;</span>,<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]]).<span class="ruby-identifier">case_code</span>
451:         <span class="ruby-ivar">@format_dfmt09</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;03$$$&gt;&quot;</span>,<span class="ruby-ivar">@case_code</span>,<span class="ruby-ivar">@format_dfmt09</span>)            
452:         <span class="ruby-comment cmt">#被申请人受理费</span>
453:         <span class="ruby-ivar">@litigation_fee</span> = <span class="ruby-identifier">respondent_litigation_fee</span>(<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>])
454:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@litigation_fee</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@litigation_fee</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
455:             <span class="ruby-ivar">@litigation_fee</span> = <span class="ruby-value str">&quot;no&quot;</span>
456:         <span class="ruby-keyword kw">end</span>
457:         <span class="ruby-ivar">@format_dfmt09</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;04$$$&gt;&quot;</span>,<span class="ruby-ivar">@litigation_fee</span>,<span class="ruby-ivar">@format_dfmt09</span>)    
458:         <span class="ruby-comment cmt">#被申请人处理费</span>
459:         <span class="ruby-ivar">@processing_fee</span> = <span class="ruby-identifier">respondent_arbit_fee</span>(<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]) 
460:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@processing_fee</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@processing_fee</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
461:             <span class="ruby-ivar">@processing_fee</span> = <span class="ruby-value str">&quot;no&quot;</span>
462:         <span class="ruby-keyword kw">end</span>        
463:         <span class="ruby-ivar">@format_dfmt09</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;05$$$&gt;&quot;</span>,<span class="ruby-ivar">@processing_fee</span>,<span class="ruby-ivar">@format_dfmt09</span>) 
464:         <span class="ruby-comment cmt">#其它实际费用开支费</span>
465:         <span class="ruby-comment cmt">################################# 空缺 ################################</span>
466:         <span class="ruby-ivar">@other_fee</span> = <span class="ruby-value">0</span>              
467:         <span class="ruby-ivar">@format_dfmt09</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;06$$$&gt;&quot;</span>,<span class="ruby-ivar">@other_fee</span>,<span class="ruby-ivar">@format_dfmt09</span>)
468:         <span class="ruby-comment cmt">#合计        </span>
469:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@litigation_fee</span> <span class="ruby-operator">!=</span> <span class="ruby-value str">&quot;no&quot;</span> <span class="ruby-keyword kw">and</span> <span class="ruby-ivar">@processing_fee</span> <span class="ruby-operator">!=</span> <span class="ruby-value str">&quot;no&quot;</span> <span class="ruby-keyword kw">and</span> <span class="ruby-ivar">@other_fee</span> <span class="ruby-operator">!=</span> <span class="ruby-value str">&quot;no&quot;</span>
470:             <span class="ruby-ivar">@total_fee</span> = <span class="ruby-ivar">@litigation_fee</span>.<span class="ruby-identifier">to_i</span> <span class="ruby-operator">+</span> <span class="ruby-ivar">@processing_fee</span>.<span class="ruby-identifier">to_i</span> <span class="ruby-operator">+</span> <span class="ruby-ivar">@other_fee</span>.<span class="ruby-identifier">to_i</span>
471:         <span class="ruby-keyword kw">else</span>
472:             <span class="ruby-ivar">@total_fee</span> = <span class="ruby-value str">&quot;no&quot;</span>
473:         <span class="ruby-keyword kw">end</span>
474:         <span class="ruby-ivar">@format_dfmt09</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;07$$$&gt;&quot;</span>,<span class="ruby-ivar">@total_fee</span>,<span class="ruby-ivar">@format_dfmt09</span>)           
475:         <span class="ruby-comment cmt">#日期</span>
476:         <span class="ruby-ivar">@date_of_letter</span> = <span class="ruby-constant">Time</span>.<span class="ruby-identifier">now</span>.<span class="ruby-identifier">to_s</span>(<span class="ruby-identifier">:db</span>)
477:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@date_of_letter</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@date_of_letter</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
478:             <span class="ruby-ivar">@date_of_letter</span> = <span class="ruby-value str">&quot;no&quot;</span>
479:             <span class="ruby-ivar">@format_dfmt09</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;08$$$&gt;&quot;</span>,<span class="ruby-ivar">@date_of_letter</span>,<span class="ruby-ivar">@format_dfmt09</span>) 
480:             <span class="ruby-ivar">@format_dfmt09</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;09$$$&gt;&quot;</span>,<span class="ruby-ivar">@date_of_letter</span>,<span class="ruby-ivar">@format_dfmt09</span>)
481:             <span class="ruby-ivar">@format_dfmt09</span> = <span class="ruby-identifier">add_last_record</span>(<span class="ruby-value str">&quot;&lt;10$$$&gt;&quot;</span>,<span class="ruby-ivar">@date_of_letter</span>,<span class="ruby-ivar">@format_dfmt09</span>)
482:         <span class="ruby-keyword kw">else</span>
483:             <span class="ruby-identifier">arr_date</span> = <span class="ruby-ivar">@date_of_letter</span>.<span class="ruby-identifier">to_s</span>.<span class="ruby-identifier">split</span>(<span class="ruby-value str">&quot;-&quot;</span>)
484:             <span class="ruby-ivar">@format_dfmt09</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;08$$$&gt;&quot;</span>,<span class="ruby-identifier">arr_date</span>[<span class="ruby-value">0</span>],<span class="ruby-ivar">@format_dfmt09</span>) 
485:             <span class="ruby-ivar">@format_dfmt09</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;09$$$&gt;&quot;</span>,<span class="ruby-identifier">arr_date</span>[<span class="ruby-value">1</span>],<span class="ruby-ivar">@format_dfmt09</span>)
486:             <span class="ruby-ivar">@format_dfmt09</span> = <span class="ruby-identifier">add_last_record</span>(<span class="ruby-value str">&quot;&lt;10$$$&gt;&quot;</span>,<span class="ruby-identifier">arr_date</span>[<span class="ruby-value">2</span>].<span class="ruby-identifier">slice</span>(<span class="ruby-value">0</span>, <span class="ruby-value">2</span>),<span class="ruby-ivar">@format_dfmt09</span>)            
487:         <span class="ruby-keyword kw">end</span>   
488:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000147" class="method-detail">
        <a name="M000147"></a>

        <div class="method-heading">
          <a href="#M000147" class="method-signature">
          <span class="method-name">format_letter_dfmt26</span><span class="method-args">(applicant)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000147-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000147-source">
<pre>
     <span class="ruby-comment cmt"># File app/controllers/format_letter_controller.rb, line 531</span>
531:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">format_letter_dfmt26</span>(<span class="ruby-identifier">applicant</span>)
532:         <span class="ruby-comment cmt">#拼接字串，初始化</span>
533:         <span class="ruby-ivar">@format_dfmt26</span> = <span class="ruby-value str">&quot;&quot;</span>  
534:         <span class="ruby-comment cmt">#函号</span>
535:         <span class="ruby-ivar">@file_code</span> = <span class="ruby-constant">TbDoc</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:first</span>,<span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">&quot;used = 'Y' and recevice_code = ?&quot;</span>,<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]])
536:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@file_code</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@file_code</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
537:             <span class="ruby-ivar">@file_code</span> = <span class="ruby-value str">&quot;no&quot;</span>
538:         <span class="ruby-keyword kw">else</span>
539:             <span class="ruby-ivar">@file_code</span> = <span class="ruby-ivar">@file_code</span>.<span class="ruby-identifier">file_code</span>
540:         <span class="ruby-keyword kw">end</span>
541:         <span class="ruby-ivar">@format_dfmt26</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;01$$$&gt;&quot;</span>,<span class="ruby-ivar">@file_code</span>,<span class="ruby-ivar">@format_dfmt26</span>)
542:         <span class="ruby-comment cmt">#申请人</span>
543:         <span class="ruby-ivar">@applicants</span> = <span class="ruby-constant">TbParty</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:all</span>,<span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">&quot;used = 'Y' and partytype = 1 and recevice_code = ?&quot;</span>,<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]], <span class="ruby-identifier">:order</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;id&quot;</span>)
544:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@applicants</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@applicants</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
545:             <span class="ruby-ivar">@applicant</span> = <span class="ruby-value str">&quot;no&quot;</span>
546:         <span class="ruby-keyword kw">else</span>
547:             <span class="ruby-ivar">@applicant</span> = <span class="ruby-value str">&quot;&quot;</span>
548:             <span class="ruby-ivar">@applicants</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">appl</span><span class="ruby-operator">|</span>
549:                 <span class="ruby-ivar">@applicant</span> = <span class="ruby-ivar">@applicant</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">appl</span>.<span class="ruby-identifier">partyname</span>
550:             <span class="ruby-keyword kw">end</span>
551:         <span class="ruby-keyword kw">end</span>       
552:         <span class="ruby-ivar">@format_dfmt26</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;02$$$&gt;&quot;</span>,<span class="ruby-ivar">@applicant</span>,<span class="ruby-ivar">@format_dfmt26</span>)       
553:         <span class="ruby-comment cmt">#立案号</span>
554:         <span class="ruby-ivar">@case_code</span> = <span class="ruby-constant">TbCase</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:first</span>, <span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">&quot;used = 'Y' and recevice_code = ?&quot;</span>,<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]]).<span class="ruby-identifier">case_code</span>
555:         <span class="ruby-ivar">@format_dfmt26</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;03$$$&gt;&quot;</span>,<span class="ruby-ivar">@case_code</span>,<span class="ruby-ivar">@format_dfmt26</span>)            
556:         <span class="ruby-comment cmt">#####################   仲裁员空缺 ######################################          </span>
557:         <span class="ruby-comment cmt">#日期</span>
558:         <span class="ruby-ivar">@date_of_letter</span> = <span class="ruby-constant">Time</span>.<span class="ruby-identifier">now</span>.<span class="ruby-identifier">to_s</span>(<span class="ruby-identifier">:db</span>)
559:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@date_of_letter</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@date_of_letter</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
560:             <span class="ruby-ivar">@date_of_letter</span> = <span class="ruby-value str">&quot;no&quot;</span>
561:             <span class="ruby-ivar">@format_dfmt26</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;06$$$&gt;&quot;</span>,<span class="ruby-ivar">@date_of_letter</span>,<span class="ruby-ivar">@format_dfmt26</span>) 
562:             <span class="ruby-ivar">@format_dfmt26</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;07$$$&gt;&quot;</span>,<span class="ruby-ivar">@date_of_letter</span>,<span class="ruby-ivar">@format_dfmt26</span>)
563:             <span class="ruby-ivar">@format_dfmt26</span> = <span class="ruby-identifier">add_last_record</span>(<span class="ruby-value str">&quot;&lt;08$$$&gt;&quot;</span>,<span class="ruby-ivar">@date_of_letter</span>,<span class="ruby-ivar">@format_dfmt26</span>)
564:         <span class="ruby-keyword kw">else</span>
565:             <span class="ruby-identifier">arr_date</span> = <span class="ruby-ivar">@date_of_letter</span>.<span class="ruby-identifier">to_s</span>.<span class="ruby-identifier">split</span>(<span class="ruby-value str">&quot;-&quot;</span>)
566:             <span class="ruby-ivar">@format_dfmt26</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;06$$$&gt;&quot;</span>,<span class="ruby-identifier">arr_date</span>[<span class="ruby-value">0</span>],<span class="ruby-ivar">@format_dfmt26</span>) 
567:             <span class="ruby-ivar">@format_dfmt26</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;07$$$&gt;&quot;</span>,<span class="ruby-identifier">arr_date</span>[<span class="ruby-value">1</span>],<span class="ruby-ivar">@format_dfmt26</span>)
568:             <span class="ruby-ivar">@format_dfmt26</span> = <span class="ruby-identifier">add_last_record</span>(<span class="ruby-value str">&quot;&lt;08$$$&gt;&quot;</span>,<span class="ruby-identifier">arr_date</span>[<span class="ruby-value">2</span>].<span class="ruby-identifier">slice</span>(<span class="ruby-value">0</span>, <span class="ruby-value">2</span>),<span class="ruby-ivar">@format_dfmt26</span>)            
569:         <span class="ruby-keyword kw">end</span>   
570:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000146" class="method-detail">
        <a name="M000146"></a>

        <div class="method-heading">
          <a href="#M000146" class="method-signature">
          <span class="method-name">format_letter_dfmt26</span><span class="method-args">(respondent)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000146-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000146-source">
<pre>
     <span class="ruby-comment cmt"># File app/controllers/format_letter_controller.rb, line 490</span>
490:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">format_letter_dfmt26</span>(<span class="ruby-identifier">respondent</span>)
491:         <span class="ruby-comment cmt">#拼接字串，初始化</span>
492:         <span class="ruby-ivar">@format_dfmt26</span> = <span class="ruby-value str">&quot;&quot;</span>  
493:         <span class="ruby-comment cmt">#函号</span>
494:         <span class="ruby-ivar">@file_code</span> = <span class="ruby-constant">TbDoc</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:first</span>,<span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">&quot;used = 'Y' and recevice_code = ?&quot;</span>,<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]])
495:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@file_code</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@file_code</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
496:             <span class="ruby-ivar">@file_code</span> = <span class="ruby-value str">&quot;no&quot;</span>
497:         <span class="ruby-keyword kw">else</span>
498:             <span class="ruby-ivar">@file_code</span> = <span class="ruby-ivar">@file_code</span>.<span class="ruby-identifier">file_code</span>
499:         <span class="ruby-keyword kw">end</span>
500:         <span class="ruby-ivar">@format_dfmt26</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;01$$$&gt;&quot;</span>,<span class="ruby-ivar">@file_code</span>,<span class="ruby-ivar">@format_dfmt26</span>)
501:         <span class="ruby-comment cmt">#被申请人</span>
502:         <span class="ruby-ivar">@respondents</span> = <span class="ruby-constant">TbParty</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:all</span>,<span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">&quot;used = 'Y' and partytype = 2 and recevice_code = ?&quot;</span>,<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]], <span class="ruby-identifier">:order</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;id&quot;</span>)
503:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@respondent</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@respondent</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
504:             <span class="ruby-ivar">@respondent</span> = <span class="ruby-value str">&quot;no&quot;</span>
505:         <span class="ruby-keyword kw">else</span>
506:             <span class="ruby-ivar">@respondent</span> = <span class="ruby-value str">&quot;&quot;</span>
507:             <span class="ruby-ivar">@respondents</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">resp</span><span class="ruby-operator">|</span>
508:                 <span class="ruby-ivar">@respondent</span> = <span class="ruby-ivar">@respondent</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">resp</span>.<span class="ruby-identifier">partyname</span>
509:             <span class="ruby-keyword kw">end</span>
510:         <span class="ruby-keyword kw">end</span>       
511:         <span class="ruby-ivar">@format_dfmt26</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;02$$$&gt;&quot;</span>,<span class="ruby-ivar">@respondent</span>,<span class="ruby-ivar">@format_dfmt26</span>)   
512:         <span class="ruby-comment cmt">#立案号</span>
513:         <span class="ruby-ivar">@case_code</span> = <span class="ruby-constant">TbCase</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:first</span>, <span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">&quot;used = 'Y' and recevice_code = ?&quot;</span>,<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]]).<span class="ruby-identifier">case_code</span>
514:         <span class="ruby-ivar">@format_dfmt26</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;03$$$&gt;&quot;</span>,<span class="ruby-ivar">@case_code</span>,<span class="ruby-ivar">@format_dfmt26</span>)            
515:         <span class="ruby-comment cmt">#####################   仲裁员空缺 ######################################          </span>
516:         <span class="ruby-comment cmt">#日期</span>
517:         <span class="ruby-ivar">@date_of_letter</span> = <span class="ruby-constant">Time</span>.<span class="ruby-identifier">now</span>.<span class="ruby-identifier">to_s</span>(<span class="ruby-identifier">:db</span>)
518:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@date_of_letter</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@date_of_letter</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
519:             <span class="ruby-ivar">@date_of_letter</span> = <span class="ruby-value str">&quot;no&quot;</span>
520:             <span class="ruby-ivar">@format_dfmt26</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;06$$$&gt;&quot;</span>,<span class="ruby-ivar">@date_of_letter</span>,<span class="ruby-ivar">@format_dfmt26</span>) 
521:             <span class="ruby-ivar">@format_dfmt26</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;07$$$&gt;&quot;</span>,<span class="ruby-ivar">@date_of_letter</span>,<span class="ruby-ivar">@format_dfmt26</span>)
522:             <span class="ruby-ivar">@format_dfmt26</span> = <span class="ruby-identifier">add_last_record</span>(<span class="ruby-value str">&quot;&lt;08$$$&gt;&quot;</span>,<span class="ruby-ivar">@date_of_letter</span>,<span class="ruby-ivar">@format_dfmt26</span>)
523:         <span class="ruby-keyword kw">else</span>
524:             <span class="ruby-identifier">arr_date</span> = <span class="ruby-ivar">@date_of_letter</span>.<span class="ruby-identifier">to_s</span>.<span class="ruby-identifier">split</span>(<span class="ruby-value str">&quot;-&quot;</span>)
525:             <span class="ruby-ivar">@format_dfmt26</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;06$$$&gt;&quot;</span>,<span class="ruby-identifier">arr_date</span>[<span class="ruby-value">0</span>],<span class="ruby-ivar">@format_dfmt26</span>) 
526:             <span class="ruby-ivar">@format_dfmt26</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;07$$$&gt;&quot;</span>,<span class="ruby-identifier">arr_date</span>[<span class="ruby-value">1</span>],<span class="ruby-ivar">@format_dfmt26</span>)
527:             <span class="ruby-ivar">@format_dfmt26</span> = <span class="ruby-identifier">add_last_record</span>(<span class="ruby-value str">&quot;&lt;08$$$&gt;&quot;</span>,<span class="ruby-identifier">arr_date</span>[<span class="ruby-value">2</span>].<span class="ruby-identifier">slice</span>(<span class="ruby-value">0</span>, <span class="ruby-value">2</span>),<span class="ruby-ivar">@format_dfmt26</span>)            
528:         <span class="ruby-keyword kw">end</span>   
529:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000148" class="method-detail">
        <a name="M000148"></a>

        <div class="method-heading">
          <a href="#M000148" class="method-signature">
          <span class="method-name">format_letter_dfmt31</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000148-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000148-source">
<pre>
     <span class="ruby-comment cmt"># File app/controllers/format_letter_controller.rb, line 572</span>
572:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">format_letter_dfmt31</span>
573:         <span class="ruby-comment cmt">#拼接字串，初始化</span>
574:         <span class="ruby-ivar">@format_dfmt31</span> = <span class="ruby-value str">&quot;&quot;</span>  
575:         <span class="ruby-comment cmt">#函号</span>
576:         <span class="ruby-ivar">@file_code</span> = <span class="ruby-constant">TbDoc</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:first</span>,<span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">&quot;used = 'Y' and recevice_code = ?&quot;</span>,<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]])
577:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@file_code</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@file_code</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
578:             <span class="ruby-ivar">@file_code</span> = <span class="ruby-value str">&quot;no&quot;</span>
579:         <span class="ruby-keyword kw">else</span>
580:             <span class="ruby-ivar">@file_code</span> = <span class="ruby-ivar">@file_code</span>.<span class="ruby-identifier">file_code</span>
581:         <span class="ruby-keyword kw">end</span>
582:         <span class="ruby-ivar">@format_dfmt31</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;01$$$&gt;&quot;</span>,<span class="ruby-ivar">@file_code</span>,<span class="ruby-ivar">@format_dfmt31</span>)
583:         <span class="ruby-comment cmt">#立案号</span>
584:         <span class="ruby-ivar">@case_code</span> = <span class="ruby-constant">TbCase</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:first</span>, <span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">&quot;used = 'Y' and recevice_code = ?&quot;</span>,<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]]).<span class="ruby-identifier">case_code</span>
585:         <span class="ruby-ivar">@format_dfmt31</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;02$$$&gt;&quot;</span>,<span class="ruby-ivar">@case_code</span>,<span class="ruby-ivar">@format_dfmt31</span>) 
586:         <span class="ruby-ivar">@format_dfmt31</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;06$$$&gt;&quot;</span>,<span class="ruby-ivar">@case_code</span>,<span class="ruby-ivar">@format_dfmt31</span>)
587:         <span class="ruby-comment cmt">#被申请人</span>
588:         <span class="ruby-ivar">@respondents</span> = <span class="ruby-constant">TbParty</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:all</span>,<span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">&quot;used = 'Y' and partytype = 2 and recevice_code = ?&quot;</span>,<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]], <span class="ruby-identifier">:order</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;id&quot;</span>)
589:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@respondent</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@respondent</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
590:             <span class="ruby-ivar">@respondent</span> = <span class="ruby-value str">&quot;no&quot;</span>
591:         <span class="ruby-keyword kw">else</span>
592:             <span class="ruby-ivar">@respondent</span> = <span class="ruby-value str">&quot;&quot;</span>
593:             <span class="ruby-ivar">@respondents</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">resp</span><span class="ruby-operator">|</span>
594:                 <span class="ruby-ivar">@respondent</span> = <span class="ruby-ivar">@respondent</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">resp</span>.<span class="ruby-identifier">partyname</span>
595:             <span class="ruby-keyword kw">end</span>
596:         <span class="ruby-keyword kw">end</span>   
597:         <span class="ruby-ivar">@format_dfmt31</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;03$$$&gt;&quot;</span>,<span class="ruby-ivar">@respondent</span>,<span class="ruby-ivar">@format_dfmt31</span>)
598:         <span class="ruby-comment cmt">#申请人</span>
599:         <span class="ruby-ivar">@applicants</span> = <span class="ruby-constant">TbParty</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:all</span>,<span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">&quot;used = 'Y' and partytype = 1 and recevice_code = ?&quot;</span>,<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]], <span class="ruby-identifier">:order</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;id&quot;</span>)
600:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@applicants</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@applicants</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
601:             <span class="ruby-ivar">@applicant</span> = <span class="ruby-value str">&quot;no&quot;</span>
602:         <span class="ruby-keyword kw">else</span>
603:             <span class="ruby-ivar">@applicant</span> = <span class="ruby-value str">&quot;&quot;</span>
604:             <span class="ruby-ivar">@applicants</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">applicant</span><span class="ruby-operator">|</span>
605:                 <span class="ruby-ivar">@applicant</span> = <span class="ruby-ivar">@applicant</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">applicant</span>.<span class="ruby-identifier">partyname</span>
606:             <span class="ruby-keyword kw">end</span>
607:         <span class="ruby-keyword kw">end</span>       
608:         <span class="ruby-ivar">@format_dfmt31</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;04$$$&gt;&quot;</span>,<span class="ruby-ivar">@applicant</span>,<span class="ruby-ivar">@format_dfmt31</span>) 
609:         <span class="ruby-comment cmt">#签订的$$$所引起的争议（合同名称）</span>
610:         <span class="ruby-ivar">@contract_name</span> = <span class="ruby-constant">TbContractsign</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:first</span>,<span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">&quot;used = 'Y' and recevice_code = ?&quot;</span>,<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]])
611:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@contract_name</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@contract_name</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
612:             <span class="ruby-ivar">@contract_name</span> = <span class="ruby-value str">&quot;no&quot;</span>
613:         <span class="ruby-keyword kw">else</span>
614:             <span class="ruby-ivar">@contract_name</span> = <span class="ruby-ivar">@contract_name</span>.<span class="ruby-identifier">pactname</span>
615:         <span class="ruby-keyword kw">end</span>   
616:         <span class="ruby-ivar">@format_dfmt31</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;05$$$&gt;&quot;</span>,<span class="ruby-ivar">@contract_name</span>,<span class="ruby-ivar">@format_dfmt31</span>)
617:         <span class="ruby-comment cmt">#文件份数</span>
618:         <span class="ruby-ivar">@copies</span> = <span class="ruby-identifier">num_papers</span>(<span class="ruby-ivar">@applicants</span>.<span class="ruby-identifier">size</span>)
619:         <span class="ruby-ivar">@format_dfmt31</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;07$$$&gt;&quot;</span>,<span class="ruby-ivar">@copies</span>,<span class="ruby-ivar">@format_dfmt31</span>) 
620:         <span class="ruby-ivar">@format_dfmt31</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;08$$$&gt;&quot;</span>,<span class="ruby-ivar">@copies</span>,<span class="ruby-ivar">@format_dfmt31</span>)
621:         <span class="ruby-ivar">@format_dfmt31</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;09$$$&gt;&quot;</span>,<span class="ruby-ivar">@copies</span>,<span class="ruby-ivar">@format_dfmt31</span>) 
622:         <span class="ruby-ivar">@format_dfmt31</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;10$$$&gt;&quot;</span>,<span class="ruby-ivar">@copies</span>,<span class="ruby-ivar">@format_dfmt31</span>) 
623:         <span class="ruby-comment cmt">#助理</span>
624:         <span class="ruby-identifier">clerk_code</span> = <span class="ruby-constant">TbCase</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:first</span>,<span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">&quot;used = 'Y' and recevice_code = ?&quot;</span>,<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]]).<span class="ruby-identifier">clerk</span>
625:         <span class="ruby-identifier">clerk</span> = <span class="ruby-constant">User</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:first</span>,<span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">&quot;used = 'Y' and code = ?&quot;</span>,<span class="ruby-identifier">clerk_code</span>])
626:         <span class="ruby-ivar">@case_alerk</span> = <span class="ruby-identifier">clerk</span>.<span class="ruby-identifier">name</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">clerk</span>.<span class="ruby-identifier">sex</span>
627:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@case_alerk</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@case_alerk</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
628:             <span class="ruby-ivar">@case_alerk</span> = <span class="ruby-value str">&quot;no&quot;</span>
629:         <span class="ruby-keyword kw">end</span>       
630:         <span class="ruby-ivar">@format_dfmt31</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;11$$$&gt;&quot;</span>,<span class="ruby-ivar">@case_alerk</span>,<span class="ruby-ivar">@format_dfmt31</span>)  
631:         <span class="ruby-comment cmt">#电话        </span>
632:         <span class="ruby-ivar">@telephone</span> = <span class="ruby-identifier">clerk</span>.<span class="ruby-identifier">telephone</span>
633:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@telephone</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@telephone</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
634:             <span class="ruby-ivar">@telephone</span> = <span class="ruby-value str">&quot;no&quot;</span>
635:         <span class="ruby-keyword kw">end</span>     
636:         <span class="ruby-ivar">@format_dfmt31</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;12$$$&gt;&quot;</span>,<span class="ruby-ivar">@telephone</span>,<span class="ruby-ivar">@format_dfmt31</span>)       
637:         <span class="ruby-comment cmt">#传真</span>
638:         <span class="ruby-ivar">@fax</span> = <span class="ruby-identifier">clerk</span>.<span class="ruby-identifier">fax</span>
639:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@fax</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@fax</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
640:             <span class="ruby-ivar">@fax</span> = <span class="ruby-value str">&quot;no&quot;</span>
641:         <span class="ruby-keyword kw">end</span>    
642:         <span class="ruby-ivar">@format_dfmt31</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;13$$$&gt;&quot;</span>,<span class="ruby-ivar">@fax</span>,<span class="ruby-ivar">@format_dfmt31</span>)     
643:         <span class="ruby-comment cmt">#电子邮箱</span>
644:         <span class="ruby-ivar">@email</span> = <span class="ruby-identifier">clerk</span>.<span class="ruby-identifier">email</span>
645:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@email</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@email</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
646:             <span class="ruby-ivar">@email</span> = <span class="ruby-value str">&quot;no&quot;</span>
647:         <span class="ruby-keyword kw">end</span>  
648:         <span class="ruby-ivar">@format_dfmt31</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;14$$$&gt;&quot;</span>,<span class="ruby-ivar">@email</span>,<span class="ruby-ivar">@format_dfmt31</span>)    
649:         <span class="ruby-comment cmt">#日期</span>
650:         <span class="ruby-ivar">@date_of_letter</span> = <span class="ruby-constant">Time</span>.<span class="ruby-identifier">now</span>.<span class="ruby-identifier">to_s</span>(<span class="ruby-identifier">:db</span>)
651:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@date_of_letter</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@date_of_letter</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
652:             <span class="ruby-ivar">@date_of_letter</span> = <span class="ruby-value str">&quot;no&quot;</span>
653:             <span class="ruby-ivar">@format_dfmt31</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;15$$$&gt;&quot;</span>,<span class="ruby-ivar">@date_of_letter</span>,<span class="ruby-ivar">@format_dfmt31</span>) 
654:             <span class="ruby-ivar">@format_dfmt31</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;16$$$&gt;&quot;</span>,<span class="ruby-ivar">@date_of_letter</span>,<span class="ruby-ivar">@format_dfmt31</span>)
655:             <span class="ruby-ivar">@format_dfmt31</span> = <span class="ruby-identifier">add_last_record</span>(<span class="ruby-value str">&quot;&lt;17$$$&gt;&quot;</span>,<span class="ruby-ivar">@date_of_letter</span>,<span class="ruby-ivar">@format_dfmt31</span>)
656:         <span class="ruby-keyword kw">else</span>
657:             <span class="ruby-identifier">arr_date</span> = <span class="ruby-ivar">@date_of_letter</span>.<span class="ruby-identifier">to_s</span>.<span class="ruby-identifier">split</span>(<span class="ruby-value str">&quot;-&quot;</span>)
658:             <span class="ruby-ivar">@format_dfmt31</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;15$$$&gt;&quot;</span>,<span class="ruby-identifier">arr_date</span>[<span class="ruby-value">0</span>],<span class="ruby-ivar">@format_dfmt31</span>) 
659:             <span class="ruby-ivar">@format_dfmt31</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;16$$$&gt;&quot;</span>,<span class="ruby-identifier">arr_date</span>[<span class="ruby-value">1</span>],<span class="ruby-ivar">@format_dfmt31</span>)
660:             <span class="ruby-ivar">@format_dfmt31</span> = <span class="ruby-identifier">add_last_record</span>(<span class="ruby-value str">&quot;&lt;17$$$&gt;&quot;</span>,<span class="ruby-identifier">arr_date</span>[<span class="ruby-value">2</span>].<span class="ruby-identifier">slice</span>(<span class="ruby-value">0</span>, <span class="ruby-value">2</span>),<span class="ruby-ivar">@format_dfmt31</span>)            
661:         <span class="ruby-keyword kw">end</span>          
662:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000149" class="method-detail">
        <a name="M000149"></a>

        <div class="method-heading">
          <a href="#M000149" class="method-signature">
          <span class="method-name">format_letter_dfmt32</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000149-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000149-source">
<pre>
     <span class="ruby-comment cmt"># File app/controllers/format_letter_controller.rb, line 664</span>
664:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">format_letter_dfmt32</span>
665:         <span class="ruby-comment cmt">#拼接字串，初始化</span>
666:         <span class="ruby-ivar">@format_dfmt32</span> = <span class="ruby-value str">&quot;&quot;</span>  
667:         <span class="ruby-comment cmt">#函号</span>
668:         <span class="ruby-ivar">@file_code</span> = <span class="ruby-constant">TbDoc</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:first</span>,<span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">&quot;used = 'Y' and recevice_code = ?&quot;</span>,<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]])
669:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@file_code</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@file_code</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
670:             <span class="ruby-ivar">@file_code</span> = <span class="ruby-value str">&quot;no&quot;</span>
671:         <span class="ruby-keyword kw">else</span>
672:             <span class="ruby-ivar">@file_code</span> = <span class="ruby-ivar">@file_code</span>.<span class="ruby-identifier">file_code</span>
673:         <span class="ruby-keyword kw">end</span>
674:         <span class="ruby-ivar">@format_dfmt32</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;01$$$&gt;&quot;</span>,<span class="ruby-ivar">@file_code</span>,<span class="ruby-ivar">@format_dfmt32</span>)
675:         <span class="ruby-comment cmt">#立案号</span>
676:         <span class="ruby-ivar">@case_code</span> = <span class="ruby-constant">TbCase</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:first</span>, <span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">&quot;used = 'Y' and recevice_code = ?&quot;</span>,<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]]).<span class="ruby-identifier">case_code</span>
677:         <span class="ruby-ivar">@format_dfmt32</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;02$$$&gt;&quot;</span>,<span class="ruby-ivar">@case_code</span>,<span class="ruby-ivar">@format_dfmt32</span>)  
678:         <span class="ruby-ivar">@format_dfmt32</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;08$$$&gt;&quot;</span>,<span class="ruby-ivar">@case_code</span>,<span class="ruby-ivar">@format_dfmt32</span>)
679:         <span class="ruby-comment cmt">#申请人</span>
680:         <span class="ruby-ivar">@applicants</span> = <span class="ruby-constant">TbParty</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:all</span>,<span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">&quot;used = 'Y' and partytype = 1 and recevice_code = ?&quot;</span>,<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]], <span class="ruby-identifier">:order</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;id&quot;</span>)
681:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@applicants</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@applicants</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
682:             <span class="ruby-ivar">@applicant</span> = <span class="ruby-value str">&quot;no&quot;</span>
683:         <span class="ruby-keyword kw">else</span>
684:             <span class="ruby-ivar">@applicant</span> = <span class="ruby-value str">&quot;&quot;</span>
685:             <span class="ruby-ivar">@applicants</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">applicant</span><span class="ruby-operator">|</span>
686:                 <span class="ruby-ivar">@applicant</span> = <span class="ruby-ivar">@applicant</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">applicant</span>.<span class="ruby-identifier">partyname</span>
687:             <span class="ruby-keyword kw">end</span>
688:         <span class="ruby-keyword kw">end</span>        
689:         <span class="ruby-ivar">@format_dfmt32</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;03$$$&gt;&quot;</span>,<span class="ruby-ivar">@applicant</span>,<span class="ruby-ivar">@format_dfmt32</span>)
690:         <span class="ruby-comment cmt">#被申请人</span>
691:         <span class="ruby-ivar">@respondents</span> = <span class="ruby-constant">TbParty</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:all</span>,<span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">&quot;used = 'Y' and partytype = 2 and recevice_code = ?&quot;</span>,<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]], <span class="ruby-identifier">:order</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;id&quot;</span>)
692:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@respondent</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@respondent</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
693:             <span class="ruby-ivar">@respondent</span> = <span class="ruby-value str">&quot;no&quot;</span>
694:         <span class="ruby-keyword kw">else</span>
695:             <span class="ruby-ivar">@respondent</span> = <span class="ruby-value str">&quot;&quot;</span>
696:             <span class="ruby-ivar">@respondents</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">resp</span><span class="ruby-operator">|</span>
697:                 <span class="ruby-ivar">@respondent</span> = <span class="ruby-ivar">@respondent</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">resp</span>.<span class="ruby-identifier">partyname</span>
698:             <span class="ruby-keyword kw">end</span>
699:         <span class="ruby-keyword kw">end</span>       
700:         <span class="ruby-ivar">@format_dfmt32</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;04$$$&gt;&quot;</span>,<span class="ruby-ivar">@respondent</span>,<span class="ruby-ivar">@format_dfmt32</span>)
701:         <span class="ruby-comment cmt">#文件份数</span>
702:         <span class="ruby-ivar">@copies</span> = <span class="ruby-identifier">num_papers</span>(<span class="ruby-ivar">@respondents</span>.<span class="ruby-identifier">size</span>)
703:         <span class="ruby-ivar">@format_dfmt32</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;05$$$&gt;&quot;</span>,<span class="ruby-ivar">@copies</span>,<span class="ruby-ivar">@format_dfmt32</span>)  
704:         <span class="ruby-comment cmt">#仲裁费</span>
705:         <span class="ruby-ivar">@arbit_fee</span> = <span class="ruby-identifier">applicant_arbit_fee</span>(<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]) 
706:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@arbit_fee</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@arbit_fee</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
707:             <span class="ruby-ivar">@arbit_fee</span> = <span class="ruby-value str">&quot;no&quot;</span>
708:         <span class="ruby-keyword kw">end</span>        
709:         <span class="ruby-ivar">@format_dfmt32</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;06$$$&gt;&quot;</span>,<span class="ruby-ivar">@arbit_fee</span>,<span class="ruby-ivar">@format_dfmt32</span>)           
710:         <span class="ruby-comment cmt">#关于$$$项下争议的仲裁申请文件（合同名称）</span>
711:         <span class="ruby-ivar">@contract_name</span> = <span class="ruby-constant">TbContractsign</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:first</span>,<span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">&quot;used = 'Y' and recevice_code = ?&quot;</span>,<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]])
712:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@contract_name</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@contract_name</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
713:             <span class="ruby-ivar">@contract_name</span> = <span class="ruby-value str">&quot;no&quot;</span>
714:         <span class="ruby-keyword kw">else</span>
715:             <span class="ruby-ivar">@contract_name</span> = <span class="ruby-ivar">@contract_name</span>.<span class="ruby-identifier">pactname</span>
716:         <span class="ruby-keyword kw">end</span>   
717:         <span class="ruby-ivar">@format_dfmt32</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;07$$$&gt;&quot;</span>,<span class="ruby-ivar">@contract_name</span>,<span class="ruby-ivar">@format_dfmt32</span>)
718:        
719:         <span class="ruby-comment cmt">#助理</span>
720:         <span class="ruby-identifier">clerk_code</span> = <span class="ruby-constant">TbCase</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:first</span>,<span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">&quot;used = 'Y' and recevice_code = ?&quot;</span>,<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]]).<span class="ruby-identifier">clerk</span>
721:         <span class="ruby-identifier">clerk</span> = <span class="ruby-constant">User</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:first</span>,<span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">&quot;used = 'Y' and code = ?&quot;</span>,<span class="ruby-identifier">clerk_code</span>])
722:         <span class="ruby-ivar">@case_alerk</span> = <span class="ruby-identifier">clerk</span>.<span class="ruby-identifier">name</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">clerk</span>.<span class="ruby-identifier">sex</span>
723:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@case_alerk</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@case_alerk</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
724:             <span class="ruby-ivar">@case_alerk</span> = <span class="ruby-value str">&quot;no&quot;</span>
725:         <span class="ruby-keyword kw">end</span>       
726:         <span class="ruby-ivar">@format_dfmt32</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;09$$$&gt;&quot;</span>,<span class="ruby-ivar">@case_alerk</span>,<span class="ruby-ivar">@format_dfmt32</span>)  
727:         <span class="ruby-comment cmt">#电话        </span>
728:         <span class="ruby-ivar">@telephone</span> = <span class="ruby-identifier">clerk</span>.<span class="ruby-identifier">telephone</span>
729:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@telephone</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@telephone</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
730:             <span class="ruby-ivar">@telephone</span> = <span class="ruby-value str">&quot;no&quot;</span>
731:         <span class="ruby-keyword kw">end</span>     
732:         <span class="ruby-ivar">@format_dfmt32</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;10$$$&gt;&quot;</span>,<span class="ruby-ivar">@telephone</span>,<span class="ruby-ivar">@format_dfmt32</span>)       
733:         <span class="ruby-comment cmt">#传真</span>
734:         <span class="ruby-ivar">@fax</span> = <span class="ruby-identifier">clerk</span>.<span class="ruby-identifier">fax</span>
735:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@fax</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@fax</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
736:             <span class="ruby-ivar">@fax</span> = <span class="ruby-value str">&quot;no&quot;</span>
737:         <span class="ruby-keyword kw">end</span>    
738:         <span class="ruby-ivar">@format_dfmt32</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;11$$$&gt;&quot;</span>,<span class="ruby-ivar">@fax</span>,<span class="ruby-ivar">@format_dfmt32</span>)     
739:         <span class="ruby-comment cmt">#电子邮箱</span>
740:         <span class="ruby-ivar">@email</span> = <span class="ruby-identifier">clerk</span>.<span class="ruby-identifier">email</span>
741:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@email</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@email</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
742:             <span class="ruby-ivar">@email</span> = <span class="ruby-value str">&quot;no&quot;</span>
743:         <span class="ruby-keyword kw">end</span>  
744:         <span class="ruby-ivar">@format_dfmt32</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;12$$$&gt;&quot;</span>,<span class="ruby-ivar">@email</span>,<span class="ruby-ivar">@format_dfmt32</span>)    
745:         <span class="ruby-comment cmt">#日期</span>
746:         <span class="ruby-ivar">@date_of_letter</span> = <span class="ruby-constant">Time</span>.<span class="ruby-identifier">now</span>.<span class="ruby-identifier">to_s</span>(<span class="ruby-identifier">:db</span>)
747:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@date_of_letter</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@date_of_letter</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
748:             <span class="ruby-ivar">@date_of_letter</span> = <span class="ruby-value str">&quot;no&quot;</span>
749:             <span class="ruby-ivar">@format_dfmt32</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;13$$$&gt;&quot;</span>,<span class="ruby-ivar">@date_of_letter</span>,<span class="ruby-ivar">@format_dfmt32</span>) 
750:             <span class="ruby-ivar">@format_dfmt32</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;14$$$&gt;&quot;</span>,<span class="ruby-ivar">@date_of_letter</span>,<span class="ruby-ivar">@format_dfmt32</span>)
751:             <span class="ruby-ivar">@format_dfmt32</span> = <span class="ruby-identifier">add_last_record</span>(<span class="ruby-value str">&quot;&lt;15$$$&gt;&quot;</span>,<span class="ruby-ivar">@date_of_letter</span>,<span class="ruby-ivar">@format_dfmt32</span>)
752:         <span class="ruby-keyword kw">else</span>
753:             <span class="ruby-identifier">arr_date</span> = <span class="ruby-ivar">@date_of_letter</span>.<span class="ruby-identifier">to_s</span>.<span class="ruby-identifier">split</span>(<span class="ruby-value str">&quot;-&quot;</span>)
754:             <span class="ruby-ivar">@format_dfmt32</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;13$$$&gt;&quot;</span>,<span class="ruby-identifier">arr_date</span>[<span class="ruby-value">0</span>],<span class="ruby-ivar">@format_dfmt32</span>) 
755:             <span class="ruby-ivar">@format_dfmt32</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;14$$$&gt;&quot;</span>,<span class="ruby-identifier">arr_date</span>[<span class="ruby-value">1</span>],<span class="ruby-ivar">@format_dfmt32</span>)
756:             <span class="ruby-ivar">@format_dfmt32</span> = <span class="ruby-identifier">add_last_record</span>(<span class="ruby-value str">&quot;&lt;15$$$&gt;&quot;</span>,<span class="ruby-identifier">arr_date</span>[<span class="ruby-value">2</span>].<span class="ruby-identifier">slice</span>(<span class="ruby-value">0</span>, <span class="ruby-value">2</span>),<span class="ruby-ivar">@format_dfmt32</span>)            
757:         <span class="ruby-keyword kw">end</span>   
758:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000150" class="method-detail">
        <a name="M000150"></a>

        <div class="method-heading">
          <a href="#M000150" class="method-signature">
          <span class="method-name">format_letter_dfor03</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000150-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000150-source">
<pre>
     <span class="ruby-comment cmt"># File app/controllers/format_letter_controller.rb, line 760</span>
760:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">format_letter_dfor03</span>
761:         <span class="ruby-comment cmt">#拼接字串，初始化</span>
762:         <span class="ruby-ivar">@format_dfor03</span> = <span class="ruby-value str">&quot;&quot;</span>  
763:         <span class="ruby-comment cmt">#申请人</span>
764:         <span class="ruby-ivar">@applicants</span> = <span class="ruby-constant">TbParty</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:all</span>,<span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">&quot;used = 'Y' and partytype = 1 and recevice_code = ?&quot;</span>,<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]], <span class="ruby-identifier">:order</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;id&quot;</span>)
765:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@applicants</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@applicants</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
766:             <span class="ruby-ivar">@applicant</span> = <span class="ruby-value str">&quot;no&quot;</span>
767:         <span class="ruby-keyword kw">else</span>
768:             <span class="ruby-ivar">@applicant</span> = <span class="ruby-value str">&quot;&quot;</span>
769:             <span class="ruby-ivar">@applicants</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">applicant</span><span class="ruby-operator">|</span>
770:                 <span class="ruby-ivar">@applicant</span> = <span class="ruby-ivar">@applicant</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">applicant</span>.<span class="ruby-identifier">partyname</span>
771:             <span class="ruby-keyword kw">end</span>
772:         <span class="ruby-keyword kw">end</span>        
773:         <span class="ruby-ivar">@format_dfor03</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;01$$$&gt;&quot;</span>,<span class="ruby-ivar">@applicant</span>,<span class="ruby-ivar">@format_dfor03</span>)
774:         <span class="ruby-comment cmt">#被申请人</span>
775:         <span class="ruby-ivar">@respondents</span> = <span class="ruby-constant">TbParty</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:all</span>,<span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">&quot;used = 'Y' and partytype = 2 and recevice_code = ?&quot;</span>,<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]], <span class="ruby-identifier">:order</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;id&quot;</span>)
776:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@respondent</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@respondent</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
777:             <span class="ruby-ivar">@respondent</span> = <span class="ruby-value str">&quot;no&quot;</span>
778:         <span class="ruby-keyword kw">else</span>
779:             <span class="ruby-ivar">@respondent</span> = <span class="ruby-value str">&quot;&quot;</span>
780:             <span class="ruby-ivar">@respondents</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">resp</span><span class="ruby-operator">|</span>
781:                 <span class="ruby-ivar">@respondent</span> = <span class="ruby-ivar">@respondent</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">resp</span>.<span class="ruby-identifier">partyname</span>
782:             <span class="ruby-keyword kw">end</span>
783:         <span class="ruby-keyword kw">end</span>       
784:         <span class="ruby-ivar">@format_dfor03</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;02$$$&gt;&quot;</span>,<span class="ruby-ivar">@respondent</span>,<span class="ruby-ivar">@format_dfor03</span>)
785:         <span class="ruby-comment cmt">#案由及类别</span>
786:         <span class="ruby-ivar">@casetype_num</span> = <span class="ruby-constant">TbCase</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:first</span>, <span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">&quot;used = 'Y' and recevice_code = ?&quot;</span>,<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]])
787:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@casetype_num</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@casetype_num</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
788:             <span class="ruby-ivar">@casetype_num</span> = <span class="ruby-value str">&quot;no&quot;</span>
789:         <span class="ruby-keyword kw">else</span>
790:             <span class="ruby-ivar">@casetype</span> = <span class="ruby-constant">TbDictionary</span>.<span class="ruby-identifier">find_arbit_type</span>(<span class="ruby-value str">&quot;0002&quot;</span>,<span class="ruby-ivar">@casetype_num</span>).<span class="ruby-identifier">pactname</span>
791:         <span class="ruby-keyword kw">end</span>   
792:         <span class="ruby-ivar">@format_dfor03</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;03$$$&gt;&quot;</span>,<span class="ruby-ivar">@casetype</span>,<span class="ruby-ivar">@format_dfor03</span>)  
793:         <span class="ruby-comment cmt">#关于$$$项下争议的仲裁申请文件（合同名称）</span>
794:         <span class="ruby-ivar">@contract_name</span> = <span class="ruby-constant">TbContractsign</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:first</span>,<span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">&quot;used = 'Y' and recevice_code = ?&quot;</span>,<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]])
795:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@contract_name</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@contract_name</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
796:             <span class="ruby-ivar">@contract_name</span> = <span class="ruby-value str">&quot;no&quot;</span>
797:         <span class="ruby-keyword kw">else</span>
798:             <span class="ruby-ivar">@contract_name</span> = <span class="ruby-ivar">@contract_name</span>.<span class="ruby-identifier">pactname</span>
799:         <span class="ruby-keyword kw">end</span>   
800:         <span class="ruby-ivar">@format_dfor03</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;04$$$&gt;&quot;</span>,<span class="ruby-ivar">@contract_name</span>,<span class="ruby-ivar">@format_dfor03</span>)        
801:         <span class="ruby-comment cmt">#明确争议金额</span>
802:         <span class="ruby-ivar">@accounts</span> = <span class="ruby-constant">TbCaseAmount</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:all</span>,<span class="ruby-identifier">:conditions=</span><span class="ruby-operator">&gt;</span>[<span class="ruby-value str">&quot;recevice_code= ? and used='Y' and amount_typ= '0001'&quot;</span>,<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]],<span class="ruby-identifier">:order=</span><span class="ruby-operator">&gt;</span><span class="ruby-value str">'id'</span>)
803:         <span class="ruby-ivar">@sum</span> = <span class="ruby-value">0</span>
804:         <span class="ruby-keyword kw">for</span> <span class="ruby-identifier">account</span> <span class="ruby-keyword kw">in</span> <span class="ruby-ivar">@accounts</span>
805:             <span class="ruby-ivar">@sum</span> = <span class="ruby-ivar">@sum</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">account</span>.<span class="ruby-identifier">rmb_money</span>
806:         <span class="ruby-keyword kw">end</span>        
807:         <span class="ruby-ivar">@format_dfor03</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;05$$$&gt;&quot;</span>,<span class="ruby-ivar">@sum</span>,<span class="ruby-ivar">@format_dfor03</span>)            
808:         <span class="ruby-comment cmt">#被申请人受理费</span>
809:         <span class="ruby-ivar">@litigation_fee</span> = <span class="ruby-identifier">applicant_litigation_fee</span>(<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>])
810:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@litigation_fee</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@litigation_fee</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
811:             <span class="ruby-ivar">@litigation_fee</span> = <span class="ruby-value str">&quot;no&quot;</span>
812:         <span class="ruby-keyword kw">end</span>
813:         <span class="ruby-ivar">@format_dfor03</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;06$$$&gt;&quot;</span>,<span class="ruby-ivar">@litigation_fee</span>,<span class="ruby-ivar">@format_dfor03</span>)    
814:         <span class="ruby-comment cmt">#被申请人处理费</span>
815:         <span class="ruby-ivar">@processing_fee</span> = <span class="ruby-identifier">applicant_arbit_fee</span>(<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]) 
816:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@processing_fee</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@processing_fee</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
817:             <span class="ruby-ivar">@processing_fee</span> = <span class="ruby-value str">&quot;no&quot;</span>
818:         <span class="ruby-keyword kw">end</span>        
819:         <span class="ruby-ivar">@format_dfor03</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;07$$$&gt;&quot;</span>,<span class="ruby-ivar">@processing_fee</span>,<span class="ruby-ivar">@format_dfor03</span>) 
820:         <span class="ruby-comment cmt">#合计        </span>
821:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@litigation_fee</span> <span class="ruby-operator">!=</span> <span class="ruby-value str">&quot;no&quot;</span> <span class="ruby-keyword kw">and</span> <span class="ruby-ivar">@processing_fee</span> <span class="ruby-operator">!=</span> <span class="ruby-value str">&quot;no&quot;</span> 
822:             <span class="ruby-ivar">@total_fee</span> = <span class="ruby-ivar">@litigation_fee</span>.<span class="ruby-identifier">to_i</span> <span class="ruby-operator">+</span> <span class="ruby-ivar">@processing_fee</span>.<span class="ruby-identifier">to_i</span>
823:         <span class="ruby-keyword kw">else</span>
824:             <span class="ruby-ivar">@total_fee</span> = <span class="ruby-value str">&quot;no&quot;</span>
825:         <span class="ruby-keyword kw">end</span>
826:         <span class="ruby-ivar">@format_dfor03</span> = <span class="ruby-identifier">add_last_record</span>(<span class="ruby-value str">&quot;&lt;08$$$&gt;&quot;</span>,<span class="ruby-ivar">@total_fee</span>,<span class="ruby-ivar">@format_dfor03</span>)           
827:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000151" class="method-detail">
        <a name="M000151"></a>

        <div class="method-heading">
          <a href="#M000151" class="method-signature">
          <span class="method-name">format_letter_fmt04</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000151-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000151-source">
<pre>
     <span class="ruby-comment cmt"># File app/controllers/format_letter_controller.rb, line 829</span>
829:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">format_letter_fmt04</span>
830:         <span class="ruby-comment cmt">#拼接字串，初始化</span>
831:         <span class="ruby-ivar">@format_fmt04</span> = <span class="ruby-value str">&quot;&quot;</span>  
832:         <span class="ruby-comment cmt">#函号</span>
833:         <span class="ruby-ivar">@file_code</span> = <span class="ruby-constant">TbDoc</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:first</span>,<span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">&quot;used = 'Y' and recevice_code = ?&quot;</span>,<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]])
834:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@file_code</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@file_code</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
835:             <span class="ruby-ivar">@file_code</span> = <span class="ruby-value str">&quot;no&quot;</span>
836:         <span class="ruby-keyword kw">else</span>
837:             <span class="ruby-ivar">@file_code</span> = <span class="ruby-ivar">@file_code</span>.<span class="ruby-identifier">file_code</span>
838:         <span class="ruby-keyword kw">end</span>
839:         <span class="ruby-ivar">@format_fmt04</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;01$$$&gt;&quot;</span>,<span class="ruby-ivar">@file_code</span>,<span class="ruby-ivar">@format_fmt04</span>)
840:         <span class="ruby-comment cmt">#申请人</span>
841:         <span class="ruby-ivar">@applicants</span> = <span class="ruby-constant">TbParty</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:all</span>,<span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">&quot;used = 'Y' and partytype = 1 and recevice_code = ?&quot;</span>,<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]], <span class="ruby-identifier">:order</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;id&quot;</span>)
842:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@applicants</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@applicants</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
843:             <span class="ruby-ivar">@applicant</span> = <span class="ruby-value str">&quot;no&quot;</span>
844:         <span class="ruby-keyword kw">else</span>
845:             <span class="ruby-ivar">@applicant</span> = <span class="ruby-value str">&quot;&quot;</span>
846:             <span class="ruby-ivar">@applicants</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">applicant</span><span class="ruby-operator">|</span>
847:                 <span class="ruby-ivar">@applicant</span> = <span class="ruby-ivar">@applicant</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">applicant</span>.<span class="ruby-identifier">partyname</span>
848:             <span class="ruby-keyword kw">end</span>
849:         <span class="ruby-keyword kw">end</span>       
850:         <span class="ruby-ivar">@format_fmt04</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;02$$$&gt;&quot;</span>,<span class="ruby-ivar">@applicant</span>,<span class="ruby-ivar">@format_fmt04</span>)  
851:         <span class="ruby-ivar">@format_fmt04</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;03$$$&gt;&quot;</span>,<span class="ruby-ivar">@applicant</span>,<span class="ruby-ivar">@format_fmt04</span>)
852:         <span class="ruby-comment cmt">#受理日期</span>
853:         <span class="ruby-ivar">@date_receive</span> = <span class="ruby-constant">TbCase</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:first</span>,<span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">&quot;used = 'Y' and recevice_code = ?&quot;</span>,<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]]).<span class="ruby-identifier">receivedate</span>
854:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@date_receive</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@date_receive</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
855:             <span class="ruby-ivar">@date_receive</span> = <span class="ruby-value str">&quot;no&quot;</span>
856:             <span class="ruby-ivar">@format_fmt04</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;04$$$&gt;&quot;</span>,<span class="ruby-ivar">@date_receive</span>,<span class="ruby-ivar">@format_fmt04</span>) 
857:             <span class="ruby-ivar">@format_fmt04</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;05$$$&gt;&quot;</span>,<span class="ruby-ivar">@date_receive</span>,<span class="ruby-ivar">@format_fmt04</span>)
858:             <span class="ruby-ivar">@format_fmt04</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;06$$$&gt;&quot;</span>,<span class="ruby-ivar">@date_receive</span>,<span class="ruby-ivar">@format_fmt04</span>)
859:         <span class="ruby-keyword kw">else</span>
860:             <span class="ruby-identifier">arr_date</span> = <span class="ruby-ivar">@date_receive</span>.<span class="ruby-identifier">to_s</span>.<span class="ruby-identifier">split</span>(<span class="ruby-value str">&quot;-&quot;</span>)
861:             <span class="ruby-ivar">@format_fmt04</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;04$$$&gt;&quot;</span>,<span class="ruby-identifier">arr_date</span>[<span class="ruby-value">0</span>],<span class="ruby-ivar">@format_fmt04</span>) 
862:             <span class="ruby-ivar">@format_fmt04</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;05$$$&gt;&quot;</span>,<span class="ruby-identifier">arr_date</span>[<span class="ruby-value">1</span>],<span class="ruby-ivar">@format_fmt04</span>)
863:             <span class="ruby-ivar">@format_fmt04</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;06$$$&gt;&quot;</span>,<span class="ruby-identifier">arr_date</span>[<span class="ruby-value">2</span>],<span class="ruby-ivar">@format_fmt04</span>)            
864:         <span class="ruby-keyword kw">end</span>     
865: 
866:         <span class="ruby-comment cmt">#被申请人</span>
867:         <span class="ruby-ivar">@respondents</span> = <span class="ruby-constant">TbParty</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:all</span>,<span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">&quot;used = 'Y' and partytype = 2 and recevice_code = ?&quot;</span>,<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]], <span class="ruby-identifier">:order</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;id&quot;</span>)
868:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@respondent</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@respondent</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
869:             <span class="ruby-ivar">@respondent</span> = <span class="ruby-value str">&quot;no&quot;</span>
870:         <span class="ruby-keyword kw">else</span>
871:             <span class="ruby-ivar">@respondent</span> = <span class="ruby-value str">&quot;&quot;</span>
872:             <span class="ruby-ivar">@respondents</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">resp</span><span class="ruby-operator">|</span>
873:                 <span class="ruby-ivar">@respondent</span> = <span class="ruby-ivar">@respondent</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">resp</span>.<span class="ruby-identifier">partyname</span>
874:             <span class="ruby-keyword kw">end</span>
875:         <span class="ruby-keyword kw">end</span>       
876:         <span class="ruby-ivar">@format_fmt04</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;07$$$&gt;&quot;</span>,<span class="ruby-ivar">@respondent</span>,<span class="ruby-ivar">@format_fmt04</span>)
877:         <span class="ruby-comment cmt">#关于$$$项下争议的仲裁申请文件（合同名称）</span>
878:         <span class="ruby-ivar">@contract_name</span> = <span class="ruby-constant">TbContractsign</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:first</span>,<span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">&quot;used = 'Y' and recevice_code = ?&quot;</span>,<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]])
879:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@contract_name</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@contract_name</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
880:             <span class="ruby-ivar">@contract_name</span> = <span class="ruby-value str">&quot;no&quot;</span>
881:         <span class="ruby-keyword kw">else</span>
882:             <span class="ruby-ivar">@contract_name</span> = <span class="ruby-ivar">@contract_name</span>.<span class="ruby-identifier">pactname</span>
883:         <span class="ruby-keyword kw">end</span>   
884:         <span class="ruby-ivar">@format_fmt04</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;08$$$&gt;&quot;</span>,<span class="ruby-ivar">@contract_name</span>,<span class="ruby-ivar">@format_fmt04</span>)
885:         <span class="ruby-comment cmt">#仲裁费</span>
886:         <span class="ruby-ivar">@arbit_fee</span> = <span class="ruby-identifier">applicant_arbit_fee</span>(<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>])
887:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@arbit_fee</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@arbit_fee</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
888:             <span class="ruby-ivar">@arbit_fee</span> = <span class="ruby-value str">&quot;no&quot;</span>
889:         <span class="ruby-keyword kw">end</span>
890:         <span class="ruby-ivar">@format_fmt04</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;09$$$&gt;&quot;</span>,<span class="ruby-ivar">@arbit_fee</span>,<span class="ruby-ivar">@format_fmt04</span>)         
891:         <span class="ruby-comment cmt">#受理费</span>
892:         <span class="ruby-ivar">@litigation_fee</span> = <span class="ruby-identifier">applicant_litigation_fee</span>(<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>])
893:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@litigation_fee</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@litigation_fee</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
894:             <span class="ruby-ivar">@litigation_fee</span> = <span class="ruby-value str">&quot;no&quot;</span>
895:         <span class="ruby-keyword kw">end</span>
896:         <span class="ruby-ivar">@format_fmt04</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;10$$$&gt;&quot;</span>,<span class="ruby-ivar">@litigation_fee</span>,<span class="ruby-ivar">@format_fmt04</span>)    
897:         <span class="ruby-comment cmt">#处理费</span>
898:         <span class="ruby-ivar">@processing_fee</span> = <span class="ruby-identifier">applicant_arbit_fee</span>(<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]) 
899:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@processing_fee</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@processing_fee</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
900:             <span class="ruby-ivar">@processing_fee</span> = <span class="ruby-value str">&quot;no&quot;</span>
901:         <span class="ruby-keyword kw">end</span>        
902:         <span class="ruby-ivar">@format_fmt04</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;11$$$&gt;&quot;</span>,<span class="ruby-ivar">@processing_fee</span>,<span class="ruby-ivar">@format_fmt04</span>)     
903:         <span class="ruby-comment cmt">#合计</span>
904:         <span class="ruby-ivar">@total_fee</span> = <span class="ruby-ivar">@litigation_fee</span> <span class="ruby-operator">+</span> <span class="ruby-ivar">@processing_fee</span> <span class="ruby-operator">+</span> <span class="ruby-ivar">@arbit_fee</span>
905:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@litigation_fee</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;no&quot;</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@processing_fee</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;no&quot;</span>
906:             <span class="ruby-ivar">@total_fee</span> = <span class="ruby-value str">&quot;no&quot;</span>
907:         <span class="ruby-keyword kw">end</span>
908:         <span class="ruby-ivar">@format_fmt04</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;12$$$&gt;&quot;</span>,<span class="ruby-ivar">@total_fee</span>,<span class="ruby-ivar">@format_fmt04</span>)        
909:         <span class="ruby-comment cmt">#助理</span>
910:         <span class="ruby-identifier">clerk_code</span> = <span class="ruby-constant">TbCase</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:first</span>,<span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">&quot;used = 'Y' and recevice_code = ?&quot;</span>,<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]]).<span class="ruby-identifier">clerk</span>
911:         <span class="ruby-identifier">clerk</span> = <span class="ruby-constant">User</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:first</span>,<span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">&quot;used = 'Y' and code = ?&quot;</span>,<span class="ruby-identifier">clerk_code</span>])
912:         <span class="ruby-ivar">@case_alerk</span> = <span class="ruby-identifier">clerk</span>.<span class="ruby-identifier">name</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">clerk</span>.<span class="ruby-identifier">sex</span>
913:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@case_alerk</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@case_alerk</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
914:             <span class="ruby-ivar">@case_alerk</span> = <span class="ruby-value str">&quot;no&quot;</span>
915:         <span class="ruby-keyword kw">end</span>       
916:         <span class="ruby-ivar">@format_fmt04</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;13$$$&gt;&quot;</span>,<span class="ruby-ivar">@case_alerk</span>,<span class="ruby-ivar">@format_fmt04</span>)  
917:         <span class="ruby-comment cmt">#电话        </span>
918:         <span class="ruby-ivar">@telephone</span> = <span class="ruby-identifier">clerk</span>.<span class="ruby-identifier">telephone</span>
919:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@telephone</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@telephone</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
920:             <span class="ruby-ivar">@telephone</span> = <span class="ruby-value str">&quot;no&quot;</span>
921:         <span class="ruby-keyword kw">end</span>     
922:         <span class="ruby-ivar">@format_fmt04</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;14$$$&gt;&quot;</span>,<span class="ruby-ivar">@telephone</span>,<span class="ruby-ivar">@format_fmt04</span>)       
923:         <span class="ruby-comment cmt">#传真</span>
924:         <span class="ruby-ivar">@fax</span> = <span class="ruby-identifier">clerk</span>.<span class="ruby-identifier">fax</span>
925:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@fax</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@fax</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
926:             <span class="ruby-ivar">@fax</span> = <span class="ruby-value str">&quot;no&quot;</span>
927:         <span class="ruby-keyword kw">end</span>    
928:         <span class="ruby-ivar">@format_fmt04</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;15$$$&gt;&quot;</span>,<span class="ruby-ivar">@fax</span>,<span class="ruby-ivar">@format_fmt04</span>)     
929:         <span class="ruby-comment cmt">#电子邮箱</span>
930:         <span class="ruby-ivar">@email</span> = <span class="ruby-identifier">clerk</span>.<span class="ruby-identifier">email</span>
931:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@email</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@email</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
932:             <span class="ruby-ivar">@email</span> = <span class="ruby-value str">&quot;no&quot;</span>
933:         <span class="ruby-keyword kw">end</span>  
934:         <span class="ruby-ivar">@format_fmt04</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;16$$$&gt;&quot;</span>,<span class="ruby-ivar">@email</span>,<span class="ruby-ivar">@format_fmt04</span>)    
935:         <span class="ruby-comment cmt">#日期</span>
936:         <span class="ruby-ivar">@date_of_letter</span> = <span class="ruby-constant">Time</span>.<span class="ruby-identifier">now</span>.<span class="ruby-identifier">to_s</span>(<span class="ruby-identifier">:db</span>)
937:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@date_of_letter</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@date_of_letter</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
938:             <span class="ruby-ivar">@date_of_letter</span> = <span class="ruby-value str">&quot;no&quot;</span>
939:             <span class="ruby-ivar">@format_fmt04</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;17$$$&gt;&quot;</span>,<span class="ruby-ivar">@date_of_letter</span>,<span class="ruby-ivar">@format_fmt04</span>) 
940:             <span class="ruby-ivar">@format_fmt04</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;18$$$&gt;&quot;</span>,<span class="ruby-ivar">@date_of_letter</span>,<span class="ruby-ivar">@format_fmt04</span>)
941:             <span class="ruby-ivar">@format_fmt04</span> = <span class="ruby-identifier">add_last_record</span>(<span class="ruby-value str">&quot;&lt;19$$$&gt;&quot;</span>,<span class="ruby-ivar">@date_of_letter</span>,<span class="ruby-ivar">@format_fmt04</span>)
942:         <span class="ruby-keyword kw">else</span>
943:             <span class="ruby-identifier">arr_date</span> = <span class="ruby-ivar">@date_of_letter</span>.<span class="ruby-identifier">to_s</span>.<span class="ruby-identifier">split</span>(<span class="ruby-value str">&quot;-&quot;</span>)
944:             <span class="ruby-ivar">@format_fmt04</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;17$$$&gt;&quot;</span>,<span class="ruby-identifier">arr_date</span>[<span class="ruby-value">0</span>],<span class="ruby-ivar">@format_fmt04</span>) 
945:             <span class="ruby-ivar">@format_fmt04</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;18$$$&gt;&quot;</span>,<span class="ruby-identifier">arr_date</span>[<span class="ruby-value">1</span>],<span class="ruby-ivar">@format_fmt04</span>)
946:             <span class="ruby-ivar">@format_fmt04</span> = <span class="ruby-identifier">add_last_record</span>(<span class="ruby-value str">&quot;&lt;19$$$&gt;&quot;</span>,<span class="ruby-identifier">arr_date</span>[<span class="ruby-value">2</span>].<span class="ruby-identifier">slice</span>(<span class="ruby-value">0</span>, <span class="ruby-value">2</span>),<span class="ruby-ivar">@format_fmt04</span>)            
947:         <span class="ruby-keyword kw">end</span>           
948:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000152" class="method-detail">
        <a name="M000152"></a>

        <div class="method-heading">
          <a href="#M000152" class="method-signature">
          <span class="method-name">format_letter_fmt05</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000152-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000152-source">
<pre>
      <span class="ruby-comment cmt"># File app/controllers/format_letter_controller.rb, line 950</span>
 950:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">format_letter_fmt05</span>
 951:         <span class="ruby-comment cmt">#拼接字串，初始化</span>
 952:         <span class="ruby-ivar">@format_fmt05</span> = <span class="ruby-value str">&quot;&quot;</span>  
 953:         <span class="ruby-comment cmt">#函号</span>
 954:         <span class="ruby-ivar">@file_code</span> = <span class="ruby-constant">TbDoc</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:first</span>,<span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">&quot;used = 'Y' and recevice_code = ?&quot;</span>,<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]])
 955:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@file_code</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@file_code</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
 956:             <span class="ruby-ivar">@file_code</span> = <span class="ruby-value str">&quot;no&quot;</span>
 957:         <span class="ruby-keyword kw">else</span>
 958:             <span class="ruby-ivar">@file_code</span> = <span class="ruby-ivar">@file_code</span>.<span class="ruby-identifier">file_code</span>
 959:         <span class="ruby-keyword kw">end</span>
 960:         <span class="ruby-ivar">@format_fmt05</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;01$$$&gt;&quot;</span>,<span class="ruby-ivar">@file_code</span>,<span class="ruby-ivar">@format_fmt05</span>)
 961:         <span class="ruby-comment cmt">#立案号</span>
 962:         <span class="ruby-ivar">@case_code</span> = <span class="ruby-constant">TbCase</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:first</span>, <span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">&quot;used = 'Y' and recevice_code = ?&quot;</span>,<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]]).<span class="ruby-identifier">case_code</span>
 963:         <span class="ruby-ivar">@format_fmt05</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;02$$$&gt;&quot;</span>,<span class="ruby-ivar">@case_code</span>,<span class="ruby-ivar">@format_fmt05</span>) 
 964:         <span class="ruby-ivar">@format_fmt05</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;06$$$&gt;&quot;</span>,<span class="ruby-ivar">@case_code</span>,<span class="ruby-ivar">@format_fmt05</span>)
 965:         <span class="ruby-comment cmt">#被申请人</span>
 966:         <span class="ruby-ivar">@respondents</span> = <span class="ruby-constant">TbParty</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:all</span>,<span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">&quot;used = 'Y' and partytype = 2 and recevice_code = ?&quot;</span>,<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]], <span class="ruby-identifier">:order</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;id&quot;</span>)
 967:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@respondent</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@respondent</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
 968:             <span class="ruby-ivar">@respondent</span> = <span class="ruby-value str">&quot;no&quot;</span>
 969:         <span class="ruby-keyword kw">else</span>
 970:             <span class="ruby-ivar">@respondent</span> = <span class="ruby-value str">&quot;&quot;</span>
 971:             <span class="ruby-ivar">@respondents</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">resp</span><span class="ruby-operator">|</span>
 972:                 <span class="ruby-ivar">@respondent</span> = <span class="ruby-ivar">@respondent</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">resp</span>.<span class="ruby-identifier">partyname</span>
 973:             <span class="ruby-keyword kw">end</span>
 974:         <span class="ruby-keyword kw">end</span>   
 975:         <span class="ruby-ivar">@format_fmt05</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;03$$$&gt;&quot;</span>,<span class="ruby-ivar">@respondent</span>,<span class="ruby-ivar">@format_fmt05</span>)
 976:         <span class="ruby-comment cmt">#申请人</span>
 977:         <span class="ruby-ivar">@applicants</span> = <span class="ruby-constant">TbParty</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:all</span>,<span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">&quot;used = 'Y' and partytype = 1 and recevice_code = ?&quot;</span>,<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]], <span class="ruby-identifier">:order</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;id&quot;</span>)
 978:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@applicants</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@applicants</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
 979:             <span class="ruby-ivar">@applicant</span> = <span class="ruby-value str">&quot;no&quot;</span>
 980:         <span class="ruby-keyword kw">else</span>
 981:             <span class="ruby-ivar">@applicant</span> = <span class="ruby-value str">&quot;&quot;</span>
 982:             <span class="ruby-ivar">@applicants</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">applicant</span><span class="ruby-operator">|</span>
 983:                 <span class="ruby-ivar">@applicant</span> = <span class="ruby-ivar">@applicant</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">applicant</span>.<span class="ruby-identifier">partyname</span>
 984:             <span class="ruby-keyword kw">end</span>
 985:         <span class="ruby-keyword kw">end</span>       
 986:         <span class="ruby-ivar">@format_fmt05</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;04$$$&gt;&quot;</span>,<span class="ruby-ivar">@applicant</span>,<span class="ruby-ivar">@format_fmt05</span>) 
 987:         <span class="ruby-comment cmt">#签订的$$$所引起的争议（合同名称）</span>
 988:         <span class="ruby-ivar">@contract_name</span> = <span class="ruby-constant">TbContractsign</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:first</span>,<span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">&quot;used = 'Y' and recevice_code = ?&quot;</span>,<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]])
 989:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@contract_name</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@contract_name</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
 990:             <span class="ruby-ivar">@contract_name</span> = <span class="ruby-value str">&quot;no&quot;</span>
 991:         <span class="ruby-keyword kw">else</span>
 992:             <span class="ruby-ivar">@contract_name</span> = <span class="ruby-ivar">@contract_name</span>.<span class="ruby-identifier">pactname</span>
 993:         <span class="ruby-keyword kw">end</span>   
 994:         <span class="ruby-ivar">@format_fmt05</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;05$$$&gt;&quot;</span>,<span class="ruby-ivar">@contract_name</span>,<span class="ruby-ivar">@format_fmt05</span>)
 995:         <span class="ruby-comment cmt">#文件份数</span>
 996:         <span class="ruby-ivar">@copies</span> = <span class="ruby-identifier">num_papers</span>(<span class="ruby-ivar">@applicants</span>.<span class="ruby-identifier">size</span>)
 997:         <span class="ruby-ivar">@format_fmt05</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;07$$$&gt;&quot;</span>,<span class="ruby-ivar">@copies</span>,<span class="ruby-ivar">@format_fmt05</span>) 
 998:         <span class="ruby-ivar">@format_fmt05</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;08$$$&gt;&quot;</span>,<span class="ruby-ivar">@copies</span>,<span class="ruby-ivar">@format_fmt05</span>)
 999:         <span class="ruby-ivar">@format_fmt05</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;09$$$&gt;&quot;</span>,<span class="ruby-ivar">@copies</span>,<span class="ruby-ivar">@format_fmt05</span>)                       
1000:         <span class="ruby-comment cmt">#助理</span>
1001:         <span class="ruby-identifier">clerk_code</span> = <span class="ruby-constant">TbCase</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:first</span>,<span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">&quot;used = 'Y' and recevice_code = ?&quot;</span>,<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]]).<span class="ruby-identifier">clerk</span>
1002:         <span class="ruby-identifier">clerk</span> = <span class="ruby-constant">User</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:first</span>,<span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">&quot;used = 'Y' and code = ?&quot;</span>,<span class="ruby-identifier">clerk_code</span>])
1003:         <span class="ruby-ivar">@case_alerk</span> = <span class="ruby-identifier">clerk</span>.<span class="ruby-identifier">name</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">clerk</span>.<span class="ruby-identifier">sex</span>
1004:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@case_alerk</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@case_alerk</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
1005:             <span class="ruby-ivar">@case_alerk</span> = <span class="ruby-value str">&quot;no&quot;</span>
1006:         <span class="ruby-keyword kw">end</span>       
1007:         <span class="ruby-ivar">@format_fmt05</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;10$$$&gt;&quot;</span>,<span class="ruby-ivar">@case_alerk</span>,<span class="ruby-ivar">@format_fmt05</span>)  
1008:         <span class="ruby-comment cmt">#电话        </span>
1009:         <span class="ruby-ivar">@telephone</span> = <span class="ruby-identifier">clerk</span>.<span class="ruby-identifier">telephone</span>
1010:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@telephone</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@telephone</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
1011:             <span class="ruby-ivar">@telephone</span> = <span class="ruby-value str">&quot;no&quot;</span>
1012:         <span class="ruby-keyword kw">end</span>     
1013:         <span class="ruby-ivar">@format_fmt05</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;11$$$&gt;&quot;</span>,<span class="ruby-ivar">@telephone</span>,<span class="ruby-ivar">@format_fmt05</span>)       
1014:         <span class="ruby-comment cmt">#传真</span>
1015:         <span class="ruby-ivar">@fax</span> = <span class="ruby-identifier">clerk</span>.<span class="ruby-identifier">fax</span>
1016:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@fax</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@fax</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
1017:             <span class="ruby-ivar">@fax</span> = <span class="ruby-value str">&quot;no&quot;</span>
1018:         <span class="ruby-keyword kw">end</span>    
1019:         <span class="ruby-ivar">@format_fmt05</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;12$$$&gt;&quot;</span>,<span class="ruby-ivar">@fax</span>,<span class="ruby-ivar">@format_fmt05</span>)     
1020:         <span class="ruby-comment cmt">#电子邮箱</span>
1021:         <span class="ruby-ivar">@email</span> = <span class="ruby-identifier">clerk</span>.<span class="ruby-identifier">email</span>
1022:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@email</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@email</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
1023:             <span class="ruby-ivar">@email</span> = <span class="ruby-value str">&quot;no&quot;</span>
1024:         <span class="ruby-keyword kw">end</span>  
1025:         <span class="ruby-ivar">@format_fmt05</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;13$$$&gt;&quot;</span>,<span class="ruby-ivar">@email</span>,<span class="ruby-ivar">@format_fmt05</span>)    
1026:         <span class="ruby-comment cmt">#日期</span>
1027:         <span class="ruby-ivar">@date_of_letter</span> = <span class="ruby-constant">Time</span>.<span class="ruby-identifier">now</span>.<span class="ruby-identifier">to_s</span>(<span class="ruby-identifier">:db</span>)
1028:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@date_of_letter</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@date_of_letter</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
1029:             <span class="ruby-ivar">@date_of_letter</span> = <span class="ruby-value str">&quot;no&quot;</span>
1030:             <span class="ruby-ivar">@format_fmt05</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;14$$$&gt;&quot;</span>,<span class="ruby-ivar">@date_of_letter</span>,<span class="ruby-ivar">@format_fmt05</span>) 
1031:             <span class="ruby-ivar">@format_fmt05</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;15$$$&gt;&quot;</span>,<span class="ruby-ivar">@date_of_letter</span>,<span class="ruby-ivar">@format_fmt05</span>)
1032:             <span class="ruby-ivar">@format_fmt05</span> = <span class="ruby-identifier">add_last_record</span>(<span class="ruby-value str">&quot;&lt;16$$$&gt;&quot;</span>,<span class="ruby-ivar">@date_of_letter</span>,<span class="ruby-ivar">@format_fmt05</span>)
1033:         <span class="ruby-keyword kw">else</span>
1034:             <span class="ruby-identifier">arr_date</span> = <span class="ruby-ivar">@date_of_letter</span>.<span class="ruby-identifier">to_s</span>.<span class="ruby-identifier">split</span>(<span class="ruby-value str">&quot;-&quot;</span>)
1035:             <span class="ruby-ivar">@format_fmt05</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;14$$$&gt;&quot;</span>,<span class="ruby-identifier">arr_date</span>[<span class="ruby-value">0</span>],<span class="ruby-ivar">@format_fmt05</span>) 
1036:             <span class="ruby-ivar">@format_fmt05</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;15$$$&gt;&quot;</span>,<span class="ruby-identifier">arr_date</span>[<span class="ruby-value">1</span>],<span class="ruby-ivar">@format_fmt05</span>)
1037:             <span class="ruby-ivar">@format_fmt05</span> = <span class="ruby-identifier">add_last_record</span>(<span class="ruby-value str">&quot;&lt;16$$$&gt;&quot;</span>,<span class="ruby-identifier">arr_date</span>[<span class="ruby-value">2</span>].<span class="ruby-identifier">slice</span>(<span class="ruby-value">0</span>, <span class="ruby-value">2</span>),<span class="ruby-ivar">@format_fmt05</span>)            
1038:         <span class="ruby-keyword kw">end</span>          
1039:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000153" class="method-detail">
        <a name="M000153"></a>

        <div class="method-heading">
          <a href="#M000153" class="method-signature">
          <span class="method-name">format_letter_fmt06</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000153-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000153-source">
<pre>
      <span class="ruby-comment cmt"># File app/controllers/format_letter_controller.rb, line 1041</span>
1041:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">format_letter_fmt06</span>
1042:         <span class="ruby-comment cmt">#拼接字串，初始化</span>
1043:         <span class="ruby-ivar">@format_fmt06</span> = <span class="ruby-value str">&quot;&quot;</span>  
1044:         <span class="ruby-comment cmt">#函号</span>
1045:         <span class="ruby-ivar">@file_code</span> = <span class="ruby-constant">TbDoc</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:first</span>,<span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">&quot;used = 'Y' and recevice_code = ?&quot;</span>,<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]])
1046:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@file_code</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@file_code</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
1047:             <span class="ruby-ivar">@file_code</span> = <span class="ruby-value str">&quot;no&quot;</span>
1048:         <span class="ruby-keyword kw">else</span>
1049:             <span class="ruby-ivar">@file_code</span> = <span class="ruby-ivar">@file_code</span>.<span class="ruby-identifier">file_code</span>
1050:         <span class="ruby-keyword kw">end</span>
1051:         <span class="ruby-ivar">@format_fmt06</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;01$$$&gt;&quot;</span>,<span class="ruby-ivar">@file_code</span>,<span class="ruby-ivar">@format_fmt06</span>)
1052:         <span class="ruby-comment cmt">#立案号</span>
1053:         <span class="ruby-ivar">@case_code</span> = <span class="ruby-constant">TbCase</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:first</span>, <span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">&quot;used = 'Y' and recevice_code = ?&quot;</span>,<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]]).<span class="ruby-identifier">case_code</span>
1054:         <span class="ruby-ivar">@format_fmt06</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;02$$$&gt;&quot;</span>,<span class="ruby-ivar">@case_code</span>,<span class="ruby-ivar">@format_fmt06</span>)  
1055:         <span class="ruby-ivar">@format_fmt06</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;08$$$&gt;&quot;</span>,<span class="ruby-ivar">@case_code</span>,<span class="ruby-ivar">@format_fmt06</span>)
1056:         <span class="ruby-comment cmt">#申请人</span>
1057:         <span class="ruby-ivar">@applicants</span> = <span class="ruby-constant">TbParty</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:all</span>,<span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">&quot;used = 'Y' and partytype = 1 and recevice_code = ?&quot;</span>,<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]], <span class="ruby-identifier">:order</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;id&quot;</span>)
1058:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@applicants</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@applicants</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
1059:             <span class="ruby-ivar">@applicant</span> = <span class="ruby-value str">&quot;no&quot;</span>
1060:         <span class="ruby-keyword kw">else</span>
1061:             <span class="ruby-ivar">@applicant</span> = <span class="ruby-value str">&quot;&quot;</span>
1062:             <span class="ruby-ivar">@applicants</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">applicant</span><span class="ruby-operator">|</span>
1063:                 <span class="ruby-ivar">@applicant</span> = <span class="ruby-ivar">@applicant</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">applicant</span>.<span class="ruby-identifier">partyname</span>
1064:             <span class="ruby-keyword kw">end</span>
1065:         <span class="ruby-keyword kw">end</span>        
1066:         <span class="ruby-ivar">@format_fmt06</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;03$$$&gt;&quot;</span>,<span class="ruby-ivar">@applicant</span>,<span class="ruby-ivar">@format_fmt06</span>)
1067:         <span class="ruby-comment cmt">#被申请人</span>
1068:         <span class="ruby-ivar">@respondents</span> = <span class="ruby-constant">TbParty</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:all</span>,<span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">&quot;used = 'Y' and partytype = 2 and recevice_code = ?&quot;</span>,<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]], <span class="ruby-identifier">:order</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;id&quot;</span>)
1069:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@respondent</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@respondent</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
1070:             <span class="ruby-ivar">@respondent</span> = <span class="ruby-value str">&quot;no&quot;</span>
1071:         <span class="ruby-keyword kw">else</span>
1072:             <span class="ruby-ivar">@respondent</span> = <span class="ruby-value str">&quot;&quot;</span>
1073:             <span class="ruby-ivar">@respondents</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">resp</span><span class="ruby-operator">|</span>
1074:                 <span class="ruby-ivar">@respondent</span> = <span class="ruby-ivar">@respondent</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">resp</span>.<span class="ruby-identifier">partyname</span>
1075:             <span class="ruby-keyword kw">end</span>
1076:         <span class="ruby-keyword kw">end</span>       
1077:         <span class="ruby-ivar">@format_fmt06</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;04$$$&gt;&quot;</span>,<span class="ruby-ivar">@respondent</span>,<span class="ruby-ivar">@format_fmt06</span>)
1078:         <span class="ruby-comment cmt">#文件份数</span>
1079:         <span class="ruby-ivar">@copies</span> = <span class="ruby-identifier">num_papers</span>(<span class="ruby-ivar">@respondents</span>.<span class="ruby-identifier">size</span>)
1080:         <span class="ruby-ivar">@format_fmt06</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;05$$$&gt;&quot;</span>,<span class="ruby-ivar">@copies</span>,<span class="ruby-ivar">@format_fmt06</span>)  
1081:         <span class="ruby-comment cmt">#仲裁费</span>
1082:         <span class="ruby-ivar">@arbit_fee</span> = <span class="ruby-identifier">applicant_arbit_fee</span>(<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]) 
1083:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@arbit_fee</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@arbit_fee</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
1084:             <span class="ruby-ivar">@arbit_fee</span> = <span class="ruby-value str">&quot;no&quot;</span>
1085:         <span class="ruby-keyword kw">end</span>        
1086:         <span class="ruby-ivar">@format_fmt06</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;06$$$&gt;&quot;</span>,<span class="ruby-ivar">@arbit_fee</span>,<span class="ruby-ivar">@format_fmt06</span>)           
1087:         <span class="ruby-comment cmt">#关于$$$项下争议的仲裁申请文件（合同名称）</span>
1088:         <span class="ruby-ivar">@contract_name</span> = <span class="ruby-constant">TbContractsign</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:first</span>,<span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">&quot;used = 'Y' and recevice_code = ?&quot;</span>,<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]])
1089:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@contract_name</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@contract_name</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
1090:             <span class="ruby-ivar">@contract_name</span> = <span class="ruby-value str">&quot;no&quot;</span>
1091:         <span class="ruby-keyword kw">else</span>
1092:             <span class="ruby-ivar">@contract_name</span> = <span class="ruby-ivar">@contract_name</span>.<span class="ruby-identifier">pactname</span>
1093:         <span class="ruby-keyword kw">end</span>   
1094:         <span class="ruby-ivar">@format_fmt06</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;07$$$&gt;&quot;</span>,<span class="ruby-ivar">@contract_name</span>,<span class="ruby-ivar">@format_fmt06</span>)
1095:        
1096:         <span class="ruby-comment cmt">#助理</span>
1097:         <span class="ruby-identifier">clerk_code</span> = <span class="ruby-constant">TbCase</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:first</span>,<span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">&quot;used = 'Y' and recevice_code = ?&quot;</span>,<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]]).<span class="ruby-identifier">clerk</span>
1098:         <span class="ruby-identifier">clerk</span> = <span class="ruby-constant">User</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:first</span>,<span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">&quot;used = 'Y' and code = ?&quot;</span>,<span class="ruby-identifier">clerk_code</span>])
1099:         <span class="ruby-ivar">@case_alerk</span> = <span class="ruby-identifier">clerk</span>.<span class="ruby-identifier">name</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">clerk</span>.<span class="ruby-identifier">sex</span>
1100:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@case_alerk</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@case_alerk</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
1101:             <span class="ruby-ivar">@case_alerk</span> = <span class="ruby-value str">&quot;no&quot;</span>
1102:         <span class="ruby-keyword kw">end</span>       
1103:         <span class="ruby-ivar">@format_fmt06</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;09$$$&gt;&quot;</span>,<span class="ruby-ivar">@case_alerk</span>,<span class="ruby-ivar">@format_fmt06</span>)  
1104:         <span class="ruby-comment cmt">#电话        </span>
1105:         <span class="ruby-ivar">@telephone</span> = <span class="ruby-identifier">clerk</span>.<span class="ruby-identifier">telephone</span>
1106:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@telephone</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@telephone</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
1107:             <span class="ruby-ivar">@telephone</span> = <span class="ruby-value str">&quot;no&quot;</span>
1108:         <span class="ruby-keyword kw">end</span>     
1109:         <span class="ruby-ivar">@format_fmt06</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;10$$$&gt;&quot;</span>,<span class="ruby-ivar">@telephone</span>,<span class="ruby-ivar">@format_fmt06</span>)       
1110:         <span class="ruby-comment cmt">#传真</span>
1111:         <span class="ruby-ivar">@fax</span> = <span class="ruby-identifier">clerk</span>.<span class="ruby-identifier">fax</span>
1112:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@fax</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@fax</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
1113:             <span class="ruby-ivar">@fax</span> = <span class="ruby-value str">&quot;no&quot;</span>
1114:         <span class="ruby-keyword kw">end</span>    
1115:         <span class="ruby-ivar">@format_fmt06</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;11$$$&gt;&quot;</span>,<span class="ruby-ivar">@fax</span>,<span class="ruby-ivar">@format_fmt06</span>)     
1116:         <span class="ruby-comment cmt">#电子邮箱</span>
1117:         <span class="ruby-ivar">@email</span> = <span class="ruby-identifier">clerk</span>.<span class="ruby-identifier">email</span>
1118:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@email</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@email</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
1119:             <span class="ruby-ivar">@email</span> = <span class="ruby-value str">&quot;no&quot;</span>
1120:         <span class="ruby-keyword kw">end</span>  
1121:         <span class="ruby-ivar">@format_fmt06</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;12$$$&gt;&quot;</span>,<span class="ruby-ivar">@email</span>,<span class="ruby-ivar">@format_fmt06</span>)    
1122:         <span class="ruby-comment cmt">#日期</span>
1123:         <span class="ruby-ivar">@date_of_letter</span> = <span class="ruby-constant">Time</span>.<span class="ruby-identifier">now</span>.<span class="ruby-identifier">to_s</span>(<span class="ruby-identifier">:db</span>)
1124:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@date_of_letter</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@date_of_letter</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
1125:             <span class="ruby-ivar">@date_of_letter</span> = <span class="ruby-value str">&quot;no&quot;</span>
1126:             <span class="ruby-ivar">@format_fmt06</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;13$$$&gt;&quot;</span>,<span class="ruby-ivar">@date_of_letter</span>,<span class="ruby-ivar">@format_fmt06</span>) 
1127:             <span class="ruby-ivar">@format_fmt06</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;14$$$&gt;&quot;</span>,<span class="ruby-ivar">@date_of_letter</span>,<span class="ruby-ivar">@format_fmt06</span>)
1128:             <span class="ruby-ivar">@format_fmt06</span> = <span class="ruby-identifier">add_last_record</span>(<span class="ruby-value str">&quot;&lt;15$$$&gt;&quot;</span>,<span class="ruby-ivar">@date_of_letter</span>,<span class="ruby-ivar">@format_fmt06</span>)
1129:         <span class="ruby-keyword kw">else</span>
1130:             <span class="ruby-identifier">arr_date</span> = <span class="ruby-ivar">@date_of_letter</span>.<span class="ruby-identifier">to_s</span>.<span class="ruby-identifier">split</span>(<span class="ruby-value str">&quot;-&quot;</span>)
1131:             <span class="ruby-ivar">@format_fmt06</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;13$$$&gt;&quot;</span>,<span class="ruby-identifier">arr_date</span>[<span class="ruby-value">0</span>],<span class="ruby-ivar">@format_fmt06</span>) 
1132:             <span class="ruby-ivar">@format_fmt06</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;14$$$&gt;&quot;</span>,<span class="ruby-identifier">arr_date</span>[<span class="ruby-value">1</span>],<span class="ruby-ivar">@format_fmt06</span>)
1133:             <span class="ruby-ivar">@format_fmt06</span> = <span class="ruby-identifier">add_last_record</span>(<span class="ruby-value str">&quot;&lt;15$$$&gt;&quot;</span>,<span class="ruby-identifier">arr_date</span>[<span class="ruby-value">2</span>].<span class="ruby-identifier">slice</span>(<span class="ruby-value">0</span>, <span class="ruby-value">2</span>),<span class="ruby-ivar">@format_fmt06</span>)            
1134:         <span class="ruby-keyword kw">end</span>   
1135:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000154" class="method-detail">
        <a name="M000154"></a>

        <div class="method-heading">
          <a href="#M000154" class="method-signature">
          <span class="method-name">format_letter_fmt07</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
空缺 ####################
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000154-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000154-source">
<pre>
      <span class="ruby-comment cmt"># File app/controllers/format_letter_controller.rb, line 1137</span>
1137:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">format_letter_fmt07</span>
1138:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000155" class="method-detail">
        <a name="M000155"></a>

        <div class="method-heading">
          <a href="#M000155" class="method-signature">
          <span class="method-name">format_letter_fmt09</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000155-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000155-source">
<pre>
      <span class="ruby-comment cmt"># File app/controllers/format_letter_controller.rb, line 1140</span>
1140:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">format_letter_fmt09</span>
1141:         <span class="ruby-comment cmt">#拼接字串，初始化</span>
1142:         <span class="ruby-ivar">@format_fmt09</span> = <span class="ruby-value str">&quot;&quot;</span>  
1143:         <span class="ruby-comment cmt">#函号</span>
1144:         <span class="ruby-ivar">@file_code</span> = <span class="ruby-constant">TbDoc</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:first</span>,<span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">&quot;used = 'Y' and recevice_code = ?&quot;</span>,<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]])
1145:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@file_code</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@file_code</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
1146:             <span class="ruby-ivar">@file_code</span> = <span class="ruby-value str">&quot;no&quot;</span>
1147:         <span class="ruby-keyword kw">else</span>
1148:             <span class="ruby-ivar">@file_code</span> = <span class="ruby-ivar">@file_code</span>.<span class="ruby-identifier">file_code</span>
1149:         <span class="ruby-keyword kw">end</span>
1150:         <span class="ruby-ivar">@format_fmt09</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;01$$$&gt;&quot;</span>,<span class="ruby-ivar">@file_code</span>,<span class="ruby-ivar">@format_fmt09</span>)
1151:         <span class="ruby-comment cmt">#被申请人</span>
1152:         <span class="ruby-ivar">@respondents</span> = <span class="ruby-constant">TbParty</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:all</span>,<span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">&quot;used = 'Y' and partytype = 2 and recevice_code = ?&quot;</span>,<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]], <span class="ruby-identifier">:order</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;id&quot;</span>)
1153:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@respondent</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@respondent</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
1154:             <span class="ruby-ivar">@respondent</span> = <span class="ruby-value str">&quot;no&quot;</span>
1155:         <span class="ruby-keyword kw">else</span>
1156:             <span class="ruby-ivar">@respondent</span> = <span class="ruby-value str">&quot;&quot;</span>
1157:             <span class="ruby-ivar">@respondents</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">resp</span><span class="ruby-operator">|</span>
1158:                 <span class="ruby-ivar">@respondent</span> = <span class="ruby-ivar">@respondent</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">resp</span>.<span class="ruby-identifier">partyname</span>
1159:             <span class="ruby-keyword kw">end</span>
1160:         <span class="ruby-keyword kw">end</span>       
1161:         <span class="ruby-ivar">@format_fmt09</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;02$$$&gt;&quot;</span>,<span class="ruby-ivar">@respondent</span>,<span class="ruby-ivar">@format_fmt09</span>)   
1162:         <span class="ruby-comment cmt">#立案号</span>
1163:         <span class="ruby-ivar">@case_code</span> = <span class="ruby-constant">TbCase</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:first</span>, <span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">&quot;used = 'Y' and recevice_code = ?&quot;</span>,<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]]).<span class="ruby-identifier">case_code</span>
1164:         <span class="ruby-ivar">@format_fmt09</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;03$$$&gt;&quot;</span>,<span class="ruby-ivar">@case_code</span>,<span class="ruby-ivar">@format_fmt09</span>)            
1165:         <span class="ruby-comment cmt">#被申请人仲裁费</span>
1166:         <span class="ruby-ivar">@arbit_fee</span> = <span class="ruby-identifier">respondent_arbit_fee</span>(<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>])
1167:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@arbit_fee</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@arbit_fee</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
1168:             <span class="ruby-ivar">@arbit_fee</span> = <span class="ruby-value str">&quot;no&quot;</span>
1169:         <span class="ruby-keyword kw">end</span>
1170:         <span class="ruby-ivar">@format_fmt04</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;04$$$&gt;&quot;</span>,<span class="ruby-ivar">@arbit_fee</span>,<span class="ruby-ivar">@format_fmt04</span>)         
1171:         <span class="ruby-comment cmt">#日期</span>
1172:         <span class="ruby-ivar">@date_of_letter</span> = <span class="ruby-constant">Time</span>.<span class="ruby-identifier">now</span>.<span class="ruby-identifier">to_s</span>(<span class="ruby-identifier">:db</span>)
1173:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@date_of_letter</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@date_of_letter</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
1174:             <span class="ruby-ivar">@date_of_letter</span> = <span class="ruby-value str">&quot;no&quot;</span>
1175:             <span class="ruby-ivar">@format_fmt09</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;05$$$&gt;&quot;</span>,<span class="ruby-ivar">@date_of_letter</span>,<span class="ruby-ivar">@format_fmt09</span>) 
1176:             <span class="ruby-ivar">@format_fmt09</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;06$$$&gt;&quot;</span>,<span class="ruby-ivar">@date_of_letter</span>,<span class="ruby-ivar">@format_fmt09</span>)
1177:             <span class="ruby-ivar">@format_fmt09</span> = <span class="ruby-identifier">add_last_record</span>(<span class="ruby-value str">&quot;&lt;07$$$&gt;&quot;</span>,<span class="ruby-ivar">@date_of_letter</span>,<span class="ruby-ivar">@format_fmt09</span>)
1178:         <span class="ruby-keyword kw">else</span>
1179:             <span class="ruby-identifier">arr_date</span> = <span class="ruby-ivar">@date_of_letter</span>.<span class="ruby-identifier">to_s</span>.<span class="ruby-identifier">split</span>(<span class="ruby-value str">&quot;-&quot;</span>)
1180:             <span class="ruby-ivar">@format_fmt09</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;05$$$&gt;&quot;</span>,<span class="ruby-identifier">arr_date</span>[<span class="ruby-value">0</span>],<span class="ruby-ivar">@format_fmt09</span>) 
1181:             <span class="ruby-ivar">@format_fmt09</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;06$$$&gt;&quot;</span>,<span class="ruby-identifier">arr_date</span>[<span class="ruby-value">1</span>],<span class="ruby-ivar">@format_fmt09</span>)
1182:             <span class="ruby-ivar">@format_fmt09</span> = <span class="ruby-identifier">add_last_record</span>(<span class="ruby-value str">&quot;&lt;07$$$&gt;&quot;</span>,<span class="ruby-identifier">arr_date</span>[<span class="ruby-value">2</span>].<span class="ruby-identifier">slice</span>(<span class="ruby-value">0</span>, <span class="ruby-value">2</span>),<span class="ruby-ivar">@format_fmt09</span>)            
1183:         <span class="ruby-keyword kw">end</span>   
1184:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000156" class="method-detail">
        <a name="M000156"></a>

        <div class="method-heading">
          <a href="#M000156" class="method-signature">
          <span class="method-name">format_letter_fmt11a</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000156-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000156-source">
<pre>
      <span class="ruby-comment cmt"># File app/controllers/format_letter_controller.rb, line 1186</span>
1186:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">format_letter_fmt11a</span>
1187:         <span class="ruby-comment cmt">#拼接字串，初始化</span>
1188:         <span class="ruby-ivar">@format_fmt11a</span> = <span class="ruby-value str">&quot;&quot;</span>  
1189:         <span class="ruby-comment cmt">#函号</span>
1190:         <span class="ruby-ivar">@file_code</span> = <span class="ruby-constant">TbDoc</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:first</span>,<span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">&quot;used = 'Y' and recevice_code = ?&quot;</span>,<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]])
1191:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@file_code</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@file_code</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
1192:             <span class="ruby-ivar">@file_code</span> = <span class="ruby-value str">&quot;no&quot;</span>
1193:         <span class="ruby-keyword kw">else</span>
1194:             <span class="ruby-ivar">@file_code</span> = <span class="ruby-ivar">@file_code</span>.<span class="ruby-identifier">file_code</span>
1195:         <span class="ruby-keyword kw">end</span>
1196:         <span class="ruby-ivar">@format_fmt11a</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;01$$$&gt;&quot;</span>,<span class="ruby-ivar">@file_code</span>,<span class="ruby-ivar">@format_fmt11a</span>)
1197:         <span class="ruby-comment cmt">#申请人</span>
1198:         <span class="ruby-ivar">@applicants</span> = <span class="ruby-constant">TbParty</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:all</span>,<span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">&quot;used = 'Y' and partytype = 1 and recevice_code = ?&quot;</span>,<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]], <span class="ruby-identifier">:order</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;id&quot;</span>)
1199:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@applicants</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@applicants</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
1200:             <span class="ruby-ivar">@applicant</span> = <span class="ruby-value str">&quot;no&quot;</span>
1201:         <span class="ruby-keyword kw">else</span>
1202:             <span class="ruby-ivar">@applicant</span> = <span class="ruby-value str">&quot;&quot;</span>
1203:             <span class="ruby-ivar">@applicants</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">applicant</span><span class="ruby-operator">|</span>
1204:                 <span class="ruby-ivar">@applicant</span> = <span class="ruby-ivar">@applicant</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">applicant</span>.<span class="ruby-identifier">partyname</span>
1205:             <span class="ruby-keyword kw">end</span>
1206:         <span class="ruby-keyword kw">end</span>        
1207:         <span class="ruby-ivar">@format_fmt11a</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;02$$$&gt;&quot;</span>,<span class="ruby-ivar">@applicant</span>,<span class="ruby-ivar">@format_fmt11a</span>)
1208:         <span class="ruby-comment cmt">#被申请人</span>
1209:         <span class="ruby-ivar">@respondents</span> = <span class="ruby-constant">TbParty</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:all</span>,<span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">&quot;used = 'Y' and partytype = 2 and recevice_code = ?&quot;</span>,<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]], <span class="ruby-identifier">:order</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;id&quot;</span>)
1210:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@respondent</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@respondent</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
1211:             <span class="ruby-ivar">@respondent</span> = <span class="ruby-value str">&quot;no&quot;</span>
1212:         <span class="ruby-keyword kw">else</span>
1213:             <span class="ruby-ivar">@respondent</span> = <span class="ruby-value str">&quot;&quot;</span>
1214:             <span class="ruby-ivar">@respondents</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">resp</span><span class="ruby-operator">|</span>
1215:                 <span class="ruby-ivar">@respondent</span> = <span class="ruby-ivar">@respondent</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">resp</span>.<span class="ruby-identifier">partyname</span>
1216:             <span class="ruby-keyword kw">end</span>
1217:         <span class="ruby-keyword kw">end</span>       
1218:         <span class="ruby-ivar">@format_fmt11a</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;03$$$&gt;&quot;</span>,<span class="ruby-ivar">@respondent</span>,<span class="ruby-ivar">@format_fmt11a</span>)
1219:         <span class="ruby-comment cmt">#立案号</span>
1220:         <span class="ruby-ivar">@case_code</span> = <span class="ruby-constant">TbCase</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:first</span>, <span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">&quot;used = 'Y' and recevice_code = ?&quot;</span>,<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]]).<span class="ruby-identifier">case_code</span>
1221:         <span class="ruby-ivar">@format_fmt11a</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;04$$$&gt;&quot;</span>,<span class="ruby-ivar">@case_code</span>,<span class="ruby-ivar">@format_fmt11a</span>)  
1222:         <span class="ruby-comment cmt">#首席仲裁员</span>
1223:         <span class="ruby-ivar">@chief_arbitrator</span> = <span class="ruby-identifier">chief_arbitrator</span>(<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>])
1224:         <span class="ruby-ivar">@format_fmt11a</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;05$$$&gt;&quot;</span>,<span class="ruby-ivar">@chief_arbitrator</span>,<span class="ruby-ivar">@format_fmt11a</span>)
1225:         <span class="ruby-ivar">@format_fmt11a</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;13$$$&gt;&quot;</span>,<span class="ruby-ivar">@chief_arbitrator</span>,<span class="ruby-ivar">@format_fmt11a</span>)
1226:         <span class="ruby-comment cmt">#申请人仲裁员</span>
1227:         <span class="ruby-ivar">@applicant_arbitrator</span> = <span class="ruby-identifier">applicant_arbitrator</span>(<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>])
1228:         <span class="ruby-ivar">@format_fmt11a</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;06$$$&gt;&quot;</span>,<span class="ruby-ivar">@applicant_arbitrator</span>,<span class="ruby-ivar">@format_fmt11a</span>)
1229:         <span class="ruby-ivar">@format_fmt11a</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;14$$$&gt;&quot;</span>,<span class="ruby-ivar">@applicant_arbitrator</span>,<span class="ruby-ivar">@format_fmt11a</span>)
1230:         <span class="ruby-comment cmt">#被申请人仲裁员</span>
1231:         <span class="ruby-ivar">@respondent_arbitrator</span> = <span class="ruby-identifier">respondent_arbitrator</span>(<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>])
1232:         <span class="ruby-ivar">@format_fmt11a</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;07$$$&gt;&quot;</span>,<span class="ruby-ivar">@respondent_arbitrator</span>,<span class="ruby-ivar">@format_fmt11a</span>)
1233:         <span class="ruby-ivar">@format_fmt11a</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;15$$$&gt;&quot;</span>,<span class="ruby-ivar">@respondent_arbitrator</span>,<span class="ruby-ivar">@format_fmt11a</span>)
1234:         <span class="ruby-comment cmt">#开庭日期</span>
1235:         <span class="ruby-ivar">@sitting_date</span> = <span class="ruby-constant">TbSitting</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:first</span>, <span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">&quot;used = 'Y' and recevice_code = ?&quot;</span>,<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]])
1236:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@sitting_date</span> <span class="ruby-operator">!=</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@sitting_date</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
1237:             <span class="ruby-ivar">@sitting_date</span> = <span class="ruby-ivar">@sitting_date</span>.<span class="ruby-identifier">sittingdate</span>
1238:         <span class="ruby-keyword kw">else</span>
1239:             <span class="ruby-ivar">@sitting_date</span> = <span class="ruby-value str">&quot;no&quot;</span>
1240:         <span class="ruby-keyword kw">end</span>
1241:         <span class="ruby-ivar">@format_fmt11a</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;08$$$&gt;&quot;</span>,<span class="ruby-ivar">@sitting_date</span>,<span class="ruby-ivar">@format_fmt11a</span>)        
1242:         <span class="ruby-comment cmt">#审限（裁决期限）</span>
1243:         <span class="ruby-ivar">@end_date</span> = <span class="ruby-constant">TbCase</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:first</span>, <span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">&quot;used = 'Y' and recevice_code = ?&quot;</span>,<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]])
1244:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@end_date</span> <span class="ruby-operator">!=</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@end_date</span> <span class="ruby-operator">!=</span> <span class="ruby-value str">&quot;&quot;</span>
1245:             <span class="ruby-ivar">@end_date</span> = <span class="ruby-ivar">@end_date</span>.<span class="ruby-identifier">end_date</span>
1246:         <span class="ruby-keyword kw">else</span>
1247:             <span class="ruby-ivar">@end_date</span> = <span class="ruby-value str">&quot;no&quot;</span>
1248:         <span class="ruby-keyword kw">end</span>
1249:         <span class="ruby-ivar">@format_fmt11a</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;09$$$&gt;&quot;</span>,<span class="ruby-ivar">@end_date</span>,<span class="ruby-ivar">@format_fmt11a</span>)   
1250:         <span class="ruby-comment cmt">#日期</span>
1251:         <span class="ruby-ivar">@date_of_letter</span> = <span class="ruby-constant">Time</span>.<span class="ruby-identifier">now</span>.<span class="ruby-identifier">to_s</span>(<span class="ruby-identifier">:db</span>)
1252:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@date_of_letter</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@date_of_letter</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
1253:             <span class="ruby-ivar">@date_of_letter</span> = <span class="ruby-value str">&quot;no&quot;</span>
1254:             <span class="ruby-ivar">@format_fmt11a</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;10$$$&gt;&quot;</span>,<span class="ruby-ivar">@date_of_letter</span>,<span class="ruby-ivar">@format_fmt11a</span>) 
1255:             <span class="ruby-ivar">@format_fmt11a</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;11$$$&gt;&quot;</span>,<span class="ruby-ivar">@date_of_letter</span>,<span class="ruby-ivar">@format_fmt11a</span>)
1256:             <span class="ruby-ivar">@format_fmt11a</span> = <span class="ruby-identifier">add_last_record</span>(<span class="ruby-value str">&quot;&lt;12$$$&gt;&quot;</span>,<span class="ruby-ivar">@date_of_letter</span>,<span class="ruby-ivar">@format_fmt11a</span>)
1257:         <span class="ruby-keyword kw">else</span>
1258:             <span class="ruby-identifier">arr_date</span> = <span class="ruby-ivar">@date_of_letter</span>.<span class="ruby-identifier">to_s</span>.<span class="ruby-identifier">split</span>(<span class="ruby-value str">&quot;-&quot;</span>)
1259:             <span class="ruby-ivar">@format_fmt11a</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;10$$$&gt;&quot;</span>,<span class="ruby-identifier">arr_date</span>[<span class="ruby-value">0</span>],<span class="ruby-ivar">@format_fmt11a</span>) 
1260:             <span class="ruby-ivar">@format_fmt11a</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;11$$$&gt;&quot;</span>,<span class="ruby-identifier">arr_date</span>[<span class="ruby-value">1</span>],<span class="ruby-ivar">@format_fmt11a</span>)
1261:             <span class="ruby-ivar">@format_fmt11a</span> = <span class="ruby-identifier">add_last_record</span>(<span class="ruby-value str">&quot;&lt;12$$$&gt;&quot;</span>,<span class="ruby-identifier">arr_date</span>[<span class="ruby-value">2</span>].<span class="ruby-identifier">slice</span>(<span class="ruby-value">0</span>, <span class="ruby-value">2</span>),<span class="ruby-ivar">@format_fmt11a</span>)            
1262:         <span class="ruby-keyword kw">end</span>   
1263:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000157" class="method-detail">
        <a name="M000157"></a>

        <div class="method-heading">
          <a href="#M000157" class="method-signature">
          <span class="method-name">format_letter_fmt14</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000157-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000157-source">
<pre>
      <span class="ruby-comment cmt"># File app/controllers/format_letter_controller.rb, line 1265</span>
1265:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">format_letter_fmt14</span>
1266:         <span class="ruby-comment cmt">#拼接字串，初始化</span>
1267:         <span class="ruby-ivar">@format_fmt14</span> = <span class="ruby-value str">&quot;&quot;</span>  
1268:         <span class="ruby-comment cmt">#函号</span>
1269:         <span class="ruby-ivar">@file_code</span> = <span class="ruby-constant">TbDoc</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:first</span>,<span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">&quot;used = 'Y' and recevice_code = ?&quot;</span>,<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]])
1270:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@file_code</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@file_code</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
1271:             <span class="ruby-ivar">@file_code</span> = <span class="ruby-value str">&quot;no&quot;</span>
1272:         <span class="ruby-keyword kw">else</span>
1273:             <span class="ruby-ivar">@file_code</span> = <span class="ruby-ivar">@file_code</span>.<span class="ruby-identifier">file_code</span>
1274:         <span class="ruby-keyword kw">end</span>
1275:         <span class="ruby-ivar">@format_fmt14</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;01$$$&gt;&quot;</span>,<span class="ruby-ivar">@file_code</span>,<span class="ruby-ivar">@format_fmt14</span>)
1276:         <span class="ruby-comment cmt">#申请人</span>
1277:         <span class="ruby-ivar">@applicants</span> = <span class="ruby-constant">TbParty</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:all</span>,<span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">&quot;used = 'Y' and partytype = 1 and recevice_code = ?&quot;</span>,<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]], <span class="ruby-identifier">:order</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;id&quot;</span>)
1278:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@applicants</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@applicants</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
1279:             <span class="ruby-ivar">@applicant</span> = <span class="ruby-value str">&quot;no&quot;</span>
1280:         <span class="ruby-keyword kw">else</span>
1281:             <span class="ruby-ivar">@applicant</span> = <span class="ruby-value str">&quot;&quot;</span>
1282:             <span class="ruby-ivar">@applicants</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">applicant</span><span class="ruby-operator">|</span>
1283:                 <span class="ruby-ivar">@applicant</span> = <span class="ruby-ivar">@applicant</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">applicant</span>.<span class="ruby-identifier">partyname</span>
1284:             <span class="ruby-keyword kw">end</span>
1285:         <span class="ruby-keyword kw">end</span>        
1286:         <span class="ruby-ivar">@format_fmt14</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;02$$$&gt;&quot;</span>,<span class="ruby-ivar">@applicant</span>,<span class="ruby-ivar">@format_fmt14</span>)
1287:         <span class="ruby-comment cmt">#被申请人</span>
1288:         <span class="ruby-ivar">@respondents</span> = <span class="ruby-constant">TbParty</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:all</span>,<span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">&quot;used = 'Y' and partytype = 2 and recevice_code = ?&quot;</span>,<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]], <span class="ruby-identifier">:order</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;id&quot;</span>)
1289:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@respondent</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@respondent</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
1290:             <span class="ruby-ivar">@respondent</span> = <span class="ruby-value str">&quot;no&quot;</span>
1291:         <span class="ruby-keyword kw">else</span>
1292:             <span class="ruby-ivar">@respondent</span> = <span class="ruby-value str">&quot;&quot;</span>
1293:             <span class="ruby-ivar">@respondents</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">resp</span><span class="ruby-operator">|</span>
1294:                 <span class="ruby-ivar">@respondent</span> = <span class="ruby-ivar">@respondent</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">resp</span>.<span class="ruby-identifier">partyname</span>
1295:             <span class="ruby-keyword kw">end</span>
1296:         <span class="ruby-keyword kw">end</span>       
1297:         <span class="ruby-ivar">@format_fmt14</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;03$$$&gt;&quot;</span>,<span class="ruby-ivar">@respondent</span>,<span class="ruby-ivar">@format_fmt14</span>)
1298:         <span class="ruby-comment cmt">#立案号</span>
1299:         <span class="ruby-ivar">@case_code</span> = <span class="ruby-constant">TbCase</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:first</span>, <span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">&quot;used = 'Y' and recevice_code = ?&quot;</span>,<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]]).<span class="ruby-identifier">case_code</span>
1300:         <span class="ruby-ivar">@format_fmt14</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;04$$$&gt;&quot;</span>,<span class="ruby-ivar">@case_code</span>,<span class="ruby-ivar">@format_fmt14</span>)  
1301:         <span class="ruby-comment cmt">#日期</span>
1302:         <span class="ruby-ivar">@date_of_letter</span> = <span class="ruby-constant">Time</span>.<span class="ruby-identifier">now</span>.<span class="ruby-identifier">to_s</span>(<span class="ruby-identifier">:db</span>)
1303:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@date_of_letter</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@date_of_letter</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
1304:             <span class="ruby-ivar">@date_of_letter</span> = <span class="ruby-value str">&quot;no&quot;</span>
1305:             <span class="ruby-ivar">@format_fmt14</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;05$$$&gt;&quot;</span>,<span class="ruby-ivar">@date_of_letter</span>,<span class="ruby-ivar">@format_fmt14</span>) 
1306:             <span class="ruby-ivar">@format_fmt14</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;06$$$&gt;&quot;</span>,<span class="ruby-ivar">@date_of_letter</span>,<span class="ruby-ivar">@format_fmt14</span>)
1307:             <span class="ruby-ivar">@format_fmt14</span> = <span class="ruby-identifier">add_last_record</span>(<span class="ruby-value str">&quot;&lt;07$$$&gt;&quot;</span>,<span class="ruby-ivar">@date_of_letter</span>,<span class="ruby-ivar">@format_fmt14</span>)
1308:         <span class="ruby-keyword kw">else</span>
1309:             <span class="ruby-identifier">arr_date</span> = <span class="ruby-ivar">@date_of_letter</span>.<span class="ruby-identifier">to_s</span>.<span class="ruby-identifier">split</span>(<span class="ruby-value str">&quot;-&quot;</span>)
1310:             <span class="ruby-ivar">@format_fmt14</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;05$$$&gt;&quot;</span>,<span class="ruby-identifier">arr_date</span>[<span class="ruby-value">0</span>],<span class="ruby-ivar">@format_fmt14</span>) 
1311:             <span class="ruby-ivar">@format_fmt14</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;06$$$&gt;&quot;</span>,<span class="ruby-identifier">arr_date</span>[<span class="ruby-value">1</span>],<span class="ruby-ivar">@format_fmt14</span>)
1312:             <span class="ruby-ivar">@format_fmt14</span> = <span class="ruby-identifier">add_last_record</span>(<span class="ruby-value str">&quot;&lt;07$$$&gt;&quot;</span>,<span class="ruby-identifier">arr_date</span>[<span class="ruby-value">2</span>].<span class="ruby-identifier">slice</span>(<span class="ruby-value">0</span>, <span class="ruby-value">2</span>),<span class="ruby-ivar">@format_fmt14</span>)            
1313:         <span class="ruby-keyword kw">end</span>   
1314:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000158" class="method-detail">
        <a name="M000158"></a>

        <div class="method-heading">
          <a href="#M000158" class="method-signature">
          <span class="method-name">format_letter_fmt15</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000158-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000158-source">
<pre>
      <span class="ruby-comment cmt"># File app/controllers/format_letter_controller.rb, line 1316</span>
1316:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">format_letter_fmt15</span>
1317:         <span class="ruby-comment cmt">#拼接字串，初始化</span>
1318:         <span class="ruby-ivar">@format_fmt15</span> = <span class="ruby-value str">&quot;&quot;</span>  
1319:         <span class="ruby-comment cmt">#函号</span>
1320:         <span class="ruby-ivar">@file_code</span> = <span class="ruby-constant">TbDoc</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:first</span>,<span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">&quot;used = 'Y' and recevice_code = ?&quot;</span>,<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]])
1321:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@file_code</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@file_code</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
1322:             <span class="ruby-ivar">@file_code</span> = <span class="ruby-value str">&quot;no&quot;</span>
1323:         <span class="ruby-keyword kw">else</span>
1324:             <span class="ruby-ivar">@file_code</span> = <span class="ruby-ivar">@file_code</span>.<span class="ruby-identifier">file_code</span>
1325:         <span class="ruby-keyword kw">end</span>
1326:         <span class="ruby-ivar">@format_fmt15</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;01$$$&gt;&quot;</span>,<span class="ruby-ivar">@file_code</span>,<span class="ruby-ivar">@format_fmt15</span>)
1327:         <span class="ruby-comment cmt">#首席仲裁员</span>
1328:         <span class="ruby-ivar">@chief_arbitrator</span> = <span class="ruby-identifier">chief_arbitrator</span>(<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>])
1329:         <span class="ruby-ivar">@format_fmt15</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;02$$$&gt;&quot;</span>,<span class="ruby-ivar">@chief_arbitrator</span>,<span class="ruby-ivar">@format_fmt15</span>)
1330:         <span class="ruby-comment cmt">#申请人仲裁员</span>
1331:         <span class="ruby-ivar">@applicant_arbitrator</span> = <span class="ruby-identifier">applicant_arbitrator</span>(<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>])
1332:         <span class="ruby-ivar">@format_fmt15</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;03$$$&gt;&quot;</span>,<span class="ruby-ivar">@applicant_arbitrator</span>,<span class="ruby-ivar">@format_fmt15</span>)
1333:         <span class="ruby-comment cmt">#被申请人仲裁员</span>
1334:         <span class="ruby-ivar">@respondent_arbitrator</span> = <span class="ruby-identifier">respondent_arbitrator</span>(<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>])
1335:         <span class="ruby-ivar">@format_fmt15</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;04$$$&gt;&quot;</span>,<span class="ruby-ivar">@respondent_arbitrator</span>,<span class="ruby-ivar">@format_fmt15</span>)
1336:         <span class="ruby-comment cmt">#立案号</span>
1337:         <span class="ruby-ivar">@case_code</span> = <span class="ruby-constant">TbCase</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:first</span>, <span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">&quot;used = 'Y' and recevice_code = ?&quot;</span>,<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]]).<span class="ruby-identifier">case_code</span>
1338:         <span class="ruby-ivar">@format_fmt15</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;05$$$&gt;&quot;</span>,<span class="ruby-ivar">@case_code</span>,<span class="ruby-ivar">@format_fmt15</span>)  
1339:         <span class="ruby-comment cmt">#日期</span>
1340:         <span class="ruby-ivar">@date_of_letter</span> = <span class="ruby-constant">Time</span>.<span class="ruby-identifier">now</span>.<span class="ruby-identifier">to_s</span>(<span class="ruby-identifier">:db</span>)
1341:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@date_of_letter</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@date_of_letter</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
1342:             <span class="ruby-ivar">@date_of_letter</span> = <span class="ruby-value str">&quot;no&quot;</span>
1343:             <span class="ruby-ivar">@format_fmt15</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;06$$$&gt;&quot;</span>,<span class="ruby-ivar">@date_of_letter</span>,<span class="ruby-ivar">@format_fmt15</span>) 
1344:             <span class="ruby-ivar">@format_fmt15</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;07$$$&gt;&quot;</span>,<span class="ruby-ivar">@date_of_letter</span>,<span class="ruby-ivar">@format_fmt15</span>)
1345:             <span class="ruby-ivar">@format_fmt15</span> = <span class="ruby-identifier">add_last_record</span>(<span class="ruby-value str">&quot;&lt;08$$$&gt;&quot;</span>,<span class="ruby-ivar">@date_of_letter</span>,<span class="ruby-ivar">@format_fmt15</span>)
1346:         <span class="ruby-keyword kw">else</span>
1347:             <span class="ruby-identifier">arr_date</span> = <span class="ruby-ivar">@date_of_letter</span>.<span class="ruby-identifier">to_s</span>.<span class="ruby-identifier">split</span>(<span class="ruby-value str">&quot;-&quot;</span>)
1348:             <span class="ruby-ivar">@format_fmt15</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;06$$$&gt;&quot;</span>,<span class="ruby-identifier">arr_date</span>[<span class="ruby-value">0</span>],<span class="ruby-ivar">@format_fmt15</span>) 
1349:             <span class="ruby-ivar">@format_fmt15</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;07$$$&gt;&quot;</span>,<span class="ruby-identifier">arr_date</span>[<span class="ruby-value">1</span>],<span class="ruby-ivar">@format_fmt15</span>)
1350:             <span class="ruby-ivar">@format_fmt15</span> = <span class="ruby-identifier">add_last_record</span>(<span class="ruby-value str">&quot;&lt;08$$$&gt;&quot;</span>,<span class="ruby-identifier">arr_date</span>[<span class="ruby-value">2</span>].<span class="ruby-identifier">slice</span>(<span class="ruby-value">0</span>, <span class="ruby-value">2</span>),<span class="ruby-ivar">@format_fmt15</span>)            
1351:         <span class="ruby-keyword kw">end</span>   
1352:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000159" class="method-detail">
        <a name="M000159"></a>

        <div class="method-heading">
          <a href="#M000159" class="method-signature">
          <span class="method-name">format_letter_fmt17</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000159-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000159-source">
<pre>
      <span class="ruby-comment cmt"># File app/controllers/format_letter_controller.rb, line 1354</span>
1354:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">format_letter_fmt17</span>
1355:         <span class="ruby-comment cmt">#拼接字串，初始化</span>
1356:         <span class="ruby-ivar">@format_fmt17</span> = <span class="ruby-value str">&quot;&quot;</span>  
1357:         <span class="ruby-comment cmt">#函号</span>
1358:         <span class="ruby-ivar">@file_code</span> = <span class="ruby-constant">TbDoc</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:first</span>,<span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">&quot;used = 'Y' and recevice_code = ?&quot;</span>,<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]])
1359:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@file_code</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@file_code</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
1360:             <span class="ruby-ivar">@file_code</span> = <span class="ruby-value str">&quot;no&quot;</span>
1361:         <span class="ruby-keyword kw">else</span>
1362:             <span class="ruby-ivar">@file_code</span> = <span class="ruby-ivar">@file_code</span>.<span class="ruby-identifier">file_code</span>
1363:         <span class="ruby-keyword kw">end</span>
1364:         <span class="ruby-ivar">@format_fmt17</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;01$$$&gt;&quot;</span>,<span class="ruby-ivar">@file_code</span>,<span class="ruby-ivar">@format_fmt17</span>)
1365:         <span class="ruby-comment cmt">#申请人</span>
1366:         <span class="ruby-ivar">@applicants</span> = <span class="ruby-constant">TbParty</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:all</span>,<span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">&quot;used = 'Y' and partytype = 1 and recevice_code = ?&quot;</span>,<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]], <span class="ruby-identifier">:order</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;id&quot;</span>)
1367:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@applicants</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@applicants</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
1368:             <span class="ruby-ivar">@applicant</span> = <span class="ruby-value str">&quot;no&quot;</span>
1369:         <span class="ruby-keyword kw">else</span>
1370:             <span class="ruby-ivar">@applicant</span> = <span class="ruby-value str">&quot;&quot;</span>
1371:             <span class="ruby-ivar">@applicants</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">applicant</span><span class="ruby-operator">|</span>
1372:                 <span class="ruby-ivar">@applicant</span> = <span class="ruby-ivar">@applicant</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">applicant</span>.<span class="ruby-identifier">partyname</span>
1373:             <span class="ruby-keyword kw">end</span>
1374:         <span class="ruby-keyword kw">end</span>        
1375:         <span class="ruby-ivar">@format_fmt17</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;02$$$&gt;&quot;</span>,<span class="ruby-ivar">@applicant</span>,<span class="ruby-ivar">@format_fmt17</span>)
1376:         <span class="ruby-comment cmt">#被申请人</span>
1377:         <span class="ruby-ivar">@respondents</span> = <span class="ruby-constant">TbParty</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:all</span>,<span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">&quot;used = 'Y' and partytype = 2 and recevice_code = ?&quot;</span>,<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]], <span class="ruby-identifier">:order</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;id&quot;</span>)
1378:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@respondent</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@respondent</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
1379:             <span class="ruby-ivar">@respondent</span> = <span class="ruby-value str">&quot;no&quot;</span>
1380:         <span class="ruby-keyword kw">else</span>
1381:             <span class="ruby-ivar">@respondent</span> = <span class="ruby-value str">&quot;&quot;</span>
1382:             <span class="ruby-ivar">@respondents</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">resp</span><span class="ruby-operator">|</span>
1383:                 <span class="ruby-ivar">@respondent</span> = <span class="ruby-ivar">@respondent</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">resp</span>.<span class="ruby-identifier">partyname</span>
1384:             <span class="ruby-keyword kw">end</span>
1385:         <span class="ruby-keyword kw">end</span>       
1386:         <span class="ruby-ivar">@format_fmt17</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;03$$$&gt;&quot;</span>,<span class="ruby-ivar">@respondent</span>,<span class="ruby-ivar">@format_fmt17</span>)
1387:         <span class="ruby-comment cmt">#立案号</span>
1388:         <span class="ruby-ivar">@case_code</span> = <span class="ruby-constant">TbCase</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:first</span>, <span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">&quot;used = 'Y' and recevice_code = ?&quot;</span>,<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]]).<span class="ruby-identifier">case_code</span>
1389:         <span class="ruby-ivar">@format_fmt17</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;04$$$&gt;&quot;</span>,<span class="ruby-ivar">@case_code</span>,<span class="ruby-ivar">@format_fmt17</span>)  
1390:         <span class="ruby-comment cmt">#独立仲裁员</span>
1391:         <span class="ruby-ivar">@independent_arbitrator</span> = <span class="ruby-identifier">chief_arbitrator</span>(<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>])
1392:         <span class="ruby-ivar">@format_fmt17</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;05$$$&gt;&quot;</span>,<span class="ruby-ivar">@independent_arbitrator</span>,<span class="ruby-ivar">@format_fmt17</span>)
1393:         <span class="ruby-ivar">@format_fmt17</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;07$$$&gt;&quot;</span>,<span class="ruby-ivar">@independent_arbitrator</span>,<span class="ruby-ivar">@format_fmt17</span>)
1394:         <span class="ruby-ivar">@format_fmt17</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;16$$$&gt;&quot;</span>,<span class="ruby-ivar">@independent_arbitrator</span>,<span class="ruby-ivar">@format_fmt17</span>)     
1395:         <span class="ruby-comment cmt">#开庭日期</span>
1396:         <span class="ruby-ivar">@sitting_date</span> = <span class="ruby-constant">TbSitting</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:first</span>, <span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">&quot;used = 'Y' and recevice_code = ?&quot;</span>,<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]])
1397:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@sitting_date</span> <span class="ruby-operator">!=</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@sitting_date</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
1398:             <span class="ruby-ivar">@sitting_date</span> = <span class="ruby-ivar">@sitting_date</span>.<span class="ruby-identifier">sittingdate</span>
1399:         <span class="ruby-keyword kw">else</span>
1400:             <span class="ruby-ivar">@sitting_date</span> = <span class="ruby-value str">&quot;no&quot;</span>
1401:         <span class="ruby-keyword kw">end</span>
1402:         <span class="ruby-ivar">@format_fmt17</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;06$$$&gt;&quot;</span>,<span class="ruby-ivar">@sitting_date</span>,<span class="ruby-ivar">@format_fmt17</span>)        
1403:         <span class="ruby-comment cmt">#审限（裁决期限）</span>
1404:         <span class="ruby-ivar">@end_date</span> = <span class="ruby-constant">TbCase</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:first</span>, <span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">&quot;used = 'Y' and recevice_code = ?&quot;</span>,<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]])
1405:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@end_date</span> <span class="ruby-operator">!=</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@end_date</span> <span class="ruby-operator">!=</span> <span class="ruby-value str">&quot;&quot;</span>
1406:             <span class="ruby-ivar">@end_date</span> = <span class="ruby-ivar">@end_date</span>.<span class="ruby-identifier">end_date</span>
1407:         <span class="ruby-keyword kw">else</span>
1408:             <span class="ruby-ivar">@end_date</span> = <span class="ruby-value str">&quot;no&quot;</span>
1409:         <span class="ruby-keyword kw">end</span>
1410:         <span class="ruby-ivar">@format_fmt17</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;08$$$&gt;&quot;</span>,<span class="ruby-ivar">@end_date</span>,<span class="ruby-ivar">@format_fmt17</span>)   
1411:         <span class="ruby-comment cmt">#日期</span>
1412:         <span class="ruby-ivar">@date_of_letter</span> = <span class="ruby-constant">Time</span>.<span class="ruby-identifier">now</span>.<span class="ruby-identifier">to_s</span>(<span class="ruby-identifier">:db</span>)
1413:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@date_of_letter</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@date_of_letter</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
1414:             <span class="ruby-ivar">@date_of_letter</span> = <span class="ruby-value str">&quot;no&quot;</span>
1415:             <span class="ruby-ivar">@format_fmt17</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;09$$$&gt;&quot;</span>,<span class="ruby-ivar">@date_of_letter</span>,<span class="ruby-ivar">@format_fmt17</span>) 
1416:             <span class="ruby-ivar">@format_fmt17</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;10$$$&gt;&quot;</span>,<span class="ruby-ivar">@date_of_letter</span>,<span class="ruby-ivar">@format_fmt17</span>)
1417:             <span class="ruby-ivar">@format_fmt17</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;11$$$&gt;&quot;</span>,<span class="ruby-ivar">@date_of_letter</span>,<span class="ruby-ivar">@format_fmt17</span>)
1418:         <span class="ruby-keyword kw">else</span>
1419:             <span class="ruby-identifier">arr_date</span> = <span class="ruby-ivar">@date_of_letter</span>.<span class="ruby-identifier">to_s</span>.<span class="ruby-identifier">split</span>(<span class="ruby-value str">&quot;-&quot;</span>)
1420:             <span class="ruby-ivar">@format_fmt17</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;09$$$&gt;&quot;</span>,<span class="ruby-identifier">arr_date</span>[<span class="ruby-value">0</span>],<span class="ruby-ivar">@format_fmt17</span>) 
1421:             <span class="ruby-ivar">@format_fmt17</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;10$$$&gt;&quot;</span>,<span class="ruby-identifier">arr_date</span>[<span class="ruby-value">1</span>],<span class="ruby-ivar">@format_fmt17</span>)
1422:             <span class="ruby-ivar">@format_fmt17</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;11$$$&gt;&quot;</span>,<span class="ruby-identifier">arr_date</span>[<span class="ruby-value">2</span>].<span class="ruby-identifier">slice</span>(<span class="ruby-value">0</span>, <span class="ruby-value">2</span>),<span class="ruby-ivar">@format_fmt17</span>)            
1423:         <span class="ruby-keyword kw">end</span>   
1424:         <span class="ruby-comment cmt">#助理</span>
1425:         <span class="ruby-identifier">clerk_code</span> = <span class="ruby-constant">TbCase</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:first</span>,<span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">&quot;used = 'Y' and recevice_code = ?&quot;</span>,<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]]).<span class="ruby-identifier">clerk</span>
1426:         <span class="ruby-identifier">clerk</span> = <span class="ruby-constant">User</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:first</span>,<span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">&quot;used = 'Y' and code = ?&quot;</span>,<span class="ruby-identifier">clerk_code</span>])
1427:         <span class="ruby-ivar">@case_alerk</span> = <span class="ruby-identifier">clerk</span>.<span class="ruby-identifier">name</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">clerk</span>.<span class="ruby-identifier">sex</span>
1428:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@case_alerk</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@case_alerk</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
1429:             <span class="ruby-ivar">@case_alerk</span> = <span class="ruby-value str">&quot;no&quot;</span>
1430:         <span class="ruby-keyword kw">end</span>       
1431:         <span class="ruby-ivar">@format_fmt17</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;12$$$&gt;&quot;</span>,<span class="ruby-ivar">@case_alerk</span>,<span class="ruby-ivar">@format_fmt17</span>)  
1432:         <span class="ruby-comment cmt">#电话        </span>
1433:         <span class="ruby-ivar">@telephone</span> = <span class="ruby-identifier">clerk</span>.<span class="ruby-identifier">telephone</span>
1434:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@telephone</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@telephone</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
1435:             <span class="ruby-ivar">@telephone</span> = <span class="ruby-value str">&quot;no&quot;</span>
1436:         <span class="ruby-keyword kw">end</span>     
1437:         <span class="ruby-ivar">@format_fmt17</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;13$$$&gt;&quot;</span>,<span class="ruby-ivar">@telephone</span>,<span class="ruby-ivar">@format_fmt17</span>)       
1438:         <span class="ruby-comment cmt">#传真</span>
1439:         <span class="ruby-ivar">@fax</span> = <span class="ruby-identifier">clerk</span>.<span class="ruby-identifier">fax</span>
1440:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@fax</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@fax</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
1441:             <span class="ruby-ivar">@fax</span> = <span class="ruby-value str">&quot;no&quot;</span>
1442:         <span class="ruby-keyword kw">end</span>    
1443:         <span class="ruby-ivar">@format_fmt17</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;14$$$&gt;&quot;</span>,<span class="ruby-ivar">@fax</span>,<span class="ruby-ivar">@format_fmt17</span>)     
1444:         <span class="ruby-comment cmt">#电子邮箱</span>
1445:         <span class="ruby-ivar">@email</span> = <span class="ruby-identifier">clerk</span>.<span class="ruby-identifier">email</span>
1446:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@email</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@email</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
1447:             <span class="ruby-ivar">@email</span> = <span class="ruby-value str">&quot;no&quot;</span>
1448:         <span class="ruby-keyword kw">end</span>  
1449:         <span class="ruby-ivar">@format_fmt17</span> = <span class="ruby-identifier">add_last_record</span>(<span class="ruby-value str">&quot;&lt;15$$$&gt;&quot;</span>,<span class="ruby-ivar">@email</span>,<span class="ruby-ivar">@format_fmt17</span>)         
1450:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000160" class="method-detail">
        <a name="M000160"></a>

        <div class="method-heading">
          <a href="#M000160" class="method-signature">
          <span class="method-name">format_letter_fmt18</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000160-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000160-source">
<pre>
      <span class="ruby-comment cmt"># File app/controllers/format_letter_controller.rb, line 1452</span>
1452:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">format_letter_fmt18</span>
1453:         <span class="ruby-comment cmt">#拼接字串，初始化</span>
1454:         <span class="ruby-ivar">@format_fmt18</span> = <span class="ruby-value str">&quot;&quot;</span>  
1455:         <span class="ruby-comment cmt">#函号</span>
1456:         <span class="ruby-ivar">@file_code</span> = <span class="ruby-constant">TbDoc</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:first</span>,<span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">&quot;used = 'Y' and recevice_code = ?&quot;</span>,<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]])
1457:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@file_code</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@file_code</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
1458:             <span class="ruby-ivar">@file_code</span> = <span class="ruby-value str">&quot;no&quot;</span>
1459:         <span class="ruby-keyword kw">else</span>
1460:             <span class="ruby-ivar">@file_code</span> = <span class="ruby-ivar">@file_code</span>.<span class="ruby-identifier">file_code</span>
1461:         <span class="ruby-keyword kw">end</span>
1462:         <span class="ruby-ivar">@format_fmt18</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;01$$$&gt;&quot;</span>,<span class="ruby-ivar">@file_code</span>,<span class="ruby-ivar">@format_fmt18</span>)
1463:         <span class="ruby-comment cmt">#立案号</span>
1464:         <span class="ruby-ivar">@case_code</span> = <span class="ruby-constant">TbCase</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:first</span>, <span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">&quot;used = 'Y' and recevice_code = ?&quot;</span>,<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]]).<span class="ruby-identifier">case_code</span>
1465:         <span class="ruby-ivar">@format_fmt18</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;02$$$&gt;&quot;</span>,<span class="ruby-ivar">@case_code</span>,<span class="ruby-ivar">@format_fmt18</span>)          
1466:         <span class="ruby-comment cmt">#申请人</span>
1467:         <span class="ruby-ivar">@applicants</span> = <span class="ruby-constant">TbParty</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:all</span>,<span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">&quot;used = 'Y' and partytype = 1 and recevice_code = ?&quot;</span>,<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]], <span class="ruby-identifier">:order</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;id&quot;</span>)
1468:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@applicants</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@applicants</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
1469:             <span class="ruby-ivar">@applicant</span> = <span class="ruby-value str">&quot;no&quot;</span>
1470:         <span class="ruby-keyword kw">else</span>
1471:             <span class="ruby-ivar">@applicant</span> = <span class="ruby-value str">&quot;&quot;</span>
1472:             <span class="ruby-ivar">@applicants</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">applicant</span><span class="ruby-operator">|</span>
1473:                 <span class="ruby-ivar">@applicant</span> = <span class="ruby-ivar">@applicant</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">applicant</span>.<span class="ruby-identifier">partyname</span>
1474:             <span class="ruby-keyword kw">end</span>
1475:         <span class="ruby-keyword kw">end</span>        
1476:         <span class="ruby-ivar">@format_fmt18</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;03$$$&gt;&quot;</span>,<span class="ruby-ivar">@applicant</span>,<span class="ruby-ivar">@format_fmt18</span>)
1477:         <span class="ruby-comment cmt">#被申请人</span>
1478:         <span class="ruby-ivar">@respondents</span> = <span class="ruby-constant">TbParty</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:all</span>,<span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">&quot;used = 'Y' and partytype = 2 and recevice_code = ?&quot;</span>,<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]], <span class="ruby-identifier">:order</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;id&quot;</span>)
1479:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@respondent</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@respondent</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
1480:             <span class="ruby-ivar">@respondent</span> = <span class="ruby-value str">&quot;no&quot;</span>
1481:         <span class="ruby-keyword kw">else</span>
1482:             <span class="ruby-ivar">@respondent</span> = <span class="ruby-value str">&quot;&quot;</span>
1483:             <span class="ruby-ivar">@respondents</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">resp</span><span class="ruby-operator">|</span>
1484:                 <span class="ruby-ivar">@respondent</span> = <span class="ruby-ivar">@respondent</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">resp</span>.<span class="ruby-identifier">partyname</span>
1485:             <span class="ruby-keyword kw">end</span>
1486:         <span class="ruby-keyword kw">end</span>       
1487:         <span class="ruby-ivar">@format_fmt18</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;04$$$&gt;&quot;</span>,<span class="ruby-ivar">@respondent</span>,<span class="ruby-ivar">@format_fmt18</span>)
1488:         <span class="ruby-comment cmt">#日期</span>
1489:         <span class="ruby-ivar">@date_of_letter</span> = <span class="ruby-constant">Time</span>.<span class="ruby-identifier">now</span>.<span class="ruby-identifier">to_s</span>(<span class="ruby-identifier">:db</span>)
1490:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@date_of_letter</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@date_of_letter</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
1491:             <span class="ruby-ivar">@date_of_letter</span> = <span class="ruby-value str">&quot;no&quot;</span>
1492:             <span class="ruby-ivar">@format_fmt18</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;05$$$&gt;&quot;</span>,<span class="ruby-ivar">@date_of_letter</span>,<span class="ruby-ivar">@format_fmt18</span>) 
1493:             <span class="ruby-ivar">@format_fmt18</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;06$$$&gt;&quot;</span>,<span class="ruby-ivar">@date_of_letter</span>,<span class="ruby-ivar">@format_fmt18</span>)
1494:             <span class="ruby-ivar">@format_fmt18</span> = <span class="ruby-identifier">add_last_record</span>(<span class="ruby-value str">&quot;&lt;07$$$&gt;&quot;</span>,<span class="ruby-ivar">@date_of_letter</span>,<span class="ruby-ivar">@format_fmt18</span>)
1495:         <span class="ruby-keyword kw">else</span>
1496:             <span class="ruby-identifier">arr_date</span> = <span class="ruby-ivar">@date_of_letter</span>.<span class="ruby-identifier">to_s</span>.<span class="ruby-identifier">split</span>(<span class="ruby-value str">&quot;-&quot;</span>)
1497:             <span class="ruby-ivar">@format_fmt18</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;05$$$&gt;&quot;</span>,<span class="ruby-identifier">arr_date</span>[<span class="ruby-value">0</span>],<span class="ruby-ivar">@format_fmt18</span>) 
1498:             <span class="ruby-ivar">@format_fmt18</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;06$$$&gt;&quot;</span>,<span class="ruby-identifier">arr_date</span>[<span class="ruby-value">1</span>],<span class="ruby-ivar">@format_fmt18</span>)
1499:             <span class="ruby-ivar">@format_fmt18</span> = <span class="ruby-identifier">add_last_record</span>(<span class="ruby-value str">&quot;&lt;07$$$&gt;&quot;</span>,<span class="ruby-identifier">arr_date</span>[<span class="ruby-value">2</span>].<span class="ruby-identifier">slice</span>(<span class="ruby-value">0</span>, <span class="ruby-value">2</span>),<span class="ruby-ivar">@format_fmt18</span>)            
1500:         <span class="ruby-keyword kw">end</span>   
1501:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000161" class="method-detail">
        <a name="M000161"></a>

        <div class="method-heading">
          <a href="#M000161" class="method-signature">
          <span class="method-name">format_letter_fmt19</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
当事人是可选的，地址相应改变 空缺 ###
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000161-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000161-source">
<pre>
      <span class="ruby-comment cmt"># File app/controllers/format_letter_controller.rb, line 1503</span>
1503:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">format_letter_fmt19</span>
1504:         <span class="ruby-comment cmt">#拼接字串，初始化</span>
1505:         <span class="ruby-ivar">@format_fmt19</span> = <span class="ruby-value str">&quot;&quot;</span>  
1506:         <span class="ruby-comment cmt">#函号</span>
1507:         <span class="ruby-ivar">@file_code</span> = <span class="ruby-constant">TbDoc</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:first</span>,<span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">&quot;used = 'Y' and recevice_code = ?&quot;</span>,<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]])
1508:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@file_code</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@file_code</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
1509:             <span class="ruby-ivar">@file_code</span> = <span class="ruby-value str">&quot;no&quot;</span>
1510:         <span class="ruby-keyword kw">else</span>
1511:             <span class="ruby-ivar">@file_code</span> = <span class="ruby-ivar">@file_code</span>.<span class="ruby-identifier">file_code</span>
1512:         <span class="ruby-keyword kw">end</span>
1513:         <span class="ruby-ivar">@format_fmt19</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;01$$$&gt;&quot;</span>,<span class="ruby-ivar">@file_code</span>,<span class="ruby-ivar">@format_fmt19</span>)         
1514:         <span class="ruby-comment cmt">#当事人</span>
1515:         <span class="ruby-comment cmt">#</span>
1516:         <span class="ruby-comment cmt">#</span>
1517:         <span class="ruby-comment cmt">#地址</span>
1518:         <span class="ruby-comment cmt">#</span>
1519:         <span class="ruby-comment cmt">#</span>
1520:         <span class="ruby-comment cmt">#日期</span>
1521:         <span class="ruby-ivar">@date_of_letter</span> = <span class="ruby-constant">Time</span>.<span class="ruby-identifier">now</span>.<span class="ruby-identifier">to_s</span>(<span class="ruby-identifier">:db</span>)
1522:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@date_of_letter</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@date_of_letter</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
1523:             <span class="ruby-ivar">@date_of_letter</span> = <span class="ruby-value str">&quot;no&quot;</span>
1524:             <span class="ruby-ivar">@format_fmt19</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;04$$$&gt;&quot;</span>,<span class="ruby-ivar">@date_of_letter</span>,<span class="ruby-ivar">@format_fmt19</span>) 
1525:             <span class="ruby-ivar">@format_fmt19</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;05$$$&gt;&quot;</span>,<span class="ruby-ivar">@date_of_letter</span>,<span class="ruby-ivar">@format_fmt19</span>)
1526:             <span class="ruby-ivar">@format_fmt19</span> = <span class="ruby-identifier">add_last_record</span>(<span class="ruby-value str">&quot;&lt;06$$$&gt;&quot;</span>,<span class="ruby-ivar">@date_of_letter</span>,<span class="ruby-ivar">@format_fmt19</span>)
1527:         <span class="ruby-keyword kw">else</span>
1528:             <span class="ruby-identifier">arr_date</span> = <span class="ruby-ivar">@date_of_letter</span>.<span class="ruby-identifier">to_s</span>.<span class="ruby-identifier">split</span>(<span class="ruby-value str">&quot;-&quot;</span>)
1529:             <span class="ruby-ivar">@format_fmt19</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;04$$$&gt;&quot;</span>,<span class="ruby-identifier">arr_date</span>[<span class="ruby-value">0</span>],<span class="ruby-ivar">@format_fmt19</span>) 
1530:             <span class="ruby-ivar">@format_fmt19</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;05$$$&gt;&quot;</span>,<span class="ruby-identifier">arr_date</span>[<span class="ruby-value">1</span>],<span class="ruby-ivar">@format_fmt19</span>)
1531:             <span class="ruby-ivar">@format_fmt19</span> = <span class="ruby-identifier">add_last_record</span>(<span class="ruby-value str">&quot;&lt;06$$$&gt;&quot;</span>,<span class="ruby-identifier">arr_date</span>[<span class="ruby-value">2</span>].<span class="ruby-identifier">slice</span>(<span class="ruby-value">0</span>, <span class="ruby-value">2</span>),<span class="ruby-ivar">@format_fmt19</span>)            
1532:         <span class="ruby-keyword kw">end</span>   
1533:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000162" class="method-detail">
        <a name="M000162"></a>

        <div class="method-heading">
          <a href="#M000162" class="method-signature">
          <span class="method-name">format_letter_fmt20</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000162-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000162-source">
<pre>
      <span class="ruby-comment cmt"># File app/controllers/format_letter_controller.rb, line 1535</span>
1535:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">format_letter_fmt20</span>
1536:         <span class="ruby-comment cmt">#拼接字串，初始化</span>
1537:         <span class="ruby-ivar">@format_fmt20</span> = <span class="ruby-value str">&quot;&quot;</span>  
1538:         <span class="ruby-comment cmt">#函号</span>
1539:         <span class="ruby-ivar">@file_code</span> = <span class="ruby-constant">TbDoc</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:first</span>,<span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">&quot;used = 'Y' and recevice_code = ?&quot;</span>,<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]])
1540:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@file_code</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@file_code</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
1541:             <span class="ruby-ivar">@file_code</span> = <span class="ruby-value str">&quot;no&quot;</span>
1542:         <span class="ruby-keyword kw">else</span>
1543:             <span class="ruby-ivar">@file_code</span> = <span class="ruby-ivar">@file_code</span>.<span class="ruby-identifier">file_code</span>
1544:         <span class="ruby-keyword kw">end</span>
1545:         <span class="ruby-ivar">@format_fmt20</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;01$$$&gt;&quot;</span>,<span class="ruby-ivar">@file_code</span>,<span class="ruby-ivar">@format_fmt20</span>) 
1546:         <span class="ruby-comment cmt">#立案号</span>
1547:         <span class="ruby-ivar">@case_code</span> = <span class="ruby-constant">TbCase</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:first</span>, <span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">&quot;used = 'Y' and recevice_code = ?&quot;</span>,<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]]).<span class="ruby-identifier">case_code</span>
1548:         <span class="ruby-ivar">@format_fmt20</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;02$$$&gt;&quot;</span>,<span class="ruby-ivar">@case_code</span>,<span class="ruby-ivar">@format_fmt20</span>)          
1549:         <span class="ruby-comment cmt">#申请人</span>
1550:         <span class="ruby-ivar">@applicants</span> = <span class="ruby-constant">TbParty</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:all</span>,<span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">&quot;used = 'Y' and partytype = 1 and recevice_code = ?&quot;</span>,<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]], <span class="ruby-identifier">:order</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;id&quot;</span>)
1551:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@applicants</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@applicants</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
1552:             <span class="ruby-ivar">@applicant</span> = <span class="ruby-value str">&quot;no&quot;</span>
1553:         <span class="ruby-keyword kw">else</span>
1554:             <span class="ruby-ivar">@applicant</span> = <span class="ruby-value str">&quot;&quot;</span>
1555:             <span class="ruby-ivar">@applicants</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">applicant</span><span class="ruby-operator">|</span>
1556:                 <span class="ruby-ivar">@applicant</span> = <span class="ruby-ivar">@applicant</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">applicant</span>.<span class="ruby-identifier">partyname</span>
1557:             <span class="ruby-keyword kw">end</span>
1558:         <span class="ruby-keyword kw">end</span>        
1559:         <span class="ruby-ivar">@format_fmt20</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;03$$$&gt;&quot;</span>,<span class="ruby-ivar">@applicant</span>,<span class="ruby-ivar">@format_fmt20</span>)
1560:         <span class="ruby-comment cmt">#被申请人</span>
1561:         <span class="ruby-ivar">@respondents</span> = <span class="ruby-constant">TbParty</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:all</span>,<span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">&quot;used = 'Y' and partytype = 2 and recevice_code = ?&quot;</span>,<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]], <span class="ruby-identifier">:order</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;id&quot;</span>)
1562:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@respondent</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@respondent</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
1563:             <span class="ruby-ivar">@respondent</span> = <span class="ruby-value str">&quot;no&quot;</span>
1564:         <span class="ruby-keyword kw">else</span>
1565:             <span class="ruby-ivar">@respondent</span> = <span class="ruby-value str">&quot;&quot;</span>
1566:             <span class="ruby-ivar">@respondents</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">resp</span><span class="ruby-operator">|</span>
1567:                 <span class="ruby-ivar">@respondent</span> = <span class="ruby-ivar">@respondent</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">resp</span>.<span class="ruby-identifier">partyname</span>
1568:             <span class="ruby-keyword kw">end</span>
1569:         <span class="ruby-keyword kw">end</span>       
1570:         <span class="ruby-ivar">@format_fmt20</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;04$$$&gt;&quot;</span>,<span class="ruby-ivar">@respondent</span>,<span class="ruby-ivar">@format_fmt20</span>)
1571:         <span class="ruby-comment cmt">#日期</span>
1572:         <span class="ruby-ivar">@date_of_letter</span> = <span class="ruby-constant">Time</span>.<span class="ruby-identifier">now</span>.<span class="ruby-identifier">to_s</span>(<span class="ruby-identifier">:db</span>)
1573:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@date_of_letter</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@date_of_letter</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
1574:             <span class="ruby-ivar">@date_of_letter</span> = <span class="ruby-value str">&quot;no&quot;</span>
1575:             <span class="ruby-ivar">@format_fmt20</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;05$$$&gt;&quot;</span>,<span class="ruby-ivar">@date_of_letter</span>,<span class="ruby-ivar">@format_fmt20</span>) 
1576:             <span class="ruby-ivar">@format_fmt20</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;06$$$&gt;&quot;</span>,<span class="ruby-ivar">@date_of_letter</span>,<span class="ruby-ivar">@format_fmt20</span>)
1577:             <span class="ruby-ivar">@format_fmt20</span> = <span class="ruby-identifier">add_last_record</span>(<span class="ruby-value str">&quot;&lt;07$$$&gt;&quot;</span>,<span class="ruby-ivar">@date_of_letter</span>,<span class="ruby-ivar">@format_fmt20</span>)
1578:         <span class="ruby-keyword kw">else</span>
1579:             <span class="ruby-identifier">arr_date</span> = <span class="ruby-ivar">@date_of_letter</span>.<span class="ruby-identifier">to_s</span>.<span class="ruby-identifier">split</span>(<span class="ruby-value str">&quot;-&quot;</span>)
1580:             <span class="ruby-ivar">@format_fmt20</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;05$$$&gt;&quot;</span>,<span class="ruby-identifier">arr_date</span>[<span class="ruby-value">0</span>],<span class="ruby-ivar">@format_fmt20</span>) 
1581:             <span class="ruby-ivar">@format_fmt20</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;06$$$&gt;&quot;</span>,<span class="ruby-identifier">arr_date</span>[<span class="ruby-value">1</span>],<span class="ruby-ivar">@format_fmt20</span>)
1582:             <span class="ruby-ivar">@format_fmt20</span> = <span class="ruby-identifier">add_last_record</span>(<span class="ruby-value str">&quot;&lt;07$$$&gt;&quot;</span>,<span class="ruby-identifier">arr_date</span>[<span class="ruby-value">2</span>].<span class="ruby-identifier">slice</span>(<span class="ruby-value">0</span>, <span class="ruby-value">2</span>),<span class="ruby-ivar">@format_fmt20</span>)            
1583:         <span class="ruby-keyword kw">end</span>   
1584:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000163" class="method-detail">
        <a name="M000163"></a>

        <div class="method-heading">
          <a href="#M000163" class="method-signature">
          <span class="method-name">format_letter_fmt23b</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000163-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000163-source">
<pre>
      <span class="ruby-comment cmt"># File app/controllers/format_letter_controller.rb, line 1586</span>
1586:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">format_letter_fmt23b</span>
1587:         <span class="ruby-comment cmt">#拼接字串，初始化</span>
1588:         <span class="ruby-ivar">@format_fmt23b</span> = <span class="ruby-value str">&quot;&quot;</span>  
1589:         <span class="ruby-comment cmt">#立案号</span>
1590:         <span class="ruby-ivar">@case_code</span> = <span class="ruby-constant">TbCase</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:first</span>, <span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">&quot;used = 'Y' and recevice_code = ?&quot;</span>,<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]]).<span class="ruby-identifier">case_code</span>
1591:         <span class="ruby-ivar">@format_fmt23b</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;01$$$&gt;&quot;</span>,<span class="ruby-ivar">@case_code</span>,<span class="ruby-ivar">@format_fmt23b</span>)         
1592:         <span class="ruby-comment cmt">#申请人</span>
1593:         <span class="ruby-ivar">@applicants</span> = <span class="ruby-constant">TbParty</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:all</span>,<span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">&quot;used = 'Y' and partytype = 1 and recevice_code = ?&quot;</span>,<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]], <span class="ruby-identifier">:order</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;id&quot;</span>)
1594:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@applicants</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@applicants</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
1595:             <span class="ruby-ivar">@applicant</span> = <span class="ruby-value str">&quot;no&quot;</span>
1596:         <span class="ruby-keyword kw">else</span>
1597:             <span class="ruby-ivar">@applicant</span> = <span class="ruby-value str">&quot;&quot;</span>
1598:             <span class="ruby-ivar">@applicants</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">applicant</span><span class="ruby-operator">|</span>
1599:                 <span class="ruby-ivar">@applicant</span> = <span class="ruby-ivar">@applicant</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">applicant</span>.<span class="ruby-identifier">partyname</span>
1600:             <span class="ruby-keyword kw">end</span>
1601:         <span class="ruby-keyword kw">end</span>        
1602:         <span class="ruby-ivar">@format_fmt23b</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;02$$$&gt;&quot;</span>,<span class="ruby-ivar">@applicant</span>,<span class="ruby-ivar">@format_fmt23b</span>)
1603:         <span class="ruby-comment cmt">#申请人代理人(可多名？）</span>
1604:         <span class="ruby-ivar">@applicant_agent</span> = <span class="ruby-constant">TbAgent</span>.<span class="ruby-identifier">find</span>(<span class="ruby-ivar">@applicants</span>.<span class="ruby-identifier">id</span>)
1605:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@applicant_agent</span> <span class="ruby-operator">!=</span> <span class="ruby-keyword kw">nil</span>
1606:             <span class="ruby-ivar">@applicant_agent</span> = <span class="ruby-ivar">@applicant_agent</span>.<span class="ruby-identifier">name</span>
1607:             <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@applicant_agent</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
1608:                 <span class="ruby-ivar">@applicant_agent</span> = <span class="ruby-value str">&quot;no&quot;</span>
1609:             <span class="ruby-keyword kw">end</span>
1610:         <span class="ruby-keyword kw">else</span>
1611:             <span class="ruby-ivar">@applicant_agent</span> = <span class="ruby-value str">&quot;no&quot;</span>
1612:         <span class="ruby-keyword kw">end</span>
1613:         <span class="ruby-ivar">@format_fmt23b</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;02$$$&gt;&quot;</span>,<span class="ruby-ivar">@applicant_agent</span>,<span class="ruby-ivar">@format_fmt23b</span>)
1614:         <span class="ruby-comment cmt">#被申请人</span>
1615:         <span class="ruby-ivar">@respondents</span> = <span class="ruby-constant">TbParty</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:all</span>,<span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">&quot;used = 'Y' and partytype = 2 and recevice_code = ?&quot;</span>,<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]], <span class="ruby-identifier">:order</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;id&quot;</span>)
1616:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@respondent</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@respondent</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
1617:             <span class="ruby-ivar">@respondent</span> = <span class="ruby-value str">&quot;no&quot;</span>
1618:         <span class="ruby-keyword kw">else</span>
1619:             <span class="ruby-ivar">@respondent</span> = <span class="ruby-value str">&quot;&quot;</span>
1620:             <span class="ruby-ivar">@respondents</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">resp</span><span class="ruby-operator">|</span>
1621:                 <span class="ruby-ivar">@respondent</span> = <span class="ruby-ivar">@respondent</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">resp</span>.<span class="ruby-identifier">partyname</span>
1622:             <span class="ruby-keyword kw">end</span>
1623:         <span class="ruby-keyword kw">end</span>       
1624:         <span class="ruby-ivar">@format_fmt23b</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;04$$$&gt;&quot;</span>,<span class="ruby-ivar">@respondent</span>,<span class="ruby-ivar">@format_fmt23b</span>)
1625:         <span class="ruby-comment cmt">#被申请人代理人(可多名？）</span>
1626:         <span class="ruby-ivar">@respondent_agent</span> = <span class="ruby-constant">TbAgent</span>.<span class="ruby-identifier">find</span>(<span class="ruby-ivar">@respondents</span>.<span class="ruby-identifier">id</span>)
1627:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@respondent_agent</span> <span class="ruby-operator">!=</span> <span class="ruby-keyword kw">nil</span>
1628:             <span class="ruby-ivar">@respondent_agent</span> = <span class="ruby-ivar">@respondent_agent</span>.<span class="ruby-identifier">name</span>
1629:             <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@respondent_agent</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
1630:                 <span class="ruby-ivar">@respondent_agent</span> = <span class="ruby-value str">&quot;no&quot;</span>
1631:             <span class="ruby-keyword kw">end</span>
1632:         <span class="ruby-keyword kw">else</span>
1633:             <span class="ruby-ivar">@respondent_agent</span> = <span class="ruby-value str">&quot;no&quot;</span>
1634:         <span class="ruby-keyword kw">end</span>
1635:         <span class="ruby-ivar">@format_fmt23b</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;02$$$&gt;&quot;</span>,<span class="ruby-ivar">@respondent_agent</span>,<span class="ruby-ivar">@format_fmt23b</span>)
1636:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000164" class="method-detail">
        <a name="M000164"></a>

        <div class="method-heading">
          <a href="#M000164" class="method-signature">
          <span class="method-name">format_letter_fmt23e</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000164-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000164-source">
<pre>
      <span class="ruby-comment cmt"># File app/controllers/format_letter_controller.rb, line 1638</span>
1638:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">format_letter_fmt23e</span>
1639:         <span class="ruby-comment cmt">#拼接字串，初始化</span>
1640:         <span class="ruby-ivar">@format_fmt23e</span> = <span class="ruby-value str">&quot;&quot;</span>  
1641:         <span class="ruby-comment cmt">#立案号</span>
1642:         <span class="ruby-ivar">@case_code</span> = <span class="ruby-constant">TbCase</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:first</span>, <span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">&quot;used = 'Y' and recevice_code = ?&quot;</span>,<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]]).<span class="ruby-identifier">case_code</span>
1643:         <span class="ruby-ivar">@format_fmt23e</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;01$$$&gt;&quot;</span>,<span class="ruby-ivar">@case_code</span>,<span class="ruby-ivar">@format_fmt23e</span>)         
1644:         <span class="ruby-comment cmt">#申请人</span>
1645:         <span class="ruby-ivar">@applicants</span> = <span class="ruby-constant">TbParty</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:all</span>,<span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">&quot;used = 'Y' and partytype = 1 and recevice_code = ?&quot;</span>,<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]], <span class="ruby-identifier">:order</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;id&quot;</span>)
1646:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@applicants</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@applicants</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
1647:             <span class="ruby-ivar">@applicant</span> = <span class="ruby-value str">&quot;no&quot;</span>
1648:         <span class="ruby-keyword kw">else</span>
1649:             <span class="ruby-ivar">@applicant</span> = <span class="ruby-value str">&quot;&quot;</span>
1650:             <span class="ruby-ivar">@applicants</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">applicant</span><span class="ruby-operator">|</span>
1651:                 <span class="ruby-ivar">@applicant</span> = <span class="ruby-ivar">@applicant</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">applicant</span>.<span class="ruby-identifier">partyname</span>
1652:             <span class="ruby-keyword kw">end</span>
1653:         <span class="ruby-keyword kw">end</span>        
1654:         <span class="ruby-ivar">@format_fmt23e</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;02$$$&gt;&quot;</span>,<span class="ruby-ivar">@applicant</span>,<span class="ruby-ivar">@format_fmt23e</span>)
1655:         <span class="ruby-comment cmt">#被申请人</span>
1656:         <span class="ruby-ivar">@respondents</span> = <span class="ruby-constant">TbParty</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:all</span>,<span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">&quot;used = 'Y' and partytype = 2 and recevice_code = ?&quot;</span>,<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]], <span class="ruby-identifier">:order</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;id&quot;</span>)
1657:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@respondent</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@respondent</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
1658:             <span class="ruby-ivar">@respondent</span> = <span class="ruby-value str">&quot;no&quot;</span>
1659:         <span class="ruby-keyword kw">else</span>
1660:             <span class="ruby-ivar">@respondent</span> = <span class="ruby-value str">&quot;&quot;</span>
1661:             <span class="ruby-ivar">@respondents</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">resp</span><span class="ruby-operator">|</span>
1662:                 <span class="ruby-ivar">@respondent</span> = <span class="ruby-ivar">@respondent</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">resp</span>.<span class="ruby-identifier">partyname</span>
1663:             <span class="ruby-keyword kw">end</span>
1664:         <span class="ruby-keyword kw">end</span>       
1665:         <span class="ruby-ivar">@format_fmt23e</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;03$$$&gt;&quot;</span>,<span class="ruby-ivar">@respondent</span>,<span class="ruby-ivar">@format_fmt23e</span>)        
1666:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000165" class="method-detail">
        <a name="M000165"></a>

        <div class="method-heading">
          <a href="#M000165" class="method-signature">
          <span class="method-name">format_letter_fmt24</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000165-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000165-source">
<pre>
      <span class="ruby-comment cmt"># File app/controllers/format_letter_controller.rb, line 1668</span>
1668:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">format_letter_fmt24</span>
1669:         <span class="ruby-comment cmt">#拼接字串，初始化</span>
1670:         <span class="ruby-ivar">@format_fmt24</span> = <span class="ruby-value str">&quot;&quot;</span>  
1671:         <span class="ruby-comment cmt">#函号</span>
1672:         <span class="ruby-ivar">@file_code</span> = <span class="ruby-constant">TbDoc</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:first</span>,<span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">&quot;used = 'Y' and recevice_code = ?&quot;</span>,<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]])
1673:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@file_code</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@file_code</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
1674:             <span class="ruby-ivar">@file_code</span> = <span class="ruby-value str">&quot;no&quot;</span>
1675:         <span class="ruby-keyword kw">else</span>
1676:             <span class="ruby-ivar">@file_code</span> = <span class="ruby-ivar">@file_code</span>.<span class="ruby-identifier">file_code</span>
1677:         <span class="ruby-keyword kw">end</span>
1678:         <span class="ruby-ivar">@format_fmt24</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;01$$$&gt;&quot;</span>,<span class="ruby-ivar">@file_code</span>,<span class="ruby-ivar">@format_fmt24</span>)
1679:         <span class="ruby-comment cmt">#立案号</span>
1680:         <span class="ruby-ivar">@case_code</span> = <span class="ruby-constant">TbCase</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:first</span>, <span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">&quot;used = 'Y' and recevice_code = ?&quot;</span>,<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]]).<span class="ruby-identifier">case_code</span>
1681:         <span class="ruby-ivar">@format_fmt24</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;02$$$&gt;&quot;</span>,<span class="ruby-ivar">@case_code</span>,<span class="ruby-ivar">@format_fmt24</span>)          
1682:         <span class="ruby-comment cmt">#申请人</span>
1683:         <span class="ruby-ivar">@applicants</span> = <span class="ruby-constant">TbParty</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:all</span>,<span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">&quot;used = 'Y' and partytype = 1 and recevice_code = ?&quot;</span>,<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]], <span class="ruby-identifier">:order</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;id&quot;</span>)
1684:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@applicants</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@applicants</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
1685:             <span class="ruby-ivar">@applicant</span> = <span class="ruby-value str">&quot;no&quot;</span>
1686:         <span class="ruby-keyword kw">else</span>
1687:             <span class="ruby-ivar">@applicant</span> = <span class="ruby-value str">&quot;&quot;</span>
1688:             <span class="ruby-ivar">@applicants</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">applicant</span><span class="ruby-operator">|</span>
1689:                 <span class="ruby-ivar">@applicant</span> = <span class="ruby-ivar">@applicant</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">applicant</span>.<span class="ruby-identifier">partyname</span>
1690:             <span class="ruby-keyword kw">end</span>
1691:         <span class="ruby-keyword kw">end</span>        
1692:         <span class="ruby-ivar">@format_fmt24</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;03$$$&gt;&quot;</span>,<span class="ruby-ivar">@applicant</span>,<span class="ruby-ivar">@format_fmt24</span>) 
1693:         <span class="ruby-comment cmt">#被申请人</span>
1694:         <span class="ruby-ivar">@respondents</span> = <span class="ruby-constant">TbParty</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:all</span>,<span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">&quot;used = 'Y' and partytype = 2 and recevice_code = ?&quot;</span>,<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]], <span class="ruby-identifier">:order</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;id&quot;</span>)
1695:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@respondent</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@respondent</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
1696:             <span class="ruby-ivar">@respondent</span> = <span class="ruby-value str">&quot;no&quot;</span>
1697:         <span class="ruby-keyword kw">else</span>
1698:             <span class="ruby-ivar">@respondent</span> = <span class="ruby-value str">&quot;&quot;</span>
1699:             <span class="ruby-ivar">@respondents</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">resp</span><span class="ruby-operator">|</span>
1700:                 <span class="ruby-ivar">@respondent</span> = <span class="ruby-ivar">@respondent</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">resp</span>.<span class="ruby-identifier">partyname</span>
1701:             <span class="ruby-keyword kw">end</span>
1702:         <span class="ruby-keyword kw">end</span>       
1703:         <span class="ruby-ivar">@format_fmt24</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;04$$$&gt;&quot;</span>,<span class="ruby-ivar">@respondent</span>,<span class="ruby-ivar">@format_fmt24</span>)         
1704:         <span class="ruby-comment cmt">#申请人仲裁员</span>
1705:         <span class="ruby-ivar">@applicant_arbitrator</span> = <span class="ruby-identifier">applicant_arbitrator</span>(<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>])
1706:         <span class="ruby-ivar">@format_fmt24</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;05$$$&gt;&quot;</span>,<span class="ruby-ivar">@applicant_arbitrator</span>,<span class="ruby-ivar">@format_fmt24</span>)        
1707:         <span class="ruby-comment cmt">#被申请人仲裁员</span>
1708:         <span class="ruby-ivar">@respondent_arbitrator</span> = <span class="ruby-identifier">respondent_arbitrator</span>(<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>])
1709:         <span class="ruby-ivar">@format_fmt24</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;06$$$&gt;&quot;</span>,<span class="ruby-ivar">@respondent_arbitrator</span>,<span class="ruby-ivar">@format_fmt24</span>)
1710:         <span class="ruby-comment cmt">#提交限期--目前是15天，最终可能依据程序判断，改成普通程序15天，或者简易程序7天之类的</span>
1711:         <span class="ruby-ivar">@time_limit</span> = <span class="ruby-value str">&quot;15&quot;</span>
1712:         <span class="ruby-ivar">@format_fmt24</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;07$$$&gt;&quot;</span>,<span class="ruby-ivar">@time_limit</span>,<span class="ruby-ivar">@format_fmt24</span>)
1713:         <span class="ruby-comment cmt">#日期</span>
1714:         <span class="ruby-ivar">@date_of_letter</span> = <span class="ruby-constant">Time</span>.<span class="ruby-identifier">now</span>.<span class="ruby-identifier">to_s</span>(<span class="ruby-identifier">:db</span>)
1715:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@date_of_letter</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@date_of_letter</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
1716:             <span class="ruby-ivar">@date_of_letter</span> = <span class="ruby-value str">&quot;no&quot;</span>
1717:             <span class="ruby-ivar">@format_fmt24</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;08$$$&gt;&quot;</span>,<span class="ruby-ivar">@date_of_letter</span>,<span class="ruby-ivar">@format_fmt24</span>) 
1718:             <span class="ruby-ivar">@format_fmt24</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;09$$$&gt;&quot;</span>,<span class="ruby-ivar">@date_of_letter</span>,<span class="ruby-ivar">@format_fmt24</span>)
1719:             <span class="ruby-ivar">@format_fmt24</span> = <span class="ruby-identifier">add_last_record</span>(<span class="ruby-value str">&quot;&lt;10$$$&gt;&quot;</span>,<span class="ruby-ivar">@date_of_letter</span>,<span class="ruby-ivar">@format_fmt24</span>)
1720:         <span class="ruby-keyword kw">else</span>
1721:             <span class="ruby-identifier">arr_date</span> = <span class="ruby-ivar">@date_of_letter</span>.<span class="ruby-identifier">to_s</span>.<span class="ruby-identifier">split</span>(<span class="ruby-value str">&quot;-&quot;</span>)
1722:             <span class="ruby-ivar">@format_fmt24</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;08$$$&gt;&quot;</span>,<span class="ruby-identifier">arr_date</span>[<span class="ruby-value">0</span>],<span class="ruby-ivar">@format_fmt24</span>) 
1723:             <span class="ruby-ivar">@format_fmt24</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;09$$$&gt;&quot;</span>,<span class="ruby-identifier">arr_date</span>[<span class="ruby-value">1</span>],<span class="ruby-ivar">@format_fmt24</span>)
1724:             <span class="ruby-ivar">@format_fmt24</span> = <span class="ruby-identifier">add_last_record</span>(<span class="ruby-value str">&quot;&lt;10$$$&gt;&quot;</span>,<span class="ruby-identifier">arr_date</span>[<span class="ruby-value">2</span>].<span class="ruby-identifier">slice</span>(<span class="ruby-value">0</span>, <span class="ruby-value">2</span>),<span class="ruby-ivar">@format_fmt24</span>)            
1725:         <span class="ruby-keyword kw">end</span>   
1726:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000166" class="method-detail">
        <a name="M000166"></a>

        <div class="method-heading">
          <a href="#M000166" class="method-signature">
          <span class="method-name">format_letter_fmt26</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000166-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000166-source">
<pre>
      <span class="ruby-comment cmt"># File app/controllers/format_letter_controller.rb, line 1728</span>
1728:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">format_letter_fmt26</span>
1729:         <span class="ruby-comment cmt">#拼接字串，初始化</span>
1730:         <span class="ruby-ivar">@format_fmt26</span> = <span class="ruby-value str">&quot;&quot;</span>  
1731:         <span class="ruby-comment cmt">#函号</span>
1732:         <span class="ruby-ivar">@file_code</span> = <span class="ruby-constant">TbDoc</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:first</span>,<span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">&quot;used = 'Y' and recevice_code = ?&quot;</span>,<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]])
1733:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@file_code</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@file_code</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
1734:             <span class="ruby-ivar">@file_code</span> = <span class="ruby-value str">&quot;no&quot;</span>
1735:         <span class="ruby-keyword kw">else</span>
1736:             <span class="ruby-ivar">@file_code</span> = <span class="ruby-ivar">@file_code</span>.<span class="ruby-identifier">file_code</span>
1737:         <span class="ruby-keyword kw">end</span>
1738:         <span class="ruby-ivar">@format_fmt26</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;01$$$&gt;&quot;</span>,<span class="ruby-ivar">@file_code</span>,<span class="ruby-ivar">@format_fmt26</span>)
1739:         <span class="ruby-comment cmt">#申请人</span>
1740:         <span class="ruby-ivar">@applicants</span> = <span class="ruby-constant">TbParty</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:all</span>,<span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">&quot;used = 'Y' and partytype = 1 and recevice_code = ?&quot;</span>,<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]], <span class="ruby-identifier">:order</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;id&quot;</span>)
1741:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@applicants</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@applicants</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
1742:             <span class="ruby-ivar">@applicant</span> = <span class="ruby-value str">&quot;no&quot;</span>
1743:         <span class="ruby-keyword kw">else</span>
1744:             <span class="ruby-ivar">@applicant</span> = <span class="ruby-value str">&quot;&quot;</span>
1745:             <span class="ruby-ivar">@applicants</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">applicant</span><span class="ruby-operator">|</span>
1746:                 <span class="ruby-ivar">@applicant</span> = <span class="ruby-ivar">@applicant</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">applicant</span>.<span class="ruby-identifier">partyname</span>
1747:             <span class="ruby-keyword kw">end</span>
1748:         <span class="ruby-keyword kw">end</span>        
1749:         <span class="ruby-ivar">@format_fmt26</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;02$$$&gt;&quot;</span>,<span class="ruby-ivar">@applicant</span>,<span class="ruby-ivar">@format_fmt26</span>)
1750:         <span class="ruby-comment cmt">#被申请人</span>
1751:         <span class="ruby-ivar">@respondents</span> = <span class="ruby-constant">TbParty</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:all</span>,<span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">&quot;used = 'Y' and partytype = 2 and recevice_code = ?&quot;</span>,<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]], <span class="ruby-identifier">:order</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;id&quot;</span>)
1752:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@respondent</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@respondent</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
1753:             <span class="ruby-ivar">@respondent</span> = <span class="ruby-value str">&quot;no&quot;</span>
1754:         <span class="ruby-keyword kw">else</span>
1755:             <span class="ruby-ivar">@respondent</span> = <span class="ruby-value str">&quot;&quot;</span>
1756:             <span class="ruby-ivar">@respondents</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">resp</span><span class="ruby-operator">|</span>
1757:                 <span class="ruby-ivar">@respondent</span> = <span class="ruby-ivar">@respondent</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">resp</span>.<span class="ruby-identifier">partyname</span>
1758:             <span class="ruby-keyword kw">end</span>
1759:         <span class="ruby-keyword kw">end</span>       
1760:         <span class="ruby-ivar">@format_fmt26</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;03$$$&gt;&quot;</span>,<span class="ruby-ivar">@respondent</span>,<span class="ruby-ivar">@format_fmt26</span>)
1761:         <span class="ruby-comment cmt">#立案号</span>
1762:         <span class="ruby-ivar">@case_code</span> = <span class="ruby-constant">TbCase</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:first</span>, <span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">&quot;used = 'Y' and recevice_code = ?&quot;</span>,<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]]).<span class="ruby-identifier">case_code</span>
1763:         <span class="ruby-ivar">@format_fmt26</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;04$$$&gt;&quot;</span>,<span class="ruby-ivar">@case_code</span>,<span class="ruby-ivar">@format_fmt26</span>)  
1764:         <span class="ruby-comment cmt">#首席仲裁员</span>
1765:         <span class="ruby-ivar">@chief_arbitrator</span> = <span class="ruby-identifier">chief_arbitrator</span>(<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>])
1766:         <span class="ruby-ivar">@format_fmt26</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;05$$$&gt;&quot;</span>,<span class="ruby-ivar">@chief_arbitrator</span>,<span class="ruby-ivar">@format_fmt26</span>)
1767:         <span class="ruby-ivar">@format_fmt26</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;13$$$&gt;&quot;</span>,<span class="ruby-ivar">@chief_arbitrator</span>,<span class="ruby-ivar">@format_fmt26</span>)
1768:         <span class="ruby-comment cmt">#申请人仲裁员</span>
1769:         <span class="ruby-ivar">@applicant_arbitrator</span> = <span class="ruby-identifier">applicant_arbitrator</span>(<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>])
1770:         <span class="ruby-ivar">@format_fmt26</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;06$$$&gt;&quot;</span>,<span class="ruby-ivar">@applicant_arbitrator</span>,<span class="ruby-ivar">@format_fmt26</span>)
1771:         <span class="ruby-ivar">@format_fmt26</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;14$$$&gt;&quot;</span>,<span class="ruby-ivar">@applicant_arbitrator</span>,<span class="ruby-ivar">@format_fmt26</span>)
1772:         <span class="ruby-comment cmt">#被申请人仲裁员</span>
1773:         <span class="ruby-ivar">@respondent_arbitrator</span> = <span class="ruby-identifier">respondent_arbitrator</span>(<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>])
1774:         <span class="ruby-ivar">@format_fmt26</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;07$$$&gt;&quot;</span>,<span class="ruby-ivar">@respondent_arbitrator</span>,<span class="ruby-ivar">@format_fmt26</span>)
1775:         <span class="ruby-ivar">@format_fmt26</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;15$$$&gt;&quot;</span>,<span class="ruby-ivar">@respondent_arbitrator</span>,<span class="ruby-ivar">@format_fmt26</span>)    
1776:         <span class="ruby-comment cmt">#日期</span>
1777:         <span class="ruby-ivar">@date_of_letter</span> = <span class="ruby-constant">Time</span>.<span class="ruby-identifier">now</span>.<span class="ruby-identifier">to_s</span>(<span class="ruby-identifier">:db</span>)
1778:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@date_of_letter</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@date_of_letter</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
1779:             <span class="ruby-ivar">@date_of_letter</span> = <span class="ruby-value str">&quot;no&quot;</span>
1780:             <span class="ruby-ivar">@format_fmt26</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;08$$$&gt;&quot;</span>,<span class="ruby-ivar">@date_of_letter</span>,<span class="ruby-ivar">@format_fmt26</span>) 
1781:             <span class="ruby-ivar">@format_fmt26</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;09$$$&gt;&quot;</span>,<span class="ruby-ivar">@date_of_letter</span>,<span class="ruby-ivar">@format_fmt26</span>)
1782:             <span class="ruby-ivar">@format_fmt26</span> = <span class="ruby-identifier">add_last_record</span>(<span class="ruby-value str">&quot;&lt;10$$$&gt;&quot;</span>,<span class="ruby-ivar">@date_of_letter</span>,<span class="ruby-ivar">@format_fmt26</span>)
1783:         <span class="ruby-keyword kw">else</span>
1784:             <span class="ruby-identifier">arr_date</span> = <span class="ruby-ivar">@date_of_letter</span>.<span class="ruby-identifier">to_s</span>.<span class="ruby-identifier">split</span>(<span class="ruby-value str">&quot;-&quot;</span>)
1785:             <span class="ruby-ivar">@format_fmt26</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;08$$$&gt;&quot;</span>,<span class="ruby-identifier">arr_date</span>[<span class="ruby-value">0</span>],<span class="ruby-ivar">@format_fmt26</span>) 
1786:             <span class="ruby-ivar">@format_fmt26</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;09$$$&gt;&quot;</span>,<span class="ruby-identifier">arr_date</span>[<span class="ruby-value">1</span>],<span class="ruby-ivar">@format_fmt26</span>)
1787:             <span class="ruby-ivar">@format_fmt26</span> = <span class="ruby-identifier">add_last_record</span>(<span class="ruby-value str">&quot;&lt;10$$$&gt;&quot;</span>,<span class="ruby-identifier">arr_date</span>[<span class="ruby-value">2</span>].<span class="ruby-identifier">slice</span>(<span class="ruby-value">0</span>, <span class="ruby-value">2</span>),<span class="ruby-ivar">@format_fmt26</span>)            
1788:         <span class="ruby-keyword kw">end</span>   
1789:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000167" class="method-detail">
        <a name="M000167"></a>

        <div class="method-heading">
          <a href="#M000167" class="method-signature">
          <span class="method-name">format_letter_fmt27</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000167-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000167-source">
<pre>
      <span class="ruby-comment cmt"># File app/controllers/format_letter_controller.rb, line 1791</span>
1791:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">format_letter_fmt27</span>
1792:         <span class="ruby-comment cmt">#拼接字串，初始化</span>
1793:         <span class="ruby-ivar">@format_fmt27</span> = <span class="ruby-value str">&quot;&quot;</span>  
1794:         <span class="ruby-comment cmt">#函号</span>
1795:         <span class="ruby-ivar">@file_code</span> = <span class="ruby-constant">TbDoc</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:first</span>,<span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">&quot;used = 'Y' and recevice_code = ?&quot;</span>,<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]])
1796:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@file_code</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@file_code</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
1797:             <span class="ruby-ivar">@file_code</span> = <span class="ruby-value str">&quot;no&quot;</span>
1798:         <span class="ruby-keyword kw">else</span>
1799:             <span class="ruby-ivar">@file_code</span> = <span class="ruby-ivar">@file_code</span>.<span class="ruby-identifier">file_code</span>
1800:         <span class="ruby-keyword kw">end</span>
1801:         <span class="ruby-ivar">@format_fmt27</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;01$$$&gt;&quot;</span>,<span class="ruby-ivar">@file_code</span>,<span class="ruby-ivar">@format_fmt27</span>)         
1802:         <span class="ruby-comment cmt">#申请人</span>
1803:         <span class="ruby-ivar">@applicants</span> = <span class="ruby-constant">TbParty</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:all</span>,<span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">&quot;used = 'Y' and partytype = 1 and recevice_code = ?&quot;</span>,<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]], <span class="ruby-identifier">:order</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;id&quot;</span>)
1804:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@applicants</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@applicants</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
1805:             <span class="ruby-ivar">@applicant</span> = <span class="ruby-value str">&quot;no&quot;</span>
1806:         <span class="ruby-keyword kw">else</span>
1807:             <span class="ruby-ivar">@applicant</span> = <span class="ruby-value str">&quot;&quot;</span>
1808:             <span class="ruby-ivar">@applicants</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">applicant</span><span class="ruby-operator">|</span>
1809:                 <span class="ruby-ivar">@applicant</span> = <span class="ruby-ivar">@applicant</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">applicant</span>.<span class="ruby-identifier">partyname</span>
1810:             <span class="ruby-keyword kw">end</span>
1811:         <span class="ruby-keyword kw">end</span>        
1812:         <span class="ruby-ivar">@format_fmt27</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;02$$$&gt;&quot;</span>,<span class="ruby-ivar">@applicant</span>,<span class="ruby-ivar">@format_fmt27</span>)
1813:         <span class="ruby-comment cmt">#预缴查询费</span>
1814:         <span class="ruby-comment cmt">#</span>
1815:         <span class="ruby-comment cmt">#</span>
1816:         <span class="ruby-comment cmt">#日期</span>
1817:         <span class="ruby-ivar">@date_of_letter</span> = <span class="ruby-constant">Time</span>.<span class="ruby-identifier">now</span>.<span class="ruby-identifier">to_s</span>(<span class="ruby-identifier">:db</span>)
1818:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@date_of_letter</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@date_of_letter</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
1819:             <span class="ruby-ivar">@date_of_letter</span> = <span class="ruby-value str">&quot;no&quot;</span>
1820:             <span class="ruby-ivar">@format_fmt27</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;04$$$&gt;&quot;</span>,<span class="ruby-ivar">@date_of_letter</span>,<span class="ruby-ivar">@format_fmt27</span>) 
1821:             <span class="ruby-ivar">@format_fmt27</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;05$$$&gt;&quot;</span>,<span class="ruby-ivar">@date_of_letter</span>,<span class="ruby-ivar">@format_fmt27</span>)
1822:             <span class="ruby-ivar">@format_fmt27</span> = <span class="ruby-identifier">add_last_record</span>(<span class="ruby-value str">&quot;&lt;06$$$&gt;&quot;</span>,<span class="ruby-ivar">@date_of_letter</span>,<span class="ruby-ivar">@format_fmt27</span>)
1823:         <span class="ruby-keyword kw">else</span>
1824:             <span class="ruby-identifier">arr_date</span> = <span class="ruby-ivar">@date_of_letter</span>.<span class="ruby-identifier">to_s</span>.<span class="ruby-identifier">split</span>(<span class="ruby-value str">&quot;-&quot;</span>)
1825:             <span class="ruby-ivar">@format_fmt27</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;04$$$&gt;&quot;</span>,<span class="ruby-identifier">arr_date</span>[<span class="ruby-value">0</span>],<span class="ruby-ivar">@format_fmt27</span>) 
1826:             <span class="ruby-ivar">@format_fmt27</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;05$$$&gt;&quot;</span>,<span class="ruby-identifier">arr_date</span>[<span class="ruby-value">1</span>],<span class="ruby-ivar">@format_fmt27</span>)
1827:             <span class="ruby-ivar">@format_fmt27</span> = <span class="ruby-identifier">add_last_record</span>(<span class="ruby-value str">&quot;&lt;06$$$&gt;&quot;</span>,<span class="ruby-identifier">arr_date</span>[<span class="ruby-value">2</span>].<span class="ruby-identifier">slice</span>(<span class="ruby-value">0</span>, <span class="ruby-value">2</span>),<span class="ruby-ivar">@format_fmt27</span>)            
1828:         <span class="ruby-keyword kw">end</span>   
1829:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000168" class="method-detail">
        <a name="M000168"></a>

        <div class="method-heading">
          <a href="#M000168" class="method-signature">
          <span class="method-name">format_letter_fmt31</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000168-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000168-source">
<pre>
      <span class="ruby-comment cmt"># File app/controllers/format_letter_controller.rb, line 1831</span>
1831:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">format_letter_fmt31</span>
1832:         <span class="ruby-comment cmt">#拼接字串，初始化</span>
1833:         <span class="ruby-ivar">@format_fmt31</span> = <span class="ruby-value str">&quot;&quot;</span>  
1834:         <span class="ruby-comment cmt">#函号</span>
1835:         <span class="ruby-ivar">@file_code</span> = <span class="ruby-constant">TbDoc</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:first</span>,<span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">&quot;used = 'Y' and recevice_code = ?&quot;</span>,<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]])
1836:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@file_code</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@file_code</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
1837:             <span class="ruby-ivar">@file_code</span> = <span class="ruby-value str">&quot;no&quot;</span>
1838:         <span class="ruby-keyword kw">else</span>
1839:             <span class="ruby-ivar">@file_code</span> = <span class="ruby-ivar">@file_code</span>.<span class="ruby-identifier">file_code</span>
1840:         <span class="ruby-keyword kw">end</span>
1841:         <span class="ruby-ivar">@format_fmt31</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;01$$$&gt;&quot;</span>,<span class="ruby-ivar">@file_code</span>,<span class="ruby-ivar">@format_fmt31</span>)
1842:         <span class="ruby-comment cmt">#立案号</span>
1843:         <span class="ruby-ivar">@case_code</span> = <span class="ruby-constant">TbCase</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:first</span>, <span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">&quot;used = 'Y' and recevice_code = ?&quot;</span>,<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]]).<span class="ruby-identifier">case_code</span>
1844:         <span class="ruby-ivar">@format_fmt31</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;02$$$&gt;&quot;</span>,<span class="ruby-ivar">@case_code</span>,<span class="ruby-ivar">@format_fmt31</span>) 
1845:         <span class="ruby-ivar">@format_fmt31</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;06$$$&gt;&quot;</span>,<span class="ruby-ivar">@case_code</span>,<span class="ruby-ivar">@format_fmt31</span>)
1846:         <span class="ruby-comment cmt">#被申请人</span>
1847:         <span class="ruby-ivar">@respondents</span> = <span class="ruby-constant">TbParty</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:all</span>,<span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">&quot;used = 'Y' and partytype = 2 and recevice_code = ?&quot;</span>,<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]], <span class="ruby-identifier">:order</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;id&quot;</span>)
1848:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@respondent</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@respondent</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
1849:             <span class="ruby-ivar">@respondent</span> = <span class="ruby-value str">&quot;no&quot;</span>
1850:         <span class="ruby-keyword kw">else</span>
1851:             <span class="ruby-ivar">@respondent</span> = <span class="ruby-value str">&quot;&quot;</span>
1852:             <span class="ruby-ivar">@respondents</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">resp</span><span class="ruby-operator">|</span>
1853:                 <span class="ruby-ivar">@respondent</span> = <span class="ruby-ivar">@respondent</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">resp</span>.<span class="ruby-identifier">partyname</span>
1854:             <span class="ruby-keyword kw">end</span>
1855:         <span class="ruby-keyword kw">end</span>   
1856:         <span class="ruby-ivar">@format_fmt31</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;03$$$&gt;&quot;</span>,<span class="ruby-ivar">@respondent</span>,<span class="ruby-ivar">@format_fmt31</span>)
1857:         <span class="ruby-comment cmt">#申请人</span>
1858:         <span class="ruby-ivar">@applicants</span> = <span class="ruby-constant">TbParty</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:all</span>,<span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">&quot;used = 'Y' and partytype = 1 and recevice_code = ?&quot;</span>,<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]], <span class="ruby-identifier">:order</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;id&quot;</span>)
1859:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@applicants</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@applicants</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
1860:             <span class="ruby-ivar">@applicant</span> = <span class="ruby-value str">&quot;no&quot;</span>
1861:         <span class="ruby-keyword kw">else</span>
1862:             <span class="ruby-ivar">@applicant</span> = <span class="ruby-value str">&quot;&quot;</span>
1863:             <span class="ruby-ivar">@applicants</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">applicant</span><span class="ruby-operator">|</span>
1864:                 <span class="ruby-ivar">@applicant</span> = <span class="ruby-ivar">@applicant</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">applicant</span>.<span class="ruby-identifier">partyname</span>
1865:             <span class="ruby-keyword kw">end</span>
1866:         <span class="ruby-keyword kw">end</span>       
1867:         <span class="ruby-ivar">@format_fmt31</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;04$$$&gt;&quot;</span>,<span class="ruby-ivar">@applicant</span>,<span class="ruby-ivar">@format_fmt31</span>) 
1868:         <span class="ruby-comment cmt">#签订的$$$所引起的争议（合同名称）</span>
1869:         <span class="ruby-ivar">@contract_name</span> = <span class="ruby-constant">TbContractsign</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:first</span>,<span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">&quot;used = 'Y' and recevice_code = ?&quot;</span>,<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]])
1870:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@contract_name</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@contract_name</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
1871:             <span class="ruby-ivar">@contract_name</span> = <span class="ruby-value str">&quot;no&quot;</span>
1872:         <span class="ruby-keyword kw">else</span>
1873:             <span class="ruby-ivar">@contract_name</span> = <span class="ruby-ivar">@contract_name</span>.<span class="ruby-identifier">pactname</span>
1874:         <span class="ruby-keyword kw">end</span>   
1875:         <span class="ruby-ivar">@format_fmt31</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;05$$$&gt;&quot;</span>,<span class="ruby-ivar">@contract_name</span>,<span class="ruby-ivar">@format_fmt31</span>)
1876:         <span class="ruby-comment cmt">#文件份数</span>
1877:         <span class="ruby-ivar">@copies</span> = <span class="ruby-identifier">num_papers</span>(<span class="ruby-ivar">@applicants</span>.<span class="ruby-identifier">size</span>)
1878:         <span class="ruby-ivar">@format_fmt31</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;07$$$&gt;&quot;</span>,<span class="ruby-ivar">@copies</span>,<span class="ruby-ivar">@format_fmt31</span>) 
1879:         <span class="ruby-ivar">@format_fmt31</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;08$$$&gt;&quot;</span>,<span class="ruby-ivar">@copies</span>,<span class="ruby-ivar">@format_fmt31</span>)
1880:         <span class="ruby-ivar">@format_fmt31</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;09$$$&gt;&quot;</span>,<span class="ruby-ivar">@copies</span>,<span class="ruby-ivar">@format_fmt31</span>) 
1881:         <span class="ruby-ivar">@format_fmt31</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;10$$$&gt;&quot;</span>,<span class="ruby-ivar">@copies</span>,<span class="ruby-ivar">@format_fmt31</span>) 
1882:         <span class="ruby-comment cmt">#助理</span>
1883:         <span class="ruby-identifier">clerk_code</span> = <span class="ruby-constant">TbCase</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:first</span>,<span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">&quot;used = 'Y' and recevice_code = ?&quot;</span>,<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]]).<span class="ruby-identifier">clerk</span>
1884:         <span class="ruby-identifier">clerk</span> = <span class="ruby-constant">User</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:first</span>,<span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">&quot;used = 'Y' and code = ?&quot;</span>,<span class="ruby-identifier">clerk_code</span>])
1885:         <span class="ruby-ivar">@case_alerk</span> = <span class="ruby-identifier">clerk</span>.<span class="ruby-identifier">name</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">clerk</span>.<span class="ruby-identifier">sex</span>
1886:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@case_alerk</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@case_alerk</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
1887:             <span class="ruby-ivar">@case_alerk</span> = <span class="ruby-value str">&quot;no&quot;</span>
1888:         <span class="ruby-keyword kw">end</span>       
1889:         <span class="ruby-ivar">@format_fmt31</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;11$$$&gt;&quot;</span>,<span class="ruby-ivar">@case_alerk</span>,<span class="ruby-ivar">@format_fmt31</span>)  
1890:         <span class="ruby-comment cmt">#电话        </span>
1891:         <span class="ruby-ivar">@telephone</span> = <span class="ruby-identifier">clerk</span>.<span class="ruby-identifier">telephone</span>
1892:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@telephone</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@telephone</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
1893:             <span class="ruby-ivar">@telephone</span> = <span class="ruby-value str">&quot;no&quot;</span>
1894:         <span class="ruby-keyword kw">end</span>     
1895:         <span class="ruby-ivar">@format_fmt31</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;12$$$&gt;&quot;</span>,<span class="ruby-ivar">@telephone</span>,<span class="ruby-ivar">@format_fmt31</span>)       
1896:         <span class="ruby-comment cmt">#传真</span>
1897:         <span class="ruby-ivar">@fax</span> = <span class="ruby-identifier">clerk</span>.<span class="ruby-identifier">fax</span>
1898:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@fax</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@fax</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
1899:             <span class="ruby-ivar">@fax</span> = <span class="ruby-value str">&quot;no&quot;</span>
1900:         <span class="ruby-keyword kw">end</span>    
1901:         <span class="ruby-ivar">@format_fmt31</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;13$$$&gt;&quot;</span>,<span class="ruby-ivar">@fax</span>,<span class="ruby-ivar">@format_fmt31</span>)     
1902:         <span class="ruby-comment cmt">#电子邮箱</span>
1903:         <span class="ruby-ivar">@email</span> = <span class="ruby-identifier">clerk</span>.<span class="ruby-identifier">email</span>
1904:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@email</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@email</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
1905:             <span class="ruby-ivar">@email</span> = <span class="ruby-value str">&quot;no&quot;</span>
1906:         <span class="ruby-keyword kw">end</span>  
1907:         <span class="ruby-ivar">@format_fmt31</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;14$$$&gt;&quot;</span>,<span class="ruby-ivar">@email</span>,<span class="ruby-ivar">@format_fmt31</span>)    
1908:         <span class="ruby-comment cmt">#日期</span>
1909:         <span class="ruby-ivar">@date_of_letter</span> = <span class="ruby-constant">Time</span>.<span class="ruby-identifier">now</span>.<span class="ruby-identifier">to_s</span>(<span class="ruby-identifier">:db</span>)
1910:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@date_of_letter</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@date_of_letter</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
1911:             <span class="ruby-ivar">@date_of_letter</span> = <span class="ruby-value str">&quot;no&quot;</span>
1912:             <span class="ruby-ivar">@format_fmt31</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;15$$$&gt;&quot;</span>,<span class="ruby-ivar">@date_of_letter</span>,<span class="ruby-ivar">@format_fmt31</span>) 
1913:             <span class="ruby-ivar">@format_fmt31</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;16$$$&gt;&quot;</span>,<span class="ruby-ivar">@date_of_letter</span>,<span class="ruby-ivar">@format_fmt31</span>)
1914:             <span class="ruby-ivar">@format_fmt31</span> = <span class="ruby-identifier">add_last_record</span>(<span class="ruby-value str">&quot;&lt;17$$$&gt;&quot;</span>,<span class="ruby-ivar">@date_of_letter</span>,<span class="ruby-ivar">@format_fmt31</span>)
1915:         <span class="ruby-keyword kw">else</span>
1916:             <span class="ruby-identifier">arr_date</span> = <span class="ruby-ivar">@date_of_letter</span>.<span class="ruby-identifier">to_s</span>.<span class="ruby-identifier">split</span>(<span class="ruby-value str">&quot;-&quot;</span>)
1917:             <span class="ruby-ivar">@format_fmt31</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;15$$$&gt;&quot;</span>,<span class="ruby-identifier">arr_date</span>[<span class="ruby-value">0</span>],<span class="ruby-ivar">@format_fmt31</span>) 
1918:             <span class="ruby-ivar">@format_fmt31</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;16$$$&gt;&quot;</span>,<span class="ruby-identifier">arr_date</span>[<span class="ruby-value">1</span>],<span class="ruby-ivar">@format_fmt31</span>)
1919:             <span class="ruby-ivar">@format_fmt31</span> = <span class="ruby-identifier">add_last_record</span>(<span class="ruby-value str">&quot;&lt;17$$$&gt;&quot;</span>,<span class="ruby-identifier">arr_date</span>[<span class="ruby-value">2</span>].<span class="ruby-identifier">slice</span>(<span class="ruby-value">0</span>, <span class="ruby-value">2</span>),<span class="ruby-ivar">@format_fmt31</span>)            
1920:         <span class="ruby-keyword kw">end</span>          
1921:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000169" class="method-detail">
        <a name="M000169"></a>

        <div class="method-heading">
          <a href="#M000169" class="method-signature">
          <span class="method-name">format_letter_fmt32</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000169-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000169-source">
<pre>
      <span class="ruby-comment cmt"># File app/controllers/format_letter_controller.rb, line 1923</span>
1923:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">format_letter_fmt32</span>
1924:         <span class="ruby-comment cmt">#拼接字串，初始化</span>
1925:         <span class="ruby-ivar">@format_fmt32</span> = <span class="ruby-value str">&quot;&quot;</span>  
1926:         <span class="ruby-comment cmt">#函号</span>
1927:         <span class="ruby-ivar">@file_code</span> = <span class="ruby-constant">TbDoc</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:first</span>,<span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">&quot;used = 'Y' and recevice_code = ?&quot;</span>,<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]])
1928:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@file_code</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@file_code</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
1929:             <span class="ruby-ivar">@file_code</span> = <span class="ruby-value str">&quot;no&quot;</span>
1930:         <span class="ruby-keyword kw">else</span>
1931:             <span class="ruby-ivar">@file_code</span> = <span class="ruby-ivar">@file_code</span>.<span class="ruby-identifier">file_code</span>
1932:         <span class="ruby-keyword kw">end</span>
1933:         <span class="ruby-ivar">@format_fmt32</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;01$$$&gt;&quot;</span>,<span class="ruby-ivar">@file_code</span>,<span class="ruby-ivar">@format_fmt32</span>)
1934:         <span class="ruby-comment cmt">#立案号</span>
1935:         <span class="ruby-ivar">@case_code</span> = <span class="ruby-constant">TbCase</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:first</span>, <span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">&quot;used = 'Y' and recevice_code = ?&quot;</span>,<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]]).<span class="ruby-identifier">case_code</span>
1936:         <span class="ruby-ivar">@format_fmt32</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;02$$$&gt;&quot;</span>,<span class="ruby-ivar">@case_code</span>,<span class="ruby-ivar">@format_fmt32</span>)  
1937:         <span class="ruby-ivar">@format_fmt32</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;08$$$&gt;&quot;</span>,<span class="ruby-ivar">@case_code</span>,<span class="ruby-ivar">@format_fmt32</span>)
1938:         <span class="ruby-comment cmt">#申请人</span>
1939:         <span class="ruby-ivar">@applicants</span> = <span class="ruby-constant">TbParty</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:all</span>,<span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">&quot;used = 'Y' and partytype = 1 and recevice_code = ?&quot;</span>,<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]], <span class="ruby-identifier">:order</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;id&quot;</span>)
1940:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@applicants</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@applicants</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
1941:             <span class="ruby-ivar">@applicant</span> = <span class="ruby-value str">&quot;no&quot;</span>
1942:         <span class="ruby-keyword kw">else</span>
1943:             <span class="ruby-ivar">@applicant</span> = <span class="ruby-value str">&quot;&quot;</span>
1944:             <span class="ruby-ivar">@applicants</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">applicant</span><span class="ruby-operator">|</span>
1945:                 <span class="ruby-ivar">@applicant</span> = <span class="ruby-ivar">@applicant</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">applicant</span>.<span class="ruby-identifier">partyname</span>
1946:             <span class="ruby-keyword kw">end</span>
1947:         <span class="ruby-keyword kw">end</span>        
1948:         <span class="ruby-ivar">@format_fmt32</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;03$$$&gt;&quot;</span>,<span class="ruby-ivar">@applicant</span>,<span class="ruby-ivar">@format_fmt32</span>)
1949:         <span class="ruby-comment cmt">#被申请人</span>
1950:         <span class="ruby-ivar">@respondents</span> = <span class="ruby-constant">TbParty</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:all</span>,<span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">&quot;used = 'Y' and partytype = 2 and recevice_code = ?&quot;</span>,<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]], <span class="ruby-identifier">:order</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;id&quot;</span>)
1951:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@respondent</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@respondent</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
1952:             <span class="ruby-ivar">@respondent</span> = <span class="ruby-value str">&quot;no&quot;</span>
1953:         <span class="ruby-keyword kw">else</span>
1954:             <span class="ruby-ivar">@respondent</span> = <span class="ruby-value str">&quot;&quot;</span>
1955:             <span class="ruby-ivar">@respondents</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">resp</span><span class="ruby-operator">|</span>
1956:                 <span class="ruby-ivar">@respondent</span> = <span class="ruby-ivar">@respondent</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">resp</span>.<span class="ruby-identifier">partyname</span>
1957:             <span class="ruby-keyword kw">end</span>
1958:         <span class="ruby-keyword kw">end</span>       
1959:         <span class="ruby-ivar">@format_fmt32</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;04$$$&gt;&quot;</span>,<span class="ruby-ivar">@respondent</span>,<span class="ruby-ivar">@format_fmt32</span>)
1960:         <span class="ruby-comment cmt">#文件份数</span>
1961:         <span class="ruby-ivar">@copies</span> = <span class="ruby-identifier">num_papers</span>(<span class="ruby-ivar">@respondents</span>.<span class="ruby-identifier">size</span>)
1962:         <span class="ruby-ivar">@format_fmt32</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;05$$$&gt;&quot;</span>,<span class="ruby-ivar">@copies</span>,<span class="ruby-ivar">@format_fmt32</span>)  
1963:         <span class="ruby-comment cmt">#仲裁费</span>
1964:         <span class="ruby-ivar">@arbit_fee</span> = <span class="ruby-identifier">applicant_arbit_fee</span>(<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]) 
1965:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@arbit_fee</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@arbit_fee</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
1966:             <span class="ruby-ivar">@arbit_fee</span> = <span class="ruby-value str">&quot;no&quot;</span>
1967:         <span class="ruby-keyword kw">end</span>        
1968:         <span class="ruby-ivar">@format_fmt32</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;06$$$&gt;&quot;</span>,<span class="ruby-ivar">@arbit_fee</span>,<span class="ruby-ivar">@format_fmt32</span>)           
1969:         <span class="ruby-comment cmt">#关于$$$项下争议的仲裁申请文件（合同名称）</span>
1970:         <span class="ruby-ivar">@contract_name</span> = <span class="ruby-constant">TbContractsign</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:first</span>,<span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">&quot;used = 'Y' and recevice_code = ?&quot;</span>,<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]])
1971:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@contract_name</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@contract_name</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
1972:             <span class="ruby-ivar">@contract_name</span> = <span class="ruby-value str">&quot;no&quot;</span>
1973:         <span class="ruby-keyword kw">else</span>
1974:             <span class="ruby-ivar">@contract_name</span> = <span class="ruby-ivar">@contract_name</span>.<span class="ruby-identifier">pactname</span>
1975:         <span class="ruby-keyword kw">end</span>   
1976:         <span class="ruby-ivar">@format_fmt32</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;07$$$&gt;&quot;</span>,<span class="ruby-ivar">@contract_name</span>,<span class="ruby-ivar">@format_fmt32</span>)
1977:        
1978:         <span class="ruby-comment cmt">#助理</span>
1979:         <span class="ruby-identifier">clerk_code</span> = <span class="ruby-constant">TbCase</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:first</span>,<span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">&quot;used = 'Y' and recevice_code = ?&quot;</span>,<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]]).<span class="ruby-identifier">clerk</span>
1980:         <span class="ruby-identifier">clerk</span> = <span class="ruby-constant">User</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:first</span>,<span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">&quot;used = 'Y' and code = ?&quot;</span>,<span class="ruby-identifier">clerk_code</span>])
1981:         <span class="ruby-ivar">@case_alerk</span> = <span class="ruby-identifier">clerk</span>.<span class="ruby-identifier">name</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">clerk</span>.<span class="ruby-identifier">sex</span>
1982:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@case_alerk</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@case_alerk</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
1983:             <span class="ruby-ivar">@case_alerk</span> = <span class="ruby-value str">&quot;no&quot;</span>
1984:         <span class="ruby-keyword kw">end</span>       
1985:         <span class="ruby-ivar">@format_fmt32</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;09$$$&gt;&quot;</span>,<span class="ruby-ivar">@case_alerk</span>,<span class="ruby-ivar">@format_fmt32</span>)  
1986:         <span class="ruby-comment cmt">#电话        </span>
1987:         <span class="ruby-ivar">@telephone</span> = <span class="ruby-identifier">clerk</span>.<span class="ruby-identifier">telephone</span>
1988:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@telephone</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@telephone</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
1989:             <span class="ruby-ivar">@telephone</span> = <span class="ruby-value str">&quot;no&quot;</span>
1990:         <span class="ruby-keyword kw">end</span>     
1991:         <span class="ruby-ivar">@format_fmt32</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;10$$$&gt;&quot;</span>,<span class="ruby-ivar">@telephone</span>,<span class="ruby-ivar">@format_fmt32</span>)       
1992:         <span class="ruby-comment cmt">#传真</span>
1993:         <span class="ruby-ivar">@fax</span> = <span class="ruby-identifier">clerk</span>.<span class="ruby-identifier">fax</span>
1994:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@fax</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@fax</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
1995:             <span class="ruby-ivar">@fax</span> = <span class="ruby-value str">&quot;no&quot;</span>
1996:         <span class="ruby-keyword kw">end</span>    
1997:         <span class="ruby-ivar">@format_fmt32</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;11$$$&gt;&quot;</span>,<span class="ruby-ivar">@fax</span>,<span class="ruby-ivar">@format_fmt32</span>)     
1998:         <span class="ruby-comment cmt">#电子邮箱</span>
1999:         <span class="ruby-ivar">@email</span> = <span class="ruby-identifier">clerk</span>.<span class="ruby-identifier">email</span>
2000:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@email</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@email</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
2001:             <span class="ruby-ivar">@email</span> = <span class="ruby-value str">&quot;no&quot;</span>
2002:         <span class="ruby-keyword kw">end</span>  
2003:         <span class="ruby-ivar">@format_fmt32</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;12$$$&gt;&quot;</span>,<span class="ruby-ivar">@email</span>,<span class="ruby-ivar">@format_fmt32</span>)    
2004:         <span class="ruby-comment cmt">#日期</span>
2005:         <span class="ruby-ivar">@date_of_letter</span> = <span class="ruby-constant">Time</span>.<span class="ruby-identifier">now</span>.<span class="ruby-identifier">to_s</span>(<span class="ruby-identifier">:db</span>)
2006:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@date_of_letter</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@date_of_letter</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
2007:             <span class="ruby-ivar">@date_of_letter</span> = <span class="ruby-value str">&quot;no&quot;</span>
2008:             <span class="ruby-ivar">@format_fmt32</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;13$$$&gt;&quot;</span>,<span class="ruby-ivar">@date_of_letter</span>,<span class="ruby-ivar">@format_fmt32</span>) 
2009:             <span class="ruby-ivar">@format_fmt32</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;14$$$&gt;&quot;</span>,<span class="ruby-ivar">@date_of_letter</span>,<span class="ruby-ivar">@format_fmt32</span>)
2010:             <span class="ruby-ivar">@format_fmt32</span> = <span class="ruby-identifier">add_last_record</span>(<span class="ruby-value str">&quot;&lt;15$$$&gt;&quot;</span>,<span class="ruby-ivar">@date_of_letter</span>,<span class="ruby-ivar">@format_fmt32</span>)
2011:         <span class="ruby-keyword kw">else</span>
2012:             <span class="ruby-identifier">arr_date</span> = <span class="ruby-ivar">@date_of_letter</span>.<span class="ruby-identifier">to_s</span>.<span class="ruby-identifier">split</span>(<span class="ruby-value str">&quot;-&quot;</span>)
2013:             <span class="ruby-ivar">@format_fmt32</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;13$$$&gt;&quot;</span>,<span class="ruby-identifier">arr_date</span>[<span class="ruby-value">0</span>],<span class="ruby-ivar">@format_fmt32</span>) 
2014:             <span class="ruby-ivar">@format_fmt32</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;14$$$&gt;&quot;</span>,<span class="ruby-identifier">arr_date</span>[<span class="ruby-value">1</span>],<span class="ruby-ivar">@format_fmt32</span>)
2015:             <span class="ruby-ivar">@format_fmt32</span> = <span class="ruby-identifier">add_last_record</span>(<span class="ruby-value str">&quot;&lt;15$$$&gt;&quot;</span>,<span class="ruby-identifier">arr_date</span>[<span class="ruby-value">2</span>].<span class="ruby-identifier">slice</span>(<span class="ruby-value">0</span>, <span class="ruby-value">2</span>),<span class="ruby-ivar">@format_fmt32</span>)            
2016:         <span class="ruby-keyword kw">end</span>   
2017:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000170" class="method-detail">
        <a name="M000170"></a>

        <div class="method-heading">
          <a href="#M000170" class="method-signature">
          <span class="method-name">format_letter_fmt33</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000170-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000170-source">
<pre>
      <span class="ruby-comment cmt"># File app/controllers/format_letter_controller.rb, line 2019</span>
2019:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">format_letter_fmt33</span>
2020:         <span class="ruby-comment cmt">#拼接字串，初始化</span>
2021:         <span class="ruby-ivar">@format_fmt33</span> = <span class="ruby-value str">&quot;&quot;</span>  
2022:         <span class="ruby-comment cmt">#函号</span>
2023:         <span class="ruby-ivar">@file_code</span> = <span class="ruby-constant">TbDoc</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:first</span>,<span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">&quot;used = 'Y' and recevice_code = ?&quot;</span>,<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]])
2024:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@file_code</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@file_code</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
2025:             <span class="ruby-ivar">@file_code</span> = <span class="ruby-value str">&quot;no&quot;</span>
2026:         <span class="ruby-keyword kw">else</span>
2027:             <span class="ruby-ivar">@file_code</span> = <span class="ruby-ivar">@file_code</span>.<span class="ruby-identifier">file_code</span>
2028:         <span class="ruby-keyword kw">end</span>
2029:         <span class="ruby-ivar">@format_fmt33</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;01$$$&gt;&quot;</span>,<span class="ruby-ivar">@file_code</span>,<span class="ruby-ivar">@format_fmt33</span>)
2030:         <span class="ruby-comment cmt">#申请人</span>
2031:         <span class="ruby-ivar">@applicants</span> = <span class="ruby-constant">TbParty</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:all</span>,<span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">&quot;used = 'Y' and partytype = 1 and recevice_code = ?&quot;</span>,<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]], <span class="ruby-identifier">:order</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;id&quot;</span>)
2032:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@applicants</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@applicants</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
2033:             <span class="ruby-ivar">@applicant</span> = <span class="ruby-value str">&quot;no&quot;</span>
2034:         <span class="ruby-keyword kw">else</span>
2035:             <span class="ruby-ivar">@applicant</span> = <span class="ruby-value str">&quot;&quot;</span>
2036:             <span class="ruby-ivar">@applicants</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">applicant</span><span class="ruby-operator">|</span>
2037:                 <span class="ruby-ivar">@applicant</span> = <span class="ruby-ivar">@applicant</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">applicant</span>.<span class="ruby-identifier">partyname</span>
2038:             <span class="ruby-keyword kw">end</span>
2039:         <span class="ruby-keyword kw">end</span>        
2040:         <span class="ruby-ivar">@format_fmt33</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;02$$$&gt;&quot;</span>,<span class="ruby-ivar">@applicant</span>,<span class="ruby-ivar">@format_fmt33</span>)
2041:         <span class="ruby-comment cmt">#被申请人</span>
2042:         <span class="ruby-ivar">@respondents</span> = <span class="ruby-constant">TbParty</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:all</span>,<span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">&quot;used = 'Y' and partytype = 2 and recevice_code = ?&quot;</span>,<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]], <span class="ruby-identifier">:order</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;id&quot;</span>)
2043:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@respondent</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@respondent</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
2044:             <span class="ruby-ivar">@respondent</span> = <span class="ruby-value str">&quot;no&quot;</span>
2045:         <span class="ruby-keyword kw">else</span>
2046:             <span class="ruby-ivar">@respondent</span> = <span class="ruby-value str">&quot;&quot;</span>
2047:             <span class="ruby-ivar">@respondents</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">resp</span><span class="ruby-operator">|</span>
2048:                 <span class="ruby-ivar">@respondent</span> = <span class="ruby-ivar">@respondent</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">resp</span>.<span class="ruby-identifier">partyname</span>
2049:             <span class="ruby-keyword kw">end</span>
2050:         <span class="ruby-keyword kw">end</span>       
2051:         <span class="ruby-ivar">@format_fmt33</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;03$$$&gt;&quot;</span>,<span class="ruby-ivar">@respondent</span>,<span class="ruby-ivar">@format_fmt33</span>)
2052:         <span class="ruby-comment cmt">#立案号</span>
2053:         <span class="ruby-ivar">@case_code</span> = <span class="ruby-constant">TbCase</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:first</span>, <span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">&quot;used = 'Y' and recevice_code = ?&quot;</span>,<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]]).<span class="ruby-identifier">case_code</span>
2054:         <span class="ruby-ivar">@format_fmt33</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;04$$$&gt;&quot;</span>,<span class="ruby-ivar">@case_code</span>,<span class="ruby-ivar">@format_fmt33</span>)          
2055:         <span class="ruby-comment cmt">#日期</span>
2056:         <span class="ruby-ivar">@date_of_letter</span> = <span class="ruby-constant">Time</span>.<span class="ruby-identifier">now</span>.<span class="ruby-identifier">to_s</span>(<span class="ruby-identifier">:db</span>)
2057:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@date_of_letter</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@date_of_letter</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
2058:             <span class="ruby-ivar">@date_of_letter</span> = <span class="ruby-value str">&quot;no&quot;</span>
2059:             <span class="ruby-ivar">@format_fmt33</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;05$$$&gt;&quot;</span>,<span class="ruby-ivar">@date_of_letter</span>,<span class="ruby-ivar">@format_fmt33</span>) 
2060:             <span class="ruby-ivar">@format_fmt33</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;06$$$&gt;&quot;</span>,<span class="ruby-ivar">@date_of_letter</span>,<span class="ruby-ivar">@format_fmt33</span>)
2061:             <span class="ruby-ivar">@format_fmt33</span> = <span class="ruby-identifier">add_last_record</span>(<span class="ruby-value str">&quot;&lt;07$$$&gt;&quot;</span>,<span class="ruby-ivar">@date_of_letter</span>,<span class="ruby-ivar">@format_fmt33</span>)
2062:         <span class="ruby-keyword kw">else</span>
2063:             <span class="ruby-identifier">arr_date</span> = <span class="ruby-ivar">@date_of_letter</span>.<span class="ruby-identifier">to_s</span>.<span class="ruby-identifier">split</span>(<span class="ruby-value str">&quot;-&quot;</span>)
2064:             <span class="ruby-ivar">@format_fmt33</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;05$$$&gt;&quot;</span>,<span class="ruby-identifier">arr_date</span>[<span class="ruby-value">0</span>],<span class="ruby-ivar">@format_fmt33</span>) 
2065:             <span class="ruby-ivar">@format_fmt33</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;06$$$&gt;&quot;</span>,<span class="ruby-identifier">arr_date</span>[<span class="ruby-value">1</span>],<span class="ruby-ivar">@format_fmt33</span>)
2066:             <span class="ruby-ivar">@format_fmt33</span> = <span class="ruby-identifier">add_last_record</span>(<span class="ruby-value str">&quot;&lt;07$$$&gt;&quot;</span>,<span class="ruby-identifier">arr_date</span>[<span class="ruby-value">2</span>].<span class="ruby-identifier">slice</span>(<span class="ruby-value">0</span>, <span class="ruby-value">2</span>),<span class="ruby-ivar">@format_fmt33</span>)            
2067:         <span class="ruby-keyword kw">end</span>   
2068:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000171" class="method-detail">
        <a name="M000171"></a>

        <div class="method-heading">
          <a href="#M000171" class="method-signature">
          <span class="method-name">format_letter_fmt34</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
函件内容待明确
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000171-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000171-source">
<pre>
      <span class="ruby-comment cmt"># File app/controllers/format_letter_controller.rb, line 2070</span>
2070:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">format_letter_fmt34</span>
2071:         
2072:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000172" class="method-detail">
        <a name="M000172"></a>

        <div class="method-heading">
          <a href="#M000172" class="method-signature">
          <span class="method-name">format_letter_fmt35</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000172-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000172-source">
<pre>
      <span class="ruby-comment cmt"># File app/controllers/format_letter_controller.rb, line 2074</span>
2074:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">format_letter_fmt35</span>
2075:         <span class="ruby-comment cmt">#拼接字串，初始化</span>
2076:         <span class="ruby-ivar">@format_fmt35</span> = <span class="ruby-value str">&quot;&quot;</span>  
2077:         <span class="ruby-comment cmt">#申请人</span>
2078:         <span class="ruby-ivar">@applicants</span> = <span class="ruby-constant">TbParty</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:all</span>,<span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">&quot;used = 'Y' and partytype = 1 and recevice_code = ?&quot;</span>,<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]], <span class="ruby-identifier">:order</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;id&quot;</span>)
2079:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@applicants</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@applicants</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
2080:             <span class="ruby-ivar">@applicant</span> = <span class="ruby-value str">&quot;no&quot;</span>
2081:         <span class="ruby-keyword kw">else</span>
2082:             <span class="ruby-ivar">@applicant</span> = <span class="ruby-value str">&quot;&quot;</span>
2083:             <span class="ruby-ivar">@applicants</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">applicant</span><span class="ruby-operator">|</span>
2084:                 <span class="ruby-ivar">@applicant</span> = <span class="ruby-ivar">@applicant</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">applicant</span>.<span class="ruby-identifier">partyname</span>
2085:             <span class="ruby-keyword kw">end</span>
2086:         <span class="ruby-keyword kw">end</span>        
2087:         <span class="ruby-ivar">@format_fmt35</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;01$$$&gt;&quot;</span>,<span class="ruby-ivar">@applicant</span>,<span class="ruby-ivar">@format_fmt35</span>)
2088:         <span class="ruby-comment cmt">#被申请人</span>
2089:         <span class="ruby-ivar">@respondents</span> = <span class="ruby-constant">TbParty</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:all</span>,<span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">&quot;used = 'Y' and partytype = 2 and recevice_code = ?&quot;</span>,<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]], <span class="ruby-identifier">:order</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;id&quot;</span>)
2090:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@respondent</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@respondent</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
2091:             <span class="ruby-ivar">@respondent</span> = <span class="ruby-value str">&quot;no&quot;</span>
2092:         <span class="ruby-keyword kw">else</span>
2093:             <span class="ruby-ivar">@respondent</span> = <span class="ruby-value str">&quot;&quot;</span>
2094:             <span class="ruby-ivar">@respondents</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">resp</span><span class="ruby-operator">|</span>
2095:                 <span class="ruby-ivar">@respondent</span> = <span class="ruby-ivar">@respondent</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">resp</span>.<span class="ruby-identifier">partyname</span>
2096:             <span class="ruby-keyword kw">end</span>
2097:         <span class="ruby-keyword kw">end</span>       
2098:         <span class="ruby-ivar">@format_fmt35</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;02$$$&gt;&quot;</span>,<span class="ruby-ivar">@respondent</span>,<span class="ruby-ivar">@format_fmt35</span>)
2099:         <span class="ruby-comment cmt">#立案号</span>
2100:         <span class="ruby-ivar">@case_code</span> = <span class="ruby-constant">TbCase</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:first</span>, <span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">&quot;used = 'Y' and recevice_code = ?&quot;</span>,<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]]).<span class="ruby-identifier">case_code</span>
2101:         <span class="ruby-ivar">@format_fmt35</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;03$$$&gt;&quot;</span>,<span class="ruby-ivar">@case_code</span>,<span class="ruby-ivar">@format_fmt35</span>)          
2102:         <span class="ruby-comment cmt">#日期</span>
2103:         <span class="ruby-ivar">@date_of_letter</span> = <span class="ruby-constant">Time</span>.<span class="ruby-identifier">now</span>.<span class="ruby-identifier">to_s</span>(<span class="ruby-identifier">:db</span>)
2104:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@date_of_letter</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@date_of_letter</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
2105:             <span class="ruby-ivar">@date_of_letter</span> = <span class="ruby-value str">&quot;no&quot;</span>
2106:             <span class="ruby-ivar">@format_fmt35</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;04$$$&gt;&quot;</span>,<span class="ruby-ivar">@date_of_letter</span>,<span class="ruby-ivar">@format_fmt35</span>) 
2107:             <span class="ruby-ivar">@format_fmt35</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;05$$$&gt;&quot;</span>,<span class="ruby-ivar">@date_of_letter</span>,<span class="ruby-ivar">@format_fmt35</span>)
2108:             <span class="ruby-ivar">@format_fmt35</span> = <span class="ruby-identifier">add_last_record</span>(<span class="ruby-value str">&quot;&lt;06$$$&gt;&quot;</span>,<span class="ruby-ivar">@date_of_letter</span>,<span class="ruby-ivar">@format_fmt35</span>)
2109:         <span class="ruby-keyword kw">else</span>
2110:             <span class="ruby-identifier">arr_date</span> = <span class="ruby-ivar">@date_of_letter</span>.<span class="ruby-identifier">to_s</span>.<span class="ruby-identifier">split</span>(<span class="ruby-value str">&quot;-&quot;</span>)
2111:             <span class="ruby-ivar">@format_fmt35</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;04$$$&gt;&quot;</span>,<span class="ruby-identifier">arr_date</span>[<span class="ruby-value">0</span>],<span class="ruby-ivar">@format_fmt35</span>) 
2112:             <span class="ruby-ivar">@format_fmt35</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;05$$$&gt;&quot;</span>,<span class="ruby-identifier">arr_date</span>[<span class="ruby-value">1</span>],<span class="ruby-ivar">@format_fmt35</span>)
2113:             <span class="ruby-ivar">@format_fmt35</span> = <span class="ruby-identifier">add_last_record</span>(<span class="ruby-value str">&quot;&lt;06$$$&gt;&quot;</span>,<span class="ruby-identifier">arr_date</span>[<span class="ruby-value">2</span>].<span class="ruby-identifier">slice</span>(<span class="ruby-value">0</span>, <span class="ruby-value">2</span>),<span class="ruby-ivar">@format_fmt35</span>)            
2114:         <span class="ruby-keyword kw">end</span>   
2115:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000173" class="method-detail">
        <a name="M000173"></a>

        <div class="method-heading">
          <a href="#M000173" class="method-signature">
          <span class="method-name">format_letter_fmt36</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000173-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000173-source">
<pre>
      <span class="ruby-comment cmt"># File app/controllers/format_letter_controller.rb, line 2117</span>
2117:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">format_letter_fmt36</span>
2118:         <span class="ruby-comment cmt">#拼接字串，初始化</span>
2119:         <span class="ruby-ivar">@format_fmt36</span> = <span class="ruby-value str">&quot;&quot;</span>  
2120:         <span class="ruby-comment cmt">#函号</span>
2121:         <span class="ruby-ivar">@file_code</span> = <span class="ruby-constant">TbDoc</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:first</span>,<span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">&quot;used = 'Y' and recevice_code = ?&quot;</span>,<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]])
2122:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@file_code</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@file_code</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
2123:             <span class="ruby-ivar">@file_code</span> = <span class="ruby-value str">&quot;no&quot;</span>
2124:         <span class="ruby-keyword kw">else</span>
2125:             <span class="ruby-ivar">@file_code</span> = <span class="ruby-ivar">@file_code</span>.<span class="ruby-identifier">file_code</span>
2126:         <span class="ruby-keyword kw">end</span>
2127:         <span class="ruby-ivar">@format_fmt36</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;01$$$&gt;&quot;</span>,<span class="ruby-ivar">@file_code</span>,<span class="ruby-ivar">@format_fmt36</span>)
2128:         <span class="ruby-comment cmt">#立案号</span>
2129:         <span class="ruby-ivar">@case_code</span> = <span class="ruby-constant">TbCase</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:first</span>, <span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">&quot;used = 'Y' and recevice_code = ?&quot;</span>,<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]]).<span class="ruby-identifier">case_code</span>
2130:         <span class="ruby-ivar">@format_fmt36</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;02$$$&gt;&quot;</span>,<span class="ruby-ivar">@case_code</span>,<span class="ruby-ivar">@format_fmt36</span>)          
2131:         <span class="ruby-comment cmt">#首席仲裁员</span>
2132:         <span class="ruby-ivar">@chief_arbitrator</span> = <span class="ruby-identifier">chief_arbitrator</span>(<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>])
2133:         <span class="ruby-ivar">@format_fmt36</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;03$$$&gt;&quot;</span>,<span class="ruby-ivar">@chief_arbitrator</span>,<span class="ruby-ivar">@format_fmt36</span>)
2134:         <span class="ruby-comment cmt">#申请人仲裁员</span>
2135:         <span class="ruby-ivar">@applicant_arbitrator</span> = <span class="ruby-identifier">applicant_arbitrator</span>(<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>])
2136:         <span class="ruby-ivar">@format_fmt36</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;04$$$&gt;&quot;</span>,<span class="ruby-ivar">@applicant_arbitrator</span>,<span class="ruby-ivar">@format_fmt36</span>)
2137:         <span class="ruby-comment cmt">#被申请人仲裁员</span>
2138:         <span class="ruby-ivar">@respondent_arbitrator</span> = <span class="ruby-identifier">respondent_arbitrator</span>(<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>])
2139:         <span class="ruby-ivar">@format_fmt36</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;05$$$&gt;&quot;</span>,<span class="ruby-ivar">@respondent_arbitrator</span>,<span class="ruby-ivar">@format_fmt36</span>)
2140:         <span class="ruby-comment cmt">###           第n次庭审的日期###</span>
2141:         <span class="ruby-comment cmt">#日期</span>
2142:         <span class="ruby-ivar">@date_of_letter</span> = <span class="ruby-constant">Time</span>.<span class="ruby-identifier">now</span>.<span class="ruby-identifier">to_s</span>(<span class="ruby-identifier">:db</span>)
2143:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@date_of_letter</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@date_of_letter</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
2144:             <span class="ruby-ivar">@date_of_letter</span> = <span class="ruby-value str">&quot;no&quot;</span>
2145:             <span class="ruby-ivar">@format_fmt36</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;13$$$&gt;&quot;</span>,<span class="ruby-ivar">@date_of_letter</span>,<span class="ruby-ivar">@format_fmt36</span>) 
2146:             <span class="ruby-ivar">@format_fmt36</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;14$$$&gt;&quot;</span>,<span class="ruby-ivar">@date_of_letter</span>,<span class="ruby-ivar">@format_fmt36</span>)
2147:             <span class="ruby-ivar">@format_fmt36</span> = <span class="ruby-identifier">add_last_record</span>(<span class="ruby-value str">&quot;&lt;15$$$&gt;&quot;</span>,<span class="ruby-ivar">@date_of_letter</span>,<span class="ruby-ivar">@format_fmt36</span>)
2148:         <span class="ruby-keyword kw">else</span>
2149:             <span class="ruby-identifier">arr_date</span> = <span class="ruby-ivar">@date_of_letter</span>.<span class="ruby-identifier">to_s</span>.<span class="ruby-identifier">split</span>(<span class="ruby-value str">&quot;-&quot;</span>)
2150:             <span class="ruby-ivar">@format_fmt36</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;13$$$&gt;&quot;</span>,<span class="ruby-identifier">arr_date</span>[<span class="ruby-value">0</span>],<span class="ruby-ivar">@format_fmt36</span>) 
2151:             <span class="ruby-ivar">@format_fmt36</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;14$$$&gt;&quot;</span>,<span class="ruby-identifier">arr_date</span>[<span class="ruby-value">1</span>],<span class="ruby-ivar">@format_fmt36</span>)
2152:             <span class="ruby-ivar">@format_fmt36</span> = <span class="ruby-identifier">add_last_record</span>(<span class="ruby-value str">&quot;&lt;15$$$&gt;&quot;</span>,<span class="ruby-identifier">arr_date</span>[<span class="ruby-value">2</span>].<span class="ruby-identifier">slice</span>(<span class="ruby-value">0</span>, <span class="ruby-value">2</span>),<span class="ruby-ivar">@format_fmt36</span>)            
2153:         <span class="ruby-keyword kw">end</span>   
2154:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000174" class="method-detail">
        <a name="M000174"></a>

        <div class="method-heading">
          <a href="#M000174" class="method-signature">
          <span class="method-name">format_letter_fmt37</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000174-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000174-source">
<pre>
      <span class="ruby-comment cmt"># File app/controllers/format_letter_controller.rb, line 2156</span>
2156:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">format_letter_fmt37</span>
2157:         <span class="ruby-comment cmt">#拼接字串，初始化</span>
2158:         <span class="ruby-ivar">@format_fmt37</span> = <span class="ruby-value str">&quot;&quot;</span>  
2159:         <span class="ruby-comment cmt">#函号</span>
2160:         <span class="ruby-ivar">@file_code</span> = <span class="ruby-constant">TbDoc</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:first</span>,<span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">&quot;used = 'Y' and recevice_code = ?&quot;</span>,<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]])
2161:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@file_code</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@file_code</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
2162:             <span class="ruby-ivar">@file_code</span> = <span class="ruby-value str">&quot;no&quot;</span>
2163:         <span class="ruby-keyword kw">else</span>
2164:             <span class="ruby-ivar">@file_code</span> = <span class="ruby-ivar">@file_code</span>.<span class="ruby-identifier">file_code</span>
2165:         <span class="ruby-keyword kw">end</span>
2166:         <span class="ruby-ivar">@format_fmt37</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;01$$$&gt;&quot;</span>,<span class="ruby-ivar">@file_code</span>,<span class="ruby-ivar">@format_fmt37</span>)
2167:         <span class="ruby-comment cmt">#立案号</span>
2168:         <span class="ruby-ivar">@case_code</span> = <span class="ruby-constant">TbCase</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:first</span>, <span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">&quot;used = 'Y' and recevice_code = ?&quot;</span>,<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]]).<span class="ruby-identifier">case_code</span>
2169:         <span class="ruby-ivar">@format_fmt37</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;02$$$&gt;&quot;</span>,<span class="ruby-ivar">@case_code</span>,<span class="ruby-ivar">@format_fmt37</span>)         
2170:         <span class="ruby-comment cmt">#申请人</span>
2171:         <span class="ruby-ivar">@applicants</span> = <span class="ruby-constant">TbParty</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:all</span>,<span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">&quot;used = 'Y' and partytype = 1 and recevice_code = ?&quot;</span>,<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]], <span class="ruby-identifier">:order</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;id&quot;</span>)
2172:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@applicants</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@applicants</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
2173:             <span class="ruby-ivar">@applicant</span> = <span class="ruby-value str">&quot;no&quot;</span>
2174:         <span class="ruby-keyword kw">else</span>
2175:             <span class="ruby-ivar">@applicant</span> = <span class="ruby-value str">&quot;&quot;</span>
2176:             <span class="ruby-ivar">@applicants</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">applicant</span><span class="ruby-operator">|</span>
2177:                 <span class="ruby-ivar">@applicant</span> = <span class="ruby-ivar">@applicant</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">applicant</span>.<span class="ruby-identifier">partyname</span>
2178:             <span class="ruby-keyword kw">end</span>
2179:         <span class="ruby-keyword kw">end</span>        
2180:         <span class="ruby-ivar">@format_fmt37</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;03$$$&gt;&quot;</span>,<span class="ruby-ivar">@applicant</span>,<span class="ruby-ivar">@format_fmt37</span>)
2181:         <span class="ruby-comment cmt">#被申请人</span>
2182:         <span class="ruby-ivar">@respondents</span> = <span class="ruby-constant">TbParty</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:all</span>,<span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">&quot;used = 'Y' and partytype = 2 and recevice_code = ?&quot;</span>,<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]], <span class="ruby-identifier">:order</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;id&quot;</span>)
2183:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@respondent</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@respondent</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
2184:             <span class="ruby-ivar">@respondent</span> = <span class="ruby-value str">&quot;no&quot;</span>
2185:         <span class="ruby-keyword kw">else</span>
2186:             <span class="ruby-ivar">@respondent</span> = <span class="ruby-value str">&quot;&quot;</span>
2187:             <span class="ruby-ivar">@respondents</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">resp</span><span class="ruby-operator">|</span>
2188:                 <span class="ruby-ivar">@respondent</span> = <span class="ruby-ivar">@respondent</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">resp</span>.<span class="ruby-identifier">partyname</span>
2189:             <span class="ruby-keyword kw">end</span>
2190:         <span class="ruby-keyword kw">end</span>       
2191:         <span class="ruby-ivar">@format_fmt37</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;04$$$&gt;&quot;</span>,<span class="ruby-ivar">@respondent</span>,<span class="ruby-ivar">@format_fmt37</span>)         
2192:         <span class="ruby-comment cmt">#日期</span>
2193:         <span class="ruby-ivar">@date_of_letter</span> = <span class="ruby-constant">Time</span>.<span class="ruby-identifier">now</span>.<span class="ruby-identifier">to_s</span>(<span class="ruby-identifier">:db</span>)
2194:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@date_of_letter</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@date_of_letter</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
2195:             <span class="ruby-ivar">@date_of_letter</span> = <span class="ruby-value str">&quot;no&quot;</span>
2196:             <span class="ruby-ivar">@format_fmt37</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;05$$$&gt;&quot;</span>,<span class="ruby-ivar">@date_of_letter</span>,<span class="ruby-ivar">@format_fmt37</span>) 
2197:             <span class="ruby-ivar">@format_fmt37</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;06$$$&gt;&quot;</span>,<span class="ruby-ivar">@date_of_letter</span>,<span class="ruby-ivar">@format_fmt37</span>)
2198:             <span class="ruby-ivar">@format_fmt37</span> = <span class="ruby-identifier">add_last_record</span>(<span class="ruby-value str">&quot;&lt;07$$$&gt;&quot;</span>,<span class="ruby-ivar">@date_of_letter</span>,<span class="ruby-ivar">@format_fmt37</span>)
2199:         <span class="ruby-keyword kw">else</span>
2200:             <span class="ruby-identifier">arr_date</span> = <span class="ruby-ivar">@date_of_letter</span>.<span class="ruby-identifier">to_s</span>.<span class="ruby-identifier">split</span>(<span class="ruby-value str">&quot;-&quot;</span>)
2201:             <span class="ruby-ivar">@format_fmt37</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;05$$$&gt;&quot;</span>,<span class="ruby-identifier">arr_date</span>[<span class="ruby-value">0</span>],<span class="ruby-ivar">@format_fmt37</span>) 
2202:             <span class="ruby-ivar">@format_fmt37</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;06$$$&gt;&quot;</span>,<span class="ruby-identifier">arr_date</span>[<span class="ruby-value">1</span>],<span class="ruby-ivar">@format_fmt37</span>)
2203:             <span class="ruby-ivar">@format_fmt37</span> = <span class="ruby-identifier">add_last_record</span>(<span class="ruby-value str">&quot;&lt;07$$$&gt;&quot;</span>,<span class="ruby-identifier">arr_date</span>[<span class="ruby-value">2</span>].<span class="ruby-identifier">slice</span>(<span class="ruby-value">0</span>, <span class="ruby-value">2</span>),<span class="ruby-ivar">@format_fmt37</span>)            
2204:         <span class="ruby-keyword kw">end</span>   
2205:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000175" class="method-detail">
        <a name="M000175"></a>

        <div class="method-heading">
          <a href="#M000175" class="method-signature">
          <span class="method-name">format_letter_fmt38a</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000175-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000175-source">
<pre>
      <span class="ruby-comment cmt"># File app/controllers/format_letter_controller.rb, line 2207</span>
2207:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">format_letter_fmt38a</span>
2208:         <span class="ruby-comment cmt">#拼接字串，初始化</span>
2209:         <span class="ruby-ivar">@format_fmt38a</span> = <span class="ruby-value str">&quot;&quot;</span>  
2210:         <span class="ruby-comment cmt">#函号</span>
2211:         <span class="ruby-ivar">@file_code</span> = <span class="ruby-constant">TbDoc</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:first</span>,<span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">&quot;used = 'Y' and recevice_code = ?&quot;</span>,<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]])
2212:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@file_code</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@file_code</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
2213:             <span class="ruby-ivar">@file_code</span> = <span class="ruby-value str">&quot;no&quot;</span>
2214:         <span class="ruby-keyword kw">else</span>
2215:             <span class="ruby-ivar">@file_code</span> = <span class="ruby-ivar">@file_code</span>.<span class="ruby-identifier">file_code</span>
2216:         <span class="ruby-keyword kw">end</span>
2217:         <span class="ruby-ivar">@format_fmt38a</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;01$$$&gt;&quot;</span>,<span class="ruby-ivar">@file_code</span>,<span class="ruby-ivar">@format_fmt38a</span>)
2218:         <span class="ruby-comment cmt">#立案号</span>
2219:         <span class="ruby-ivar">@case_code</span> = <span class="ruby-constant">TbCase</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:first</span>, <span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">&quot;used = 'Y' and recevice_code = ?&quot;</span>,<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]]).<span class="ruby-identifier">case_code</span>
2220:         <span class="ruby-ivar">@format_fmt38a</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;02$$$&gt;&quot;</span>,<span class="ruby-ivar">@case_code</span>,<span class="ruby-ivar">@format_fmt38a</span>)          
2221:         <span class="ruby-comment cmt">#将要更换的首席仲裁员</span>
2222: 
2223:         <span class="ruby-comment cmt">#将要更换的申请人仲裁员</span>
2224: 
2225:         <span class="ruby-comment cmt">#将要更换的被申请人仲裁员</span>
2226: 
2227:         <span class="ruby-comment cmt">###      3、4、5、6、7、8、9空缺 ###</span>
2228:         <span class="ruby-comment cmt">#申请人</span>
2229:         <span class="ruby-ivar">@applicants</span> = <span class="ruby-constant">TbParty</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:all</span>,<span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">&quot;used = 'Y' and partytype = 1 and recevice_code = ?&quot;</span>,<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]], <span class="ruby-identifier">:order</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;id&quot;</span>)
2230:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@applicants</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@applicants</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
2231:             <span class="ruby-ivar">@applicant</span> = <span class="ruby-value str">&quot;no&quot;</span>
2232:         <span class="ruby-keyword kw">else</span>
2233:             <span class="ruby-ivar">@applicant</span> = <span class="ruby-value str">&quot;&quot;</span>
2234:             <span class="ruby-ivar">@applicants</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">applicant</span><span class="ruby-operator">|</span>
2235:                 <span class="ruby-ivar">@applicant</span> = <span class="ruby-ivar">@applicant</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">applicant</span>.<span class="ruby-identifier">partyname</span>
2236:             <span class="ruby-keyword kw">end</span>
2237:         <span class="ruby-keyword kw">end</span>        
2238:         <span class="ruby-ivar">@format_fmt38a</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;10$$$&gt;&quot;</span>,<span class="ruby-ivar">@applicant</span>,<span class="ruby-ivar">@format_fmt38a</span>)
2239:         <span class="ruby-comment cmt">#申请人代理人(可多名？）</span>
2240:         <span class="ruby-ivar">@applicant_agent</span> = <span class="ruby-constant">TbAgent</span>.<span class="ruby-identifier">find</span>(<span class="ruby-ivar">@applicants</span>.<span class="ruby-identifier">id</span>)
2241:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@applicant_agent</span> <span class="ruby-operator">!=</span> <span class="ruby-keyword kw">nil</span>
2242:             <span class="ruby-ivar">@applicant_agent</span> = <span class="ruby-ivar">@applicant_agent</span>.<span class="ruby-identifier">name</span>
2243:             <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@applicant_agent</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
2244:                 <span class="ruby-ivar">@applicant_agent</span> = <span class="ruby-value str">&quot;no&quot;</span>
2245:             <span class="ruby-keyword kw">end</span>
2246:         <span class="ruby-keyword kw">else</span>
2247:             <span class="ruby-ivar">@applicant_agent</span> = <span class="ruby-value str">&quot;no&quot;</span>
2248:         <span class="ruby-keyword kw">end</span>
2249:         <span class="ruby-ivar">@format_fmt38a</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;11$$$&gt;&quot;</span>,<span class="ruby-ivar">@applicant_agent</span>,<span class="ruby-ivar">@format_fmt38a</span>)
2250:         <span class="ruby-comment cmt">#被申请人</span>
2251:         <span class="ruby-ivar">@respondents</span> = <span class="ruby-constant">TbParty</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:all</span>,<span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">&quot;used = 'Y' and partytype = 2 and recevice_code = ?&quot;</span>,<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]], <span class="ruby-identifier">:order</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;id&quot;</span>)
2252:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@respondent</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@respondent</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
2253:             <span class="ruby-ivar">@respondent</span> = <span class="ruby-value str">&quot;no&quot;</span>
2254:         <span class="ruby-keyword kw">else</span>
2255:             <span class="ruby-ivar">@respondent</span> = <span class="ruby-value str">&quot;&quot;</span>
2256:             <span class="ruby-ivar">@respondents</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">resp</span><span class="ruby-operator">|</span>
2257:                 <span class="ruby-ivar">@respondent</span> = <span class="ruby-ivar">@respondent</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">resp</span>.<span class="ruby-identifier">partyname</span>
2258:             <span class="ruby-keyword kw">end</span>
2259:         <span class="ruby-keyword kw">end</span>       
2260:         <span class="ruby-ivar">@format_fmt38a</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;12$$$&gt;&quot;</span>,<span class="ruby-ivar">@respondent</span>,<span class="ruby-ivar">@format_fmt38a</span>)
2261:         <span class="ruby-comment cmt">#被申请人代理人(可多名？）</span>
2262:         <span class="ruby-ivar">@respondent_agent</span> = <span class="ruby-constant">TbAgent</span>.<span class="ruby-identifier">find</span>(<span class="ruby-ivar">@respondents</span>.<span class="ruby-identifier">id</span>)
2263:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@respondent_agent</span> <span class="ruby-operator">!=</span> <span class="ruby-keyword kw">nil</span>
2264:             <span class="ruby-ivar">@respondent_agent</span> = <span class="ruby-ivar">@respondent_agent</span>.<span class="ruby-identifier">name</span>
2265:             <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@respondent_agent</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
2266:                 <span class="ruby-ivar">@respondent_agent</span> = <span class="ruby-value str">&quot;no&quot;</span>
2267:             <span class="ruby-keyword kw">end</span>
2268:         <span class="ruby-keyword kw">else</span>
2269:             <span class="ruby-ivar">@respondent_agent</span> = <span class="ruby-value str">&quot;no&quot;</span>
2270:         <span class="ruby-keyword kw">end</span>
2271:         <span class="ruby-ivar">@format_fmt38a</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;13$$$&gt;&quot;</span>,<span class="ruby-ivar">@respondent_agent</span>,<span class="ruby-ivar">@format_fmt38a</span>) 
2272:         <span class="ruby-comment cmt">#争议金额（人民币）</span>
2273:         <span class="ruby-ivar">@accounts_rmb</span> = <span class="ruby-constant">TbCaseAmount</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:all</span>,<span class="ruby-identifier">:conditions=</span><span class="ruby-operator">&gt;</span>[<span class="ruby-value str">&quot;recevice_code= ? and used='Y' and currency = '0001'&quot;</span>,<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]],<span class="ruby-identifier">:order=</span><span class="ruby-operator">&gt;</span><span class="ruby-value str">'id'</span>)
2274:         <span class="ruby-ivar">@sum_rmb</span> = <span class="ruby-value">0</span>
2275:         <span class="ruby-keyword kw">for</span> <span class="ruby-identifier">account_rmb</span> <span class="ruby-keyword kw">in</span> <span class="ruby-ivar">@accounts_rmb</span>
2276:             <span class="ruby-ivar">@sum_rmb</span> = <span class="ruby-ivar">@sum_rmb</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">account_rmb</span>.<span class="ruby-identifier">rmb_money</span>
2277:         <span class="ruby-keyword kw">end</span>        
2278:         <span class="ruby-ivar">@format_fmt38a</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;14$$$&gt;&quot;</span>,<span class="ruby-ivar">@sum_rmb</span>,<span class="ruby-ivar">@format_fmt38a</span>) 
2279:         <span class="ruby-comment cmt">#争议金额（港币）</span>
2280:         <span class="ruby-ivar">@accounts_hk</span> = <span class="ruby-constant">TbCaseAmount</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:all</span>,<span class="ruby-identifier">:conditions=</span><span class="ruby-operator">&gt;</span>[<span class="ruby-value str">&quot;recevice_code= ? and used='Y' and currency = '0001'&quot;</span>,<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]],<span class="ruby-identifier">:order=</span><span class="ruby-operator">&gt;</span><span class="ruby-value str">'id'</span>)
2281:         <span class="ruby-ivar">@sum_hk</span> = <span class="ruby-value">0</span>
2282:         <span class="ruby-keyword kw">for</span> <span class="ruby-identifier">account_hk</span> <span class="ruby-keyword kw">in</span> <span class="ruby-ivar">@accounts_hk</span>
2283:             <span class="ruby-ivar">@sum_hk</span> = <span class="ruby-ivar">@sum_hk</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">account_hk</span>.<span class="ruby-identifier">f_money</span>
2284:         <span class="ruby-keyword kw">end</span>        
2285:         <span class="ruby-ivar">@format_fmt38a</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;15$$$&gt;&quot;</span>,<span class="ruby-ivar">@sum_hk</span>,<span class="ruby-ivar">@format_fmt38a</span>)    
2286:         <span class="ruby-comment cmt">#争议金额（美元）</span>
2287:         <span class="ruby-ivar">@accounts_dollar</span> = <span class="ruby-constant">TbCaseAmount</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:all</span>,<span class="ruby-identifier">:conditions=</span><span class="ruby-operator">&gt;</span>[<span class="ruby-value str">&quot;recevice_code= ? and used='Y' and currency = '0003'&quot;</span>,<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]],<span class="ruby-identifier">:order=</span><span class="ruby-operator">&gt;</span><span class="ruby-value str">'id'</span>)
2288:         <span class="ruby-ivar">@sum_dollar</span> = <span class="ruby-value">0</span>
2289:         <span class="ruby-keyword kw">for</span> <span class="ruby-identifier">account_dollar</span> <span class="ruby-keyword kw">in</span> <span class="ruby-ivar">@accounts_dollar</span>
2290:             <span class="ruby-ivar">@sum_dollar</span> = <span class="ruby-ivar">@sum_dollar</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">account_dollar</span>.<span class="ruby-identifier">f_money</span>
2291:         <span class="ruby-keyword kw">end</span>        
2292:         <span class="ruby-ivar">@format_fmt38a</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;16$$$&gt;&quot;</span>,<span class="ruby-ivar">@sum_dollar</span>,<span class="ruby-ivar">@format_fmt38a</span>) 
2293:         <span class="ruby-comment cmt">#争议类型（该案的类型，立案时选定的）--仲裁协议类型</span>
2294:         <span class="ruby-identifier">aribitprotprog_num</span> = <span class="ruby-constant">TbCase</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:first</span>,<span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">&quot;used = 'Y' and recevice_code = ?&quot;</span>,<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]]).<span class="ruby-identifier">aribitprotprog_num</span>
2295:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">aribitprotprog_num</span> <span class="ruby-operator">!=</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-identifier">aribitprotprog_num</span> <span class="ruby-operator">!=</span> <span class="ruby-value str">&quot;&quot;</span>
2296:             <span class="ruby-ivar">@case_typ</span> = <span class="ruby-constant">TbDictionary</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:first</span>,<span class="ruby-identifier">:conditions=</span><span class="ruby-operator">&gt;</span> [<span class="ruby-value str">&quot;typ_code='0003' and state='Y' and data_val = ?&quot;</span>,<span class="ruby-identifier">aribitprotprog_num</span>].<span class="ruby-identifier">data_text</span>)
2297:         <span class="ruby-keyword kw">end</span>
2298:         <span class="ruby-ivar">@format_fmt38a</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;17$$$&gt;&quot;</span>,<span class="ruby-ivar">@case_typ</span>,<span class="ruby-ivar">@format_fmt38a</span>) 
2299:         <span class="ruby-comment cmt">#助理</span>
2300:         <span class="ruby-identifier">clerk_code</span> = <span class="ruby-constant">TbCase</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:first</span>,<span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">&quot;used = 'Y' and recevice_code = ?&quot;</span>,<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]]).<span class="ruby-identifier">clerk</span>
2301:         <span class="ruby-identifier">clerk</span> = <span class="ruby-constant">User</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:first</span>,<span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">&quot;used = 'Y' and code = ?&quot;</span>,<span class="ruby-identifier">clerk_code</span>])
2302:         <span class="ruby-ivar">@case_alerk</span> = <span class="ruby-identifier">clerk</span>.<span class="ruby-identifier">name</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">clerk</span>.<span class="ruby-identifier">sex</span>
2303:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@case_alerk</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@case_alerk</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
2304:             <span class="ruby-ivar">@case_alerk</span> = <span class="ruby-value str">&quot;no&quot;</span>
2305:         <span class="ruby-keyword kw">end</span>       
2306:         <span class="ruby-ivar">@format_fmt38a</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;18$$$&gt;&quot;</span>,<span class="ruby-ivar">@case_alerk</span>,<span class="ruby-ivar">@format_fmt38a</span>)  
2307:         <span class="ruby-comment cmt">#电话        </span>
2308:         <span class="ruby-ivar">@telephone</span> = <span class="ruby-identifier">clerk</span>.<span class="ruby-identifier">telephone</span>
2309:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@telephone</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@telephone</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
2310:             <span class="ruby-ivar">@telephone</span> = <span class="ruby-value str">&quot;no&quot;</span>
2311:         <span class="ruby-keyword kw">end</span>     
2312:         <span class="ruby-ivar">@format_fmt38a</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;19$$$&gt;&quot;</span>,<span class="ruby-ivar">@telephone</span>,<span class="ruby-ivar">@format_fmt38a</span>)       
2313:         <span class="ruby-comment cmt">#传真</span>
2314:         <span class="ruby-ivar">@fax</span> = <span class="ruby-identifier">clerk</span>.<span class="ruby-identifier">fax</span>
2315:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@fax</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@fax</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
2316:             <span class="ruby-ivar">@fax</span> = <span class="ruby-value str">&quot;no&quot;</span>
2317:         <span class="ruby-keyword kw">end</span>    
2318:         <span class="ruby-ivar">@format_fmt38a</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;20$$$&gt;&quot;</span>,<span class="ruby-ivar">@fax</span>,<span class="ruby-ivar">@format_fmt38a</span>)     
2319:         <span class="ruby-comment cmt">#电子邮箱</span>
2320:         <span class="ruby-ivar">@email</span> = <span class="ruby-identifier">clerk</span>.<span class="ruby-identifier">email</span>
2321:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@email</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@email</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
2322:             <span class="ruby-ivar">@email</span> = <span class="ruby-value str">&quot;no&quot;</span>
2323:         <span class="ruby-keyword kw">end</span>  
2324:         <span class="ruby-ivar">@format_fmt38a</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;21$$$&gt;&quot;</span>,<span class="ruby-ivar">@email</span>,<span class="ruby-ivar">@format_fmt38a</span>)         
2325:         <span class="ruby-comment cmt">#日期</span>
2326:         <span class="ruby-ivar">@date_of_letter</span> = <span class="ruby-constant">Time</span>.<span class="ruby-identifier">now</span>.<span class="ruby-identifier">to_s</span>(<span class="ruby-identifier">:db</span>)
2327:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@date_of_letter</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@date_of_letter</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
2328:             <span class="ruby-ivar">@date_of_letter</span> = <span class="ruby-value str">&quot;no&quot;</span>
2329:             <span class="ruby-ivar">@format_fmt38a</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;22$$$&gt;&quot;</span>,<span class="ruby-ivar">@date_of_letter</span>,<span class="ruby-ivar">@format_fmt38a</span>) 
2330:             <span class="ruby-ivar">@format_fmt38a</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;23$$$&gt;&quot;</span>,<span class="ruby-ivar">@date_of_letter</span>,<span class="ruby-ivar">@format_fmt38a</span>)
2331:             <span class="ruby-ivar">@format_fmt38a</span> = <span class="ruby-identifier">add_last_record</span>(<span class="ruby-value str">&quot;&lt;24$$$&gt;&quot;</span>,<span class="ruby-ivar">@date_of_letter</span>,<span class="ruby-ivar">@format_fmt38a</span>)
2332:         <span class="ruby-keyword kw">else</span>
2333:             <span class="ruby-identifier">arr_date</span> = <span class="ruby-ivar">@date_of_letter</span>.<span class="ruby-identifier">to_s</span>.<span class="ruby-identifier">split</span>(<span class="ruby-value str">&quot;-&quot;</span>)
2334:             <span class="ruby-ivar">@format_fmt38a</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;22$$$&gt;&quot;</span>,<span class="ruby-identifier">arr_date</span>[<span class="ruby-value">0</span>],<span class="ruby-ivar">@format_fmt38a</span>) 
2335:             <span class="ruby-ivar">@format_fmt38a</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;23$$$&gt;&quot;</span>,<span class="ruby-identifier">arr_date</span>[<span class="ruby-value">1</span>],<span class="ruby-ivar">@format_fmt38a</span>)
2336:             <span class="ruby-ivar">@format_fmt38a</span> = <span class="ruby-identifier">add_last_record</span>(<span class="ruby-value str">&quot;&lt;24$$$&gt;&quot;</span>,<span class="ruby-identifier">arr_date</span>[<span class="ruby-value">2</span>].<span class="ruby-identifier">slice</span>(<span class="ruby-value">0</span>, <span class="ruby-value">2</span>),<span class="ruby-ivar">@format_fmt38a</span>)            
2337:         <span class="ruby-keyword kw">end</span>   
2338:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000176" class="method-detail">
        <a name="M000176"></a>

        <div class="method-heading">
          <a href="#M000176" class="method-signature">
          <span class="method-name">format_letter_fmt39</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000176-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000176-source">
<pre>
      <span class="ruby-comment cmt"># File app/controllers/format_letter_controller.rb, line 2340</span>
2340:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">format_letter_fmt39</span>
2341:         <span class="ruby-comment cmt">#拼接字串，初始化</span>
2342:         <span class="ruby-ivar">@format_fmt39</span> = <span class="ruby-value str">&quot;&quot;</span>  
2343:         <span class="ruby-comment cmt">#函号</span>
2344:         <span class="ruby-ivar">@file_code</span> = <span class="ruby-constant">TbDoc</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:first</span>,<span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">&quot;used = 'Y' and recevice_code = ?&quot;</span>,<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]])
2345:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@file_code</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@file_code</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
2346:             <span class="ruby-ivar">@file_code</span> = <span class="ruby-value str">&quot;no&quot;</span>
2347:         <span class="ruby-keyword kw">else</span>
2348:             <span class="ruby-ivar">@file_code</span> = <span class="ruby-ivar">@file_code</span>.<span class="ruby-identifier">file_code</span>
2349:         <span class="ruby-keyword kw">end</span>
2350:         <span class="ruby-ivar">@format_fmt39</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;01$$$&gt;&quot;</span>,<span class="ruby-ivar">@file_code</span>,<span class="ruby-ivar">@format_fmt39</span>)
2351:         <span class="ruby-comment cmt">#立案号</span>
2352:         <span class="ruby-ivar">@case_code</span> = <span class="ruby-constant">TbCase</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:first</span>, <span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">&quot;used = 'Y' and recevice_code = ?&quot;</span>,<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]]).<span class="ruby-identifier">case_code</span>
2353:         <span class="ruby-ivar">@format_fmt39</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;02$$$&gt;&quot;</span>,<span class="ruby-ivar">@case_code</span>,<span class="ruby-ivar">@format_fmt39</span>)         
2354:         <span class="ruby-comment cmt">#申请人</span>
2355:         <span class="ruby-ivar">@applicants</span> = <span class="ruby-constant">TbParty</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:all</span>,<span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">&quot;used = 'Y' and partytype = 1 and recevice_code = ?&quot;</span>,<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]], <span class="ruby-identifier">:order</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;id&quot;</span>)
2356:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@applicants</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@applicants</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
2357:             <span class="ruby-ivar">@applicant</span> = <span class="ruby-value str">&quot;no&quot;</span>
2358:         <span class="ruby-keyword kw">else</span>
2359:             <span class="ruby-ivar">@applicant</span> = <span class="ruby-value str">&quot;&quot;</span>
2360:             <span class="ruby-ivar">@applicants</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">applicant</span><span class="ruby-operator">|</span>
2361:                 <span class="ruby-ivar">@applicant</span> = <span class="ruby-ivar">@applicant</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">applicant</span>.<span class="ruby-identifier">partyname</span>
2362:             <span class="ruby-keyword kw">end</span>
2363:         <span class="ruby-keyword kw">end</span>        
2364:         <span class="ruby-ivar">@format_fmt39</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;03$$$&gt;&quot;</span>,<span class="ruby-ivar">@applicant</span>,<span class="ruby-ivar">@format_fmt39</span>)
2365:         <span class="ruby-comment cmt">#被申请人</span>
2366:         <span class="ruby-ivar">@respondents</span> = <span class="ruby-constant">TbParty</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:all</span>,<span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">&quot;used = 'Y' and partytype = 2 and recevice_code = ?&quot;</span>,<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]], <span class="ruby-identifier">:order</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;id&quot;</span>)
2367:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@respondent</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@respondent</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
2368:             <span class="ruby-ivar">@respondent</span> = <span class="ruby-value str">&quot;no&quot;</span>
2369:         <span class="ruby-keyword kw">else</span>
2370:             <span class="ruby-ivar">@respondent</span> = <span class="ruby-value str">&quot;&quot;</span>
2371:             <span class="ruby-ivar">@respondents</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">resp</span><span class="ruby-operator">|</span>
2372:                 <span class="ruby-ivar">@respondent</span> = <span class="ruby-ivar">@respondent</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">resp</span>.<span class="ruby-identifier">partyname</span>
2373:             <span class="ruby-keyword kw">end</span>
2374:         <span class="ruby-keyword kw">end</span>       
2375:         <span class="ruby-ivar">@format_fmt39</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;04$$$&gt;&quot;</span>,<span class="ruby-ivar">@respondent</span>,<span class="ruby-ivar">@format_fmt39</span>)    
2376:         <span class="ruby-comment cmt">#开庭日期</span>
2377:         <span class="ruby-ivar">@sitting_date</span> = <span class="ruby-constant">TbSitting</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:first</span>, <span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">&quot;used = 'Y' and recevice_code = ?&quot;</span>,<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]])
2378:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@sitting_date</span> <span class="ruby-operator">!=</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@sitting_date</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
2379:             <span class="ruby-ivar">@sitting_date</span> = <span class="ruby-ivar">@sitting_date</span>.<span class="ruby-identifier">sittingdate</span>
2380:         <span class="ruby-keyword kw">else</span>
2381:             <span class="ruby-ivar">@sitting_date</span> = <span class="ruby-value str">&quot;no&quot;</span>
2382:         <span class="ruby-keyword kw">end</span>
2383:         <span class="ruby-ivar">@format_fmt39</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;05$$$&gt;&quot;</span>,<span class="ruby-ivar">@sitting_date</span>,<span class="ruby-ivar">@format_fmt39</span>)          
2384:         <span class="ruby-comment cmt">#日期</span>
2385:         <span class="ruby-ivar">@date_of_letter</span> = <span class="ruby-constant">Time</span>.<span class="ruby-identifier">now</span>.<span class="ruby-identifier">to_s</span>(<span class="ruby-identifier">:db</span>)
2386:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@date_of_letter</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@date_of_letter</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
2387:             <span class="ruby-ivar">@date_of_letter</span> = <span class="ruby-value str">&quot;no&quot;</span>
2388:             <span class="ruby-ivar">@format_fmt39</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;06$$$&gt;&quot;</span>,<span class="ruby-ivar">@date_of_letter</span>,<span class="ruby-ivar">@format_fmt39</span>) 
2389:             <span class="ruby-ivar">@format_fmt39</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;07$$$&gt;&quot;</span>,<span class="ruby-ivar">@date_of_letter</span>,<span class="ruby-ivar">@format_fmt39</span>)
2390:             <span class="ruby-ivar">@format_fmt39</span> = <span class="ruby-identifier">add_last_record</span>(<span class="ruby-value str">&quot;&lt;08$$$&gt;&quot;</span>,<span class="ruby-ivar">@date_of_letter</span>,<span class="ruby-ivar">@format_fmt39</span>)
2391:         <span class="ruby-keyword kw">else</span>
2392:             <span class="ruby-identifier">arr_date</span> = <span class="ruby-ivar">@date_of_letter</span>.<span class="ruby-identifier">to_s</span>.<span class="ruby-identifier">split</span>(<span class="ruby-value str">&quot;-&quot;</span>)
2393:             <span class="ruby-ivar">@format_fmt39</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;06$$$&gt;&quot;</span>,<span class="ruby-identifier">arr_date</span>[<span class="ruby-value">0</span>],<span class="ruby-ivar">@format_fmt39</span>) 
2394:             <span class="ruby-ivar">@format_fmt39</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;07$$$&gt;&quot;</span>,<span class="ruby-identifier">arr_date</span>[<span class="ruby-value">1</span>],<span class="ruby-ivar">@format_fmt39</span>)
2395:             <span class="ruby-ivar">@format_fmt39</span> = <span class="ruby-identifier">add_last_record</span>(<span class="ruby-value str">&quot;&lt;08$$$&gt;&quot;</span>,<span class="ruby-identifier">arr_date</span>[<span class="ruby-value">2</span>].<span class="ruby-identifier">slice</span>(<span class="ruby-value">0</span>, <span class="ruby-value">2</span>),<span class="ruby-ivar">@format_fmt39</span>)            
2396:         <span class="ruby-keyword kw">end</span>   
2397:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000177" class="method-detail">
        <a name="M000177"></a>

        <div class="method-heading">
          <a href="#M000177" class="method-signature">
          <span class="method-name">format_letter_fmt40</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000177-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000177-source">
<pre>
      <span class="ruby-comment cmt"># File app/controllers/format_letter_controller.rb, line 2399</span>
2399:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">format_letter_fmt40</span>
2400:         <span class="ruby-comment cmt">#拼接字串，初始化</span>
2401:         <span class="ruby-ivar">@format_fmt40</span> = <span class="ruby-value str">&quot;&quot;</span>  
2402:         <span class="ruby-comment cmt">#函号</span>
2403:         <span class="ruby-ivar">@file_code</span> = <span class="ruby-constant">TbDoc</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:first</span>,<span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">&quot;used = 'Y' and recevice_code = ?&quot;</span>,<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]])
2404:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@file_code</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@file_code</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
2405:             <span class="ruby-ivar">@file_code</span> = <span class="ruby-value str">&quot;no&quot;</span>
2406:         <span class="ruby-keyword kw">else</span>
2407:             <span class="ruby-ivar">@file_code</span> = <span class="ruby-ivar">@file_code</span>.<span class="ruby-identifier">file_code</span>
2408:         <span class="ruby-keyword kw">end</span>
2409:         <span class="ruby-ivar">@format_fmt40</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;01$$$&gt;&quot;</span>,<span class="ruby-ivar">@file_code</span>,<span class="ruby-ivar">@format_fmt40</span>)        
2410:         <span class="ruby-comment cmt">#立案号</span>
2411:         <span class="ruby-ivar">@case_code</span> = <span class="ruby-constant">TbCase</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:first</span>, <span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">&quot;used = 'Y' and recevice_code = ?&quot;</span>,<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]]).<span class="ruby-identifier">case_code</span>
2412:         <span class="ruby-ivar">@format_fmt40</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;02$$$&gt;&quot;</span>,<span class="ruby-ivar">@case_code</span>,<span class="ruby-ivar">@format_fmt40</span>)  
2413:         <span class="ruby-ivar">@format_fmt40</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;04$$$&gt;&quot;</span>,<span class="ruby-ivar">@case_code</span>,<span class="ruby-ivar">@format_fmt40</span>)
2414:         <span class="ruby-comment cmt">#&lt;03$$$&gt;仲裁员的报告 -- 选定 或者 指定 或者 代指定 等###</span>
2415:         <span class="ruby-comment cmt">#</span>
2416:         <span class="ruby-comment cmt">#</span>
2417:         <span class="ruby-comment cmt">#申请人</span>
2418:         <span class="ruby-ivar">@applicants</span> = <span class="ruby-constant">TbParty</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:all</span>,<span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">&quot;used = 'Y' and partytype = 1 and recevice_code = ?&quot;</span>,<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]], <span class="ruby-identifier">:order</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;id&quot;</span>)
2419:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@applicants</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@applicants</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
2420:             <span class="ruby-ivar">@applicant</span> = <span class="ruby-value str">&quot;no&quot;</span>
2421:         <span class="ruby-keyword kw">else</span>
2422:             <span class="ruby-ivar">@applicant</span> = <span class="ruby-value str">&quot;&quot;</span>
2423:             <span class="ruby-ivar">@applicants</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">applicant</span><span class="ruby-operator">|</span>
2424:                 <span class="ruby-ivar">@applicant</span> = <span class="ruby-ivar">@applicant</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">applicant</span>.<span class="ruby-identifier">partyname</span>
2425:             <span class="ruby-keyword kw">end</span>
2426:         <span class="ruby-keyword kw">end</span>        
2427:         <span class="ruby-ivar">@format_fmt40</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;05$$$&gt;&quot;</span>,<span class="ruby-ivar">@applicant</span>,<span class="ruby-ivar">@format_fmt40</span>)
2428:         <span class="ruby-comment cmt">#申请人代理人(可多名？）</span>
2429:         <span class="ruby-ivar">@applicant_agent</span> = <span class="ruby-constant">TbAgent</span>.<span class="ruby-identifier">find</span>(<span class="ruby-ivar">@applicants</span>.<span class="ruby-identifier">id</span>)
2430:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@applicant_agent</span> <span class="ruby-operator">!=</span> <span class="ruby-keyword kw">nil</span>
2431:             <span class="ruby-ivar">@applicant_agent</span> = <span class="ruby-ivar">@applicant_agent</span>.<span class="ruby-identifier">name</span>
2432:             <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@applicant_agent</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
2433:                 <span class="ruby-ivar">@applicant_agent</span> = <span class="ruby-value str">&quot;no&quot;</span>
2434:             <span class="ruby-keyword kw">end</span>
2435:         <span class="ruby-keyword kw">else</span>
2436:             <span class="ruby-ivar">@applicant_agent</span> = <span class="ruby-value str">&quot;no&quot;</span>
2437:         <span class="ruby-keyword kw">end</span>
2438:         <span class="ruby-ivar">@format_fmt40</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;06$$$&gt;&quot;</span>,<span class="ruby-ivar">@applicant_agent</span>,<span class="ruby-ivar">@format_fmt40</span>)
2439:         <span class="ruby-comment cmt">#被申请人</span>
2440:         <span class="ruby-ivar">@respondents</span> = <span class="ruby-constant">TbParty</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:all</span>,<span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">&quot;used = 'Y' and partytype = 2 and recevice_code = ?&quot;</span>,<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]], <span class="ruby-identifier">:order</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;id&quot;</span>)
2441:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@respondent</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@respondent</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
2442:             <span class="ruby-ivar">@respondent</span> = <span class="ruby-value str">&quot;no&quot;</span>
2443:         <span class="ruby-keyword kw">else</span>
2444:             <span class="ruby-ivar">@respondent</span> = <span class="ruby-value str">&quot;&quot;</span>
2445:             <span class="ruby-ivar">@respondents</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">resp</span><span class="ruby-operator">|</span>
2446:                 <span class="ruby-ivar">@respondent</span> = <span class="ruby-ivar">@respondent</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">resp</span>.<span class="ruby-identifier">partyname</span>
2447:             <span class="ruby-keyword kw">end</span>
2448:         <span class="ruby-keyword kw">end</span>       
2449:         <span class="ruby-ivar">@format_fmt40</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;07$$$&gt;&quot;</span>,<span class="ruby-ivar">@respondent</span>,<span class="ruby-ivar">@format_fmt40</span>)
2450:         <span class="ruby-comment cmt">#被申请人代理人(可多名？）</span>
2451:         <span class="ruby-ivar">@respondent_agent</span> = <span class="ruby-constant">TbAgent</span>.<span class="ruby-identifier">find</span>(<span class="ruby-ivar">@respondents</span>.<span class="ruby-identifier">id</span>)
2452:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@respondent_agent</span> <span class="ruby-operator">!=</span> <span class="ruby-keyword kw">nil</span>
2453:             <span class="ruby-ivar">@respondent_agent</span> = <span class="ruby-ivar">@respondent_agent</span>.<span class="ruby-identifier">name</span>
2454:             <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@respondent_agent</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
2455:                 <span class="ruby-ivar">@respondent_agent</span> = <span class="ruby-value str">&quot;no&quot;</span>
2456:             <span class="ruby-keyword kw">end</span>
2457:         <span class="ruby-keyword kw">else</span>
2458:             <span class="ruby-ivar">@respondent_agent</span> = <span class="ruby-value str">&quot;no&quot;</span>
2459:         <span class="ruby-keyword kw">end</span>
2460:         <span class="ruby-ivar">@format_fmt40</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;08$$$&gt;&quot;</span>,<span class="ruby-ivar">@respondent_agent</span>,<span class="ruby-ivar">@format_fmt40</span>)
2461:         <span class="ruby-comment cmt">### 关于&lt;09$$$&gt;仲裁及&lt;10$$$&gt;程序的有关规定--指国内、涉外、及  简易、普通的意思，从程序内容中取 ###</span>
2462:         <span class="ruby-comment cmt">#</span>
2463:         <span class="ruby-comment cmt">#</span>
2464:         <span class="ruby-comment cmt">#  11-13 是仲裁庭组成的，涉及参数判断等</span>
2465:         <span class="ruby-comment cmt">#  </span>
2466:         <span class="ruby-comment cmt">#  </span>
2467:         <span class="ruby-comment cmt">#  办案秘书--助理</span>
2468:         <span class="ruby-comment cmt">#助理</span>
2469:         <span class="ruby-identifier">clerk_code</span> = <span class="ruby-constant">TbCase</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:first</span>,<span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">&quot;used = 'Y' and recevice_code = ?&quot;</span>,<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]]).<span class="ruby-identifier">clerk</span>
2470:         <span class="ruby-identifier">clerk</span> = <span class="ruby-constant">User</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:first</span>,<span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">&quot;used = 'Y' and code = ?&quot;</span>,<span class="ruby-identifier">clerk_code</span>])
2471:         <span class="ruby-ivar">@case_alerk</span> = <span class="ruby-identifier">clerk</span>.<span class="ruby-identifier">name</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">clerk</span>.<span class="ruby-identifier">sex</span>
2472:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@case_alerk</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@case_alerk</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
2473:             <span class="ruby-ivar">@case_alerk</span> = <span class="ruby-value str">&quot;no&quot;</span>
2474:         <span class="ruby-keyword kw">end</span>       
2475:         <span class="ruby-ivar">@format_fmt40</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;14$$$&gt;&quot;</span>,<span class="ruby-ivar">@case_alerk</span>,<span class="ruby-ivar">@format_fmt40</span>)         
2476:         <span class="ruby-comment cmt">#日期</span>
2477:         <span class="ruby-ivar">@date_of_letter</span> = <span class="ruby-constant">Time</span>.<span class="ruby-identifier">now</span>.<span class="ruby-identifier">to_s</span>(<span class="ruby-identifier">:db</span>)
2478:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@date_of_letter</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@date_of_letter</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
2479:             <span class="ruby-ivar">@date_of_letter</span> = <span class="ruby-value str">&quot;no&quot;</span>
2480:             <span class="ruby-ivar">@format_fmt40</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;15$$$&gt;&quot;</span>,<span class="ruby-ivar">@date_of_letter</span>,<span class="ruby-ivar">@format_fmt40</span>) 
2481:             <span class="ruby-ivar">@format_fmt40</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;16$$$&gt;&quot;</span>,<span class="ruby-ivar">@date_of_letter</span>,<span class="ruby-ivar">@format_fmt40</span>)
2482:             <span class="ruby-ivar">@format_fmt40</span> = <span class="ruby-identifier">add_last_record</span>(<span class="ruby-value str">&quot;&lt;17$$$&gt;&quot;</span>,<span class="ruby-ivar">@date_of_letter</span>,<span class="ruby-ivar">@format_fmt40</span>)
2483:         <span class="ruby-keyword kw">else</span>
2484:             <span class="ruby-identifier">arr_date</span> = <span class="ruby-ivar">@date_of_letter</span>.<span class="ruby-identifier">to_s</span>.<span class="ruby-identifier">split</span>(<span class="ruby-value str">&quot;-&quot;</span>)
2485:             <span class="ruby-ivar">@format_fmt40</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;15$$$&gt;&quot;</span>,<span class="ruby-identifier">arr_date</span>[<span class="ruby-value">0</span>],<span class="ruby-ivar">@format_fmt40</span>) 
2486:             <span class="ruby-ivar">@format_fmt40</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;16$$$&gt;&quot;</span>,<span class="ruby-identifier">arr_date</span>[<span class="ruby-value">1</span>],<span class="ruby-ivar">@format_fmt40</span>)
2487:             <span class="ruby-ivar">@format_fmt40</span> = <span class="ruby-identifier">add_last_record</span>(<span class="ruby-value str">&quot;&lt;17$$$&gt;&quot;</span>,<span class="ruby-identifier">arr_date</span>[<span class="ruby-value">2</span>].<span class="ruby-identifier">slice</span>(<span class="ruby-value">0</span>, <span class="ruby-value">2</span>),<span class="ruby-ivar">@format_fmt40</span>)            
2488:         <span class="ruby-keyword kw">end</span>           
2489:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000178" class="method-detail">
        <a name="M000178"></a>

        <div class="method-heading">
          <a href="#M000178" class="method-signature">
          <span class="method-name">format_letter_fmt41</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
字段不明确，空缺#
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000178-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000178-source">
<pre>
      <span class="ruby-comment cmt"># File app/controllers/format_letter_controller.rb, line 2492</span>
2492:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">format_letter_fmt41</span>
2493:         
2494:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000179" class="method-detail">
        <a name="M000179"></a>

        <div class="method-heading">
          <a href="#M000179" class="method-signature">
          <span class="method-name">format_letter_fmt42</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000179-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000179-source">
<pre>
      <span class="ruby-comment cmt"># File app/controllers/format_letter_controller.rb, line 2496</span>
2496:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">format_letter_fmt42</span>
2497:         <span class="ruby-comment cmt">#拼接字串，初始化</span>
2498:         <span class="ruby-ivar">@format_fmt42</span> = <span class="ruby-value str">&quot;&quot;</span>  
2499:         <span class="ruby-comment cmt">#函号</span>
2500:         <span class="ruby-ivar">@file_code</span> = <span class="ruby-constant">TbDoc</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:first</span>,<span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">&quot;used = 'Y' and recevice_code = ?&quot;</span>,<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]])
2501:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@file_code</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@file_code</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
2502:             <span class="ruby-ivar">@file_code</span> = <span class="ruby-value str">&quot;no&quot;</span>
2503:         <span class="ruby-keyword kw">else</span>
2504:             <span class="ruby-ivar">@file_code</span> = <span class="ruby-ivar">@file_code</span>.<span class="ruby-identifier">file_code</span>
2505:         <span class="ruby-keyword kw">end</span>
2506:         <span class="ruby-ivar">@format_fmt42</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;01$$$&gt;&quot;</span>,<span class="ruby-ivar">@file_code</span>,<span class="ruby-ivar">@format_fmt42</span>)
2507:         <span class="ruby-comment cmt">#立案号</span>
2508:         <span class="ruby-ivar">@case_code</span> = <span class="ruby-constant">TbCase</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:first</span>, <span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">&quot;used = 'Y' and recevice_code = ?&quot;</span>,<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]]).<span class="ruby-identifier">case_code</span>
2509:         <span class="ruby-ivar">@format_fmt42</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;02$$$&gt;&quot;</span>,<span class="ruby-ivar">@case_code</span>,<span class="ruby-ivar">@format_fmt42</span>)            
2510:         <span class="ruby-comment cmt">#日期</span>
2511:         <span class="ruby-ivar">@date_of_letter</span> = <span class="ruby-constant">Time</span>.<span class="ruby-identifier">now</span>.<span class="ruby-identifier">to_s</span>(<span class="ruby-identifier">:db</span>)
2512:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@date_of_letter</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@date_of_letter</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
2513:             <span class="ruby-ivar">@date_of_letter</span> = <span class="ruby-value str">&quot;no&quot;</span>
2514:             <span class="ruby-ivar">@format_fmt42</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;03$$$&gt;&quot;</span>,<span class="ruby-ivar">@date_of_letter</span>,<span class="ruby-ivar">@format_fmt42</span>) 
2515:             <span class="ruby-ivar">@format_fmt42</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;04$$$&gt;&quot;</span>,<span class="ruby-ivar">@date_of_letter</span>,<span class="ruby-ivar">@format_fmt42</span>)
2516:             <span class="ruby-ivar">@format_fmt42</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;05$$$&gt;&quot;</span>,<span class="ruby-ivar">@date_of_letter</span>,<span class="ruby-ivar">@format_fmt42</span>)
2517:         <span class="ruby-keyword kw">else</span>
2518:             <span class="ruby-identifier">arr_date</span> = <span class="ruby-ivar">@date_of_letter</span>.<span class="ruby-identifier">to_s</span>.<span class="ruby-identifier">split</span>(<span class="ruby-value str">&quot;-&quot;</span>)
2519:             <span class="ruby-ivar">@format_fmt42</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;03$$$&gt;&quot;</span>,<span class="ruby-identifier">arr_date</span>[<span class="ruby-value">0</span>],<span class="ruby-ivar">@format_fmt42</span>) 
2520:             <span class="ruby-ivar">@format_fmt42</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;04$$$&gt;&quot;</span>,<span class="ruby-identifier">arr_date</span>[<span class="ruby-value">1</span>],<span class="ruby-ivar">@format_fmt42</span>)
2521:             <span class="ruby-ivar">@format_fmt42</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;05$$$&gt;&quot;</span>,<span class="ruby-identifier">arr_date</span>[<span class="ruby-value">2</span>].<span class="ruby-identifier">slice</span>(<span class="ruby-value">0</span>, <span class="ruby-value">2</span>),<span class="ruby-ivar">@format_fmt42</span>)            
2522:         <span class="ruby-keyword kw">end</span>  
2523:         <span class="ruby-comment cmt">#联系人--确定是否是助理</span>
2524:         <span class="ruby-identifier">clerk_code</span> = <span class="ruby-constant">TbCase</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:first</span>,<span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">&quot;used = 'Y' and recevice_code = ?&quot;</span>,<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]]).<span class="ruby-identifier">clerk</span>
2525:         <span class="ruby-identifier">clerk</span> = <span class="ruby-constant">User</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:first</span>,<span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">&quot;used = 'Y' and code = ?&quot;</span>,<span class="ruby-identifier">clerk_code</span>])
2526:         <span class="ruby-ivar">@case_alerk</span> = <span class="ruby-identifier">clerk</span>.<span class="ruby-identifier">name</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">clerk</span>.<span class="ruby-identifier">sex</span>
2527:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@case_alerk</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@case_alerk</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
2528:             <span class="ruby-ivar">@case_alerk</span> = <span class="ruby-value str">&quot;no&quot;</span>
2529:         <span class="ruby-keyword kw">end</span>       
2530:         <span class="ruby-ivar">@format_fmt42</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;06$$$&gt;&quot;</span>,<span class="ruby-ivar">@case_alerk</span>,<span class="ruby-ivar">@format_fmt42</span>)  
2531:         <span class="ruby-comment cmt">#电话        </span>
2532:         <span class="ruby-ivar">@telephone</span> = <span class="ruby-identifier">clerk</span>.<span class="ruby-identifier">telephone</span>
2533:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@telephone</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@telephone</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
2534:             <span class="ruby-ivar">@telephone</span> = <span class="ruby-value str">&quot;no&quot;</span>
2535:         <span class="ruby-keyword kw">end</span>     
2536:         <span class="ruby-ivar">@format_fmt42</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;07$$$&gt;&quot;</span>,<span class="ruby-ivar">@telephone</span>,<span class="ruby-ivar">@format_fmt42</span>)       
2537:         <span class="ruby-comment cmt">#传真</span>
2538:         <span class="ruby-ivar">@fax</span> = <span class="ruby-identifier">clerk</span>.<span class="ruby-identifier">fax</span>
2539:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@fax</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@fax</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
2540:             <span class="ruby-ivar">@fax</span> = <span class="ruby-value str">&quot;no&quot;</span>
2541:         <span class="ruby-keyword kw">end</span>    
2542:         <span class="ruby-ivar">@format_fmt42</span> = <span class="ruby-identifier">add_last_record</span>(<span class="ruby-value str">&quot;&lt;08$$$&gt;&quot;</span>,<span class="ruby-ivar">@fax</span>,<span class="ruby-ivar">@format_fmt42</span>)             
2543:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000180" class="method-detail">
        <a name="M000180"></a>

        <div class="method-heading">
          <a href="#M000180" class="method-signature">
          <span class="method-name">format_letter_fmt44</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000180-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000180-source">
<pre>
      <span class="ruby-comment cmt"># File app/controllers/format_letter_controller.rb, line 2545</span>
2545:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">format_letter_fmt44</span>
2546:         <span class="ruby-comment cmt">#拼接字串，初始化</span>
2547:         <span class="ruby-ivar">@format_fmt44</span> = <span class="ruby-value str">&quot;&quot;</span>  
2548:         <span class="ruby-comment cmt">#函号</span>
2549:         <span class="ruby-ivar">@file_code</span> = <span class="ruby-constant">TbDoc</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:first</span>,<span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">&quot;used = 'Y' and recevice_code = ?&quot;</span>,<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]])
2550:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@file_code</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@file_code</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
2551:             <span class="ruby-ivar">@file_code</span> = <span class="ruby-value str">&quot;no&quot;</span>
2552:         <span class="ruby-keyword kw">else</span>
2553:             <span class="ruby-ivar">@file_code</span> = <span class="ruby-ivar">@file_code</span>.<span class="ruby-identifier">file_code</span>
2554:         <span class="ruby-keyword kw">end</span>
2555:         <span class="ruby-ivar">@format_fmt44</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;01$$$&gt;&quot;</span>,<span class="ruby-ivar">@file_code</span>,<span class="ruby-ivar">@format_fmt44</span>)
2556:         <span class="ruby-comment cmt">#立案号</span>
2557:         <span class="ruby-ivar">@case_code</span> = <span class="ruby-constant">TbCase</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:first</span>, <span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">&quot;used = 'Y' and recevice_code = ?&quot;</span>,<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]]).<span class="ruby-identifier">case_code</span>
2558:         <span class="ruby-ivar">@format_fmt44</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;02$$$&gt;&quot;</span>,<span class="ruby-ivar">@case_code</span>,<span class="ruby-ivar">@format_fmt44</span>)         
2559:         <span class="ruby-comment cmt">#申请人</span>
2560:         <span class="ruby-ivar">@applicants</span> = <span class="ruby-constant">TbParty</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:all</span>,<span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">&quot;used = 'Y' and partytype = 1 and recevice_code = ?&quot;</span>,<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]], <span class="ruby-identifier">:order</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;id&quot;</span>)
2561:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@applicants</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@applicants</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
2562:             <span class="ruby-ivar">@applicant</span> = <span class="ruby-value str">&quot;no&quot;</span>
2563:         <span class="ruby-keyword kw">else</span>
2564:             <span class="ruby-ivar">@applicant</span> = <span class="ruby-value str">&quot;&quot;</span>
2565:             <span class="ruby-ivar">@applicants</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">applicant</span><span class="ruby-operator">|</span>
2566:                 <span class="ruby-ivar">@applicant</span> = <span class="ruby-ivar">@applicant</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">applicant</span>.<span class="ruby-identifier">partyname</span>
2567:             <span class="ruby-keyword kw">end</span>
2568:         <span class="ruby-keyword kw">end</span>        
2569:         <span class="ruby-ivar">@format_fmt44</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;03$$$&gt;&quot;</span>,<span class="ruby-ivar">@applicant</span>,<span class="ruby-ivar">@format_fmt44</span>)
2570:         <span class="ruby-comment cmt">#被申请人</span>
2571:         <span class="ruby-ivar">@respondents</span> = <span class="ruby-constant">TbParty</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:all</span>,<span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">&quot;used = 'Y' and partytype = 2 and recevice_code = ?&quot;</span>,<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]], <span class="ruby-identifier">:order</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;id&quot;</span>)
2572:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@respondent</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@respondent</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
2573:             <span class="ruby-ivar">@respondent</span> = <span class="ruby-value str">&quot;no&quot;</span>
2574:         <span class="ruby-keyword kw">else</span>
2575:             <span class="ruby-ivar">@respondent</span> = <span class="ruby-value str">&quot;&quot;</span>
2576:             <span class="ruby-ivar">@respondents</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">resp</span><span class="ruby-operator">|</span>
2577:                 <span class="ruby-ivar">@respondent</span> = <span class="ruby-ivar">@respondent</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">resp</span>.<span class="ruby-identifier">partyname</span>
2578:             <span class="ruby-keyword kw">end</span>
2579:         <span class="ruby-keyword kw">end</span>       
2580:         <span class="ruby-ivar">@format_fmt44</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;04$$$&gt;&quot;</span>,<span class="ruby-ivar">@respondent</span>,<span class="ruby-ivar">@format_fmt44</span>)         
2581:         <span class="ruby-comment cmt">#日期</span>
2582:         <span class="ruby-ivar">@date_of_letter</span> = <span class="ruby-constant">Time</span>.<span class="ruby-identifier">now</span>.<span class="ruby-identifier">to_s</span>(<span class="ruby-identifier">:db</span>)
2583:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@date_of_letter</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@date_of_letter</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
2584:             <span class="ruby-ivar">@date_of_letter</span> = <span class="ruby-value str">&quot;no&quot;</span>
2585:             <span class="ruby-ivar">@format_fmt44</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;05$$$&gt;&quot;</span>,<span class="ruby-ivar">@date_of_letter</span>,<span class="ruby-ivar">@format_fmt44</span>) 
2586:             <span class="ruby-ivar">@format_fmt44</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;06$$$&gt;&quot;</span>,<span class="ruby-ivar">@date_of_letter</span>,<span class="ruby-ivar">@format_fmt44</span>)
2587:             <span class="ruby-ivar">@format_fmt44</span> = <span class="ruby-identifier">add_last_record</span>(<span class="ruby-value str">&quot;&lt;07$$$&gt;&quot;</span>,<span class="ruby-ivar">@date_of_letter</span>,<span class="ruby-ivar">@format_fmt44</span>)
2588:         <span class="ruby-keyword kw">else</span>
2589:             <span class="ruby-identifier">arr_date</span> = <span class="ruby-ivar">@date_of_letter</span>.<span class="ruby-identifier">to_s</span>.<span class="ruby-identifier">split</span>(<span class="ruby-value str">&quot;-&quot;</span>)
2590:             <span class="ruby-ivar">@format_fmt44</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;05$$$&gt;&quot;</span>,<span class="ruby-identifier">arr_date</span>[<span class="ruby-value">0</span>],<span class="ruby-ivar">@format_fmt44</span>) 
2591:             <span class="ruby-ivar">@format_fmt44</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;06$$$&gt;&quot;</span>,<span class="ruby-identifier">arr_date</span>[<span class="ruby-value">1</span>],<span class="ruby-ivar">@format_fmt44</span>)
2592:             <span class="ruby-ivar">@format_fmt44</span> = <span class="ruby-identifier">add_last_record</span>(<span class="ruby-value str">&quot;&lt;07$$$&gt;&quot;</span>,<span class="ruby-identifier">arr_date</span>[<span class="ruby-value">2</span>].<span class="ruby-identifier">slice</span>(<span class="ruby-value">0</span>, <span class="ruby-value">2</span>),<span class="ruby-ivar">@format_fmt44</span>)            
2593:         <span class="ruby-keyword kw">end</span>   
2594:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000181" class="method-detail">
        <a name="M000181"></a>

        <div class="method-heading">
          <a href="#M000181" class="method-signature">
          <span class="method-name">format_letter_fmt45</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000181-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000181-source">
<pre>
      <span class="ruby-comment cmt"># File app/controllers/format_letter_controller.rb, line 2596</span>
2596:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">format_letter_fmt45</span>
2597:         <span class="ruby-comment cmt">#拼接字串，初始化</span>
2598:         <span class="ruby-ivar">@format_fmt45</span> = <span class="ruby-value str">&quot;&quot;</span>  
2599:         <span class="ruby-comment cmt">#函号</span>
2600:         <span class="ruby-ivar">@file_code</span> = <span class="ruby-constant">TbDoc</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:first</span>,<span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">&quot;used = 'Y' and recevice_code = ?&quot;</span>,<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]])
2601:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@file_code</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@file_code</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
2602:             <span class="ruby-ivar">@file_code</span> = <span class="ruby-value str">&quot;no&quot;</span>
2603:         <span class="ruby-keyword kw">else</span>
2604:             <span class="ruby-ivar">@file_code</span> = <span class="ruby-ivar">@file_code</span>.<span class="ruby-identifier">file_code</span>
2605:         <span class="ruby-keyword kw">end</span>
2606:         <span class="ruby-ivar">@format_fmt45</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;01$$$&gt;&quot;</span>,<span class="ruby-ivar">@file_code</span>,<span class="ruby-ivar">@format_fmt45</span>) 
2607:         <span class="ruby-comment cmt">#日期</span>
2608:         <span class="ruby-ivar">@date_of_letter</span> = <span class="ruby-constant">Time</span>.<span class="ruby-identifier">now</span>.<span class="ruby-identifier">to_s</span>(<span class="ruby-identifier">:db</span>)
2609:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@date_of_letter</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@date_of_letter</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
2610:             <span class="ruby-ivar">@date_of_letter</span> = <span class="ruby-value str">&quot;no&quot;</span>
2611:             <span class="ruby-ivar">@format_fmt45</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;02$$$&gt;&quot;</span>,<span class="ruby-ivar">@date_of_letter</span>,<span class="ruby-ivar">@format_fmt45</span>) 
2612:             <span class="ruby-ivar">@format_fmt45</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;03$$$&gt;&quot;</span>,<span class="ruby-ivar">@date_of_letter</span>,<span class="ruby-ivar">@format_fmt45</span>)
2613:             <span class="ruby-ivar">@format_fmt45</span> = <span class="ruby-identifier">add_last_record</span>(<span class="ruby-value str">&quot;&lt;04$$$&gt;&quot;</span>,<span class="ruby-ivar">@date_of_letter</span>,<span class="ruby-ivar">@format_fmt45</span>)
2614:         <span class="ruby-keyword kw">else</span>
2615:             <span class="ruby-identifier">arr_date</span> = <span class="ruby-ivar">@date_of_letter</span>.<span class="ruby-identifier">to_s</span>.<span class="ruby-identifier">split</span>(<span class="ruby-value str">&quot;-&quot;</span>)
2616:             <span class="ruby-ivar">@format_fmt45</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;02$$$&gt;&quot;</span>,<span class="ruby-identifier">arr_date</span>[<span class="ruby-value">0</span>],<span class="ruby-ivar">@format_fmt45</span>) 
2617:             <span class="ruby-ivar">@format_fmt45</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;03$$$&gt;&quot;</span>,<span class="ruby-identifier">arr_date</span>[<span class="ruby-value">1</span>],<span class="ruby-ivar">@format_fmt45</span>)
2618:             <span class="ruby-ivar">@format_fmt45</span> = <span class="ruby-identifier">add_last_record</span>(<span class="ruby-value str">&quot;&lt;04$$$&gt;&quot;</span>,<span class="ruby-identifier">arr_date</span>[<span class="ruby-value">2</span>].<span class="ruby-identifier">slice</span>(<span class="ruby-value">0</span>, <span class="ruby-value">2</span>),<span class="ruby-ivar">@format_fmt45</span>)            
2619:         <span class="ruby-keyword kw">end</span>   
2620:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000182" class="method-detail">
        <a name="M000182"></a>

        <div class="method-heading">
          <a href="#M000182" class="method-signature">
          <span class="method-name">format_letter_fmt46</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000182-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000182-source">
<pre>
      <span class="ruby-comment cmt"># File app/controllers/format_letter_controller.rb, line 2622</span>
2622:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">format_letter_fmt46</span>
2623:         <span class="ruby-comment cmt">#拼接字串，初始化</span>
2624:         <span class="ruby-ivar">@format_fmt46</span> = <span class="ruby-value str">&quot;&quot;</span>  
2625:         <span class="ruby-comment cmt">#函号</span>
2626:         <span class="ruby-ivar">@file_code</span> = <span class="ruby-constant">TbDoc</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:first</span>,<span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">&quot;used = 'Y' and recevice_code = ?&quot;</span>,<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]])
2627:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@file_code</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@file_code</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
2628:             <span class="ruby-ivar">@file_code</span> = <span class="ruby-value str">&quot;no&quot;</span>
2629:         <span class="ruby-keyword kw">else</span>
2630:             <span class="ruby-ivar">@file_code</span> = <span class="ruby-ivar">@file_code</span>.<span class="ruby-identifier">file_code</span>
2631:         <span class="ruby-keyword kw">end</span>
2632:         <span class="ruby-ivar">@format_fmt46</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;01$$$&gt;&quot;</span>,<span class="ruby-ivar">@file_code</span>,<span class="ruby-ivar">@format_fmt46</span>)       
2633:         <span class="ruby-comment cmt">#申请人</span>
2634:         <span class="ruby-ivar">@applicants</span> = <span class="ruby-constant">TbParty</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:all</span>,<span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">&quot;used = 'Y' and partytype = 1 and recevice_code = ?&quot;</span>,<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]], <span class="ruby-identifier">:order</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;id&quot;</span>)
2635:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@applicants</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@applicants</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
2636:             <span class="ruby-ivar">@applicant</span> = <span class="ruby-value str">&quot;no&quot;</span>
2637:         <span class="ruby-keyword kw">else</span>
2638:             <span class="ruby-ivar">@applicant</span> = <span class="ruby-value str">&quot;&quot;</span>
2639:             <span class="ruby-ivar">@applicants</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">applicant</span><span class="ruby-operator">|</span>
2640:                 <span class="ruby-ivar">@applicant</span> = <span class="ruby-ivar">@applicant</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">applicant</span>.<span class="ruby-identifier">partyname</span>
2641:             <span class="ruby-keyword kw">end</span>
2642:         <span class="ruby-keyword kw">end</span>        
2643:         <span class="ruby-ivar">@format_fmt46</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;02$$$&gt;&quot;</span>,<span class="ruby-ivar">@applicant</span>,<span class="ruby-ivar">@format_fmt46</span>)
2644:         <span class="ruby-comment cmt">#立案号</span>
2645:         <span class="ruby-ivar">@case_code</span> = <span class="ruby-constant">TbCase</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:first</span>, <span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">&quot;used = 'Y' and recevice_code = ?&quot;</span>,<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]]).<span class="ruby-identifier">case_code</span>
2646:         <span class="ruby-ivar">@format_fmt46</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;03$$$&gt;&quot;</span>,<span class="ruby-ivar">@case_code</span>,<span class="ruby-ivar">@format_fmt46</span>)          
2647:         <span class="ruby-comment cmt">#日期</span>
2648:         <span class="ruby-ivar">@date_of_letter</span> = <span class="ruby-constant">Time</span>.<span class="ruby-identifier">now</span>.<span class="ruby-identifier">to_s</span>(<span class="ruby-identifier">:db</span>)
2649:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@date_of_letter</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@date_of_letter</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
2650:             <span class="ruby-ivar">@date_of_letter</span> = <span class="ruby-value str">&quot;no&quot;</span>
2651:             <span class="ruby-ivar">@format_fmt46</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;04$$$&gt;&quot;</span>,<span class="ruby-ivar">@date_of_letter</span>,<span class="ruby-ivar">@format_fmt46</span>) 
2652:             <span class="ruby-ivar">@format_fmt46</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;05$$$&gt;&quot;</span>,<span class="ruby-ivar">@date_of_letter</span>,<span class="ruby-ivar">@format_fmt46</span>)
2653:             <span class="ruby-ivar">@format_fmt46</span> = <span class="ruby-identifier">add_last_record</span>(<span class="ruby-value str">&quot;&lt;06$$$&gt;&quot;</span>,<span class="ruby-ivar">@date_of_letter</span>,<span class="ruby-ivar">@format_fmt46</span>)
2654:         <span class="ruby-keyword kw">else</span>
2655:             <span class="ruby-identifier">arr_date</span> = <span class="ruby-ivar">@date_of_letter</span>.<span class="ruby-identifier">to_s</span>.<span class="ruby-identifier">split</span>(<span class="ruby-value str">&quot;-&quot;</span>)
2656:             <span class="ruby-ivar">@format_fmt46</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;04$$$&gt;&quot;</span>,<span class="ruby-identifier">arr_date</span>[<span class="ruby-value">0</span>],<span class="ruby-ivar">@format_fmt46</span>) 
2657:             <span class="ruby-ivar">@format_fmt46</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;05$$$&gt;&quot;</span>,<span class="ruby-identifier">arr_date</span>[<span class="ruby-value">1</span>],<span class="ruby-ivar">@format_fmt46</span>)
2658:             <span class="ruby-ivar">@format_fmt46</span> = <span class="ruby-identifier">add_last_record</span>(<span class="ruby-value str">&quot;&lt;06$$$&gt;&quot;</span>,<span class="ruby-identifier">arr_date</span>[<span class="ruby-value">2</span>].<span class="ruby-identifier">slice</span>(<span class="ruby-value">0</span>, <span class="ruby-value">2</span>),<span class="ruby-ivar">@format_fmt46</span>)            
2659:         <span class="ruby-keyword kw">end</span>   
2660:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000183" class="method-detail">
        <a name="M000183"></a>

        <div class="method-heading">
          <a href="#M000183" class="method-signature">
          <span class="method-name">format_letter_fmt47</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000183-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000183-source">
<pre>
      <span class="ruby-comment cmt"># File app/controllers/format_letter_controller.rb, line 2662</span>
2662:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">format_letter_fmt47</span>
2663:         <span class="ruby-comment cmt">#拼接字串，初始化</span>
2664:         <span class="ruby-ivar">@format_fmt47</span> = <span class="ruby-value str">&quot;&quot;</span>  
2665:         <span class="ruby-comment cmt">#申请人</span>
2666:         <span class="ruby-ivar">@applicants</span> = <span class="ruby-constant">TbParty</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:all</span>,<span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">&quot;used = 'Y' and partytype = 1 and recevice_code = ?&quot;</span>,<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]], <span class="ruby-identifier">:order</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;id&quot;</span>)
2667:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@applicants</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@applicants</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
2668:             <span class="ruby-ivar">@applicant</span> = <span class="ruby-value str">&quot;no&quot;</span>
2669:         <span class="ruby-keyword kw">else</span>
2670:             <span class="ruby-ivar">@applicant</span> = <span class="ruby-value str">&quot;&quot;</span>
2671:             <span class="ruby-ivar">@applicants</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">applicant</span><span class="ruby-operator">|</span>
2672:                 <span class="ruby-ivar">@applicant</span> = <span class="ruby-ivar">@applicant</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">applicant</span>.<span class="ruby-identifier">partyname</span>
2673:             <span class="ruby-keyword kw">end</span>
2674:         <span class="ruby-keyword kw">end</span>        
2675:         <span class="ruby-ivar">@format_fmt47</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;01$$$&gt;&quot;</span>,<span class="ruby-ivar">@applicant</span>,<span class="ruby-ivar">@format_fmt47</span>)
2676:         <span class="ruby-comment cmt">#被申请人</span>
2677:         <span class="ruby-ivar">@respondents</span> = <span class="ruby-constant">TbParty</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:all</span>,<span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">&quot;used = 'Y' and partytype = 2 and recevice_code = ?&quot;</span>,<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]], <span class="ruby-identifier">:order</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;id&quot;</span>)
2678:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@respondent</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@respondent</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
2679:             <span class="ruby-ivar">@respondent</span> = <span class="ruby-value str">&quot;no&quot;</span>
2680:         <span class="ruby-keyword kw">else</span>
2681:             <span class="ruby-ivar">@respondent</span> = <span class="ruby-value str">&quot;&quot;</span>
2682:             <span class="ruby-ivar">@respondents</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">resp</span><span class="ruby-operator">|</span>
2683:                 <span class="ruby-ivar">@respondent</span> = <span class="ruby-ivar">@respondent</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">resp</span>.<span class="ruby-identifier">partyname</span>
2684:             <span class="ruby-keyword kw">end</span>
2685:         <span class="ruby-keyword kw">end</span>       
2686:         <span class="ruby-ivar">@format_fmt47</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;02$$$&gt;&quot;</span>,<span class="ruby-ivar">@respondent</span>,<span class="ruby-ivar">@format_fmt47</span>)
2687:         <span class="ruby-comment cmt">#立案号</span>
2688:         <span class="ruby-ivar">@case_code</span> = <span class="ruby-constant">TbCase</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:first</span>, <span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">&quot;used = 'Y' and recevice_code = ?&quot;</span>,<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]]).<span class="ruby-identifier">case_code</span>
2689:         <span class="ruby-ivar">@format_fmt47</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;03$$$&gt;&quot;</span>,<span class="ruby-ivar">@case_code</span>,<span class="ruby-ivar">@format_fmt47</span>)  
2690:         <span class="ruby-comment cmt">#首席仲裁员</span>
2691:         <span class="ruby-ivar">@chief_arbitrator</span> = <span class="ruby-identifier">chief_arbitrator</span>(<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>])
2692:         <span class="ruby-ivar">@format_fmt47</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;04$$$&gt;&quot;</span>,<span class="ruby-ivar">@chief_arbitrator</span>,<span class="ruby-ivar">@format_fmt47</span>)
2693:         <span class="ruby-comment cmt">#申请人仲裁员</span>
2694:         <span class="ruby-ivar">@applicant_arbitrator</span> = <span class="ruby-identifier">applicant_arbitrator</span>(<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>])
2695:         <span class="ruby-ivar">@format_fmt47</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;05$$$&gt;&quot;</span>,<span class="ruby-ivar">@applicant_arbitrator</span>,<span class="ruby-ivar">@format_fmt47</span>)
2696:         <span class="ruby-comment cmt">#被申请人仲裁员</span>
2697:         <span class="ruby-ivar">@respondent_arbitrator</span> = <span class="ruby-identifier">respondent_arbitrator</span>(<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>])
2698:         <span class="ruby-ivar">@format_fmt47</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;06$$$&gt;&quot;</span>,<span class="ruby-ivar">@respondent_arbitrator</span>,<span class="ruby-ivar">@format_fmt47</span>)
2699:         <span class="ruby-comment cmt">#日期</span>
2700:         <span class="ruby-ivar">@date_of_letter</span> = <span class="ruby-constant">Time</span>.<span class="ruby-identifier">now</span>.<span class="ruby-identifier">to_s</span>(<span class="ruby-identifier">:db</span>)
2701:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@date_of_letter</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@date_of_letter</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
2702:             <span class="ruby-ivar">@date_of_letter</span> = <span class="ruby-value str">&quot;no&quot;</span>
2703:             <span class="ruby-ivar">@format_fmt47</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;07$$$&gt;&quot;</span>,<span class="ruby-ivar">@date_of_letter</span>,<span class="ruby-ivar">@format_fmt47</span>) 
2704:             <span class="ruby-ivar">@format_fmt47</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;08$$$&gt;&quot;</span>,<span class="ruby-ivar">@date_of_letter</span>,<span class="ruby-ivar">@format_fmt47</span>)
2705:             <span class="ruby-ivar">@format_fmt47</span> = <span class="ruby-identifier">add_last_record</span>(<span class="ruby-value str">&quot;&lt;09$$$&gt;&quot;</span>,<span class="ruby-ivar">@date_of_letter</span>,<span class="ruby-ivar">@format_fmt47</span>)
2706:         <span class="ruby-keyword kw">else</span>
2707:             <span class="ruby-identifier">arr_date</span> = <span class="ruby-ivar">@date_of_letter</span>.<span class="ruby-identifier">to_s</span>.<span class="ruby-identifier">split</span>(<span class="ruby-value str">&quot;-&quot;</span>)
2708:             <span class="ruby-ivar">@format_fmt47</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;07$$$&gt;&quot;</span>,<span class="ruby-identifier">arr_date</span>[<span class="ruby-value">0</span>],<span class="ruby-ivar">@format_fmt47</span>) 
2709:             <span class="ruby-ivar">@format_fmt47</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;08$$$&gt;&quot;</span>,<span class="ruby-identifier">arr_date</span>[<span class="ruby-value">1</span>],<span class="ruby-ivar">@format_fmt47</span>)
2710:             <span class="ruby-ivar">@format_fmt47</span> = <span class="ruby-identifier">add_last_record</span>(<span class="ruby-value str">&quot;&lt;09$$$&gt;&quot;</span>,<span class="ruby-identifier">arr_date</span>[<span class="ruby-value">2</span>].<span class="ruby-identifier">slice</span>(<span class="ruby-value">0</span>, <span class="ruby-value">2</span>),<span class="ruby-ivar">@format_fmt47</span>)            
2711:         <span class="ruby-keyword kw">end</span>   
2712:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000184" class="method-detail">
        <a name="M000184"></a>

        <div class="method-heading">
          <a href="#M000184" class="method-signature">
          <span class="method-name">format_letter_for03</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000184-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000184-source">
<pre>
      <span class="ruby-comment cmt"># File app/controllers/format_letter_controller.rb, line 2714</span>
2714:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">format_letter_for03</span>
2715:         <span class="ruby-comment cmt">#拼接字串，初始化</span>
2716:         <span class="ruby-ivar">@format_for03</span> = <span class="ruby-value str">&quot;&quot;</span>  
2717:         <span class="ruby-comment cmt">#申请人</span>
2718:         <span class="ruby-ivar">@applicants</span> = <span class="ruby-constant">TbParty</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:all</span>,<span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">&quot;used = 'Y' and partytype = 1 and recevice_code = ?&quot;</span>,<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]], <span class="ruby-identifier">:order</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;id&quot;</span>)
2719:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@applicants</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@applicants</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
2720:             <span class="ruby-ivar">@applicant</span> = <span class="ruby-value str">&quot;no&quot;</span>
2721:         <span class="ruby-keyword kw">else</span>
2722:             <span class="ruby-ivar">@applicant</span> = <span class="ruby-value str">&quot;&quot;</span>
2723:             <span class="ruby-ivar">@applicants</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">applicant</span><span class="ruby-operator">|</span>
2724:                 <span class="ruby-ivar">@applicant</span> = <span class="ruby-ivar">@applicant</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">applicant</span>.<span class="ruby-identifier">partyname</span>
2725:             <span class="ruby-keyword kw">end</span>
2726:         <span class="ruby-keyword kw">end</span>        
2727:         <span class="ruby-ivar">@format_for03</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;01$$$&gt;&quot;</span>,<span class="ruby-ivar">@applicant</span>,<span class="ruby-ivar">@format_for03</span>)
2728:         <span class="ruby-comment cmt">#被申请人</span>
2729:         <span class="ruby-ivar">@respondents</span> = <span class="ruby-constant">TbParty</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:all</span>,<span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">&quot;used = 'Y' and partytype = 2 and recevice_code = ?&quot;</span>,<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]], <span class="ruby-identifier">:order</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;id&quot;</span>)
2730:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@respondent</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@respondent</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
2731:             <span class="ruby-ivar">@respondent</span> = <span class="ruby-value str">&quot;no&quot;</span>
2732:         <span class="ruby-keyword kw">else</span>
2733:             <span class="ruby-ivar">@respondent</span> = <span class="ruby-value str">&quot;&quot;</span>
2734:             <span class="ruby-ivar">@respondents</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">resp</span><span class="ruby-operator">|</span>
2735:                 <span class="ruby-ivar">@respondent</span> = <span class="ruby-ivar">@respondent</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">resp</span>.<span class="ruby-identifier">partyname</span>
2736:             <span class="ruby-keyword kw">end</span>
2737:         <span class="ruby-keyword kw">end</span>       
2738:         <span class="ruby-ivar">@format_for03</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;02$$$&gt;&quot;</span>,<span class="ruby-ivar">@respondent</span>,<span class="ruby-ivar">@format_for03</span>)
2739:         <span class="ruby-comment cmt">#案由及类别</span>
2740:         <span class="ruby-ivar">@casetype_num</span> = <span class="ruby-constant">TbCase</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:first</span>, <span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">&quot;used = 'Y' and recevice_code = ?&quot;</span>,<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]])
2741:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@casetype_num</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@casetype_num</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
2742:             <span class="ruby-ivar">@casetype_num</span> = <span class="ruby-value str">&quot;no&quot;</span>
2743:         <span class="ruby-keyword kw">else</span>
2744:             <span class="ruby-ivar">@casetype</span> = <span class="ruby-constant">TbDictionary</span>.<span class="ruby-identifier">find_arbit_type</span>(<span class="ruby-value str">&quot;0002&quot;</span>,<span class="ruby-ivar">@casetype_num</span>).<span class="ruby-identifier">pactname</span>
2745:         <span class="ruby-keyword kw">end</span>   
2746:         <span class="ruby-ivar">@format_for03</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;03$$$&gt;&quot;</span>,<span class="ruby-ivar">@casetype</span>,<span class="ruby-ivar">@format_for03</span>)  
2747:         <span class="ruby-comment cmt">#关于$$$项下争议的仲裁申请文件（合同名称）</span>
2748:         <span class="ruby-ivar">@contract_name</span> = <span class="ruby-constant">TbContractsign</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:first</span>,<span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">&quot;used = 'Y' and recevice_code = ?&quot;</span>,<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]])
2749:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@contract_name</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@contract_name</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
2750:             <span class="ruby-ivar">@contract_name</span> = <span class="ruby-value str">&quot;no&quot;</span>
2751:         <span class="ruby-keyword kw">else</span>
2752:             <span class="ruby-ivar">@contract_name</span> = <span class="ruby-ivar">@contract_name</span>.<span class="ruby-identifier">pactname</span>
2753:         <span class="ruby-keyword kw">end</span>   
2754:         <span class="ruby-ivar">@format_for03</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;04$$$&gt;&quot;</span>,<span class="ruby-ivar">@contract_name</span>,<span class="ruby-ivar">@format_for03</span>)        
2755:         <span class="ruby-comment cmt">#明确争议金额（人民币）</span>
2756:         <span class="ruby-ivar">@accounts_rmb</span> = <span class="ruby-constant">TbCaseAmount</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:all</span>,<span class="ruby-identifier">:conditions=</span><span class="ruby-operator">&gt;</span>[<span class="ruby-value str">&quot;recevice_code= ? and used='Y' and amount_typ= '0001' and currency = '0001'&quot;</span>,<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]],<span class="ruby-identifier">:order=</span><span class="ruby-operator">&gt;</span><span class="ruby-value str">'id'</span>)
2757:         <span class="ruby-ivar">@sum_rmb</span> = <span class="ruby-value">0</span>
2758:         <span class="ruby-keyword kw">for</span> <span class="ruby-identifier">account_rmb</span> <span class="ruby-keyword kw">in</span> <span class="ruby-ivar">@accounts_rmb</span>
2759:             <span class="ruby-ivar">@sum_rmb</span> = <span class="ruby-ivar">@sum_rmb</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">account_rmb</span>.<span class="ruby-identifier">rmb_money</span>
2760:         <span class="ruby-keyword kw">end</span>        
2761:         <span class="ruby-ivar">@format_for03</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;05$$$&gt;&quot;</span>,<span class="ruby-ivar">@sum_rmb</span>,<span class="ruby-ivar">@format_for03</span>) 
2762:         <span class="ruby-comment cmt">#明确争议金额（港币）</span>
2763:         <span class="ruby-ivar">@accounts_hk</span> = <span class="ruby-constant">TbCaseAmount</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:all</span>,<span class="ruby-identifier">:conditions=</span><span class="ruby-operator">&gt;</span>[<span class="ruby-value str">&quot;recevice_code= ? and used='Y' and amount_typ= '0001' and currency = '0001'&quot;</span>,<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]],<span class="ruby-identifier">:order=</span><span class="ruby-operator">&gt;</span><span class="ruby-value str">'id'</span>)
2764:         <span class="ruby-ivar">@sum_hk</span> = <span class="ruby-value">0</span>
2765:         <span class="ruby-keyword kw">for</span> <span class="ruby-identifier">account_hk</span> <span class="ruby-keyword kw">in</span> <span class="ruby-ivar">@accounts_hk</span>
2766:             <span class="ruby-ivar">@sum_hk</span> = <span class="ruby-ivar">@sum_hk</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">account_hk</span>.<span class="ruby-identifier">f_money</span>
2767:         <span class="ruby-keyword kw">end</span>        
2768:         <span class="ruby-ivar">@format_for03</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;06$$$&gt;&quot;</span>,<span class="ruby-ivar">@sum_hk</span>,<span class="ruby-ivar">@format_for03</span>)    
2769:         <span class="ruby-comment cmt">#明确争议金额（美元）</span>
2770:         <span class="ruby-ivar">@accounts_dollar</span> = <span class="ruby-constant">TbCaseAmount</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:all</span>,<span class="ruby-identifier">:conditions=</span><span class="ruby-operator">&gt;</span>[<span class="ruby-value str">&quot;recevice_code= ? and used='Y' and amount_typ= '0001' and currency = '0003'&quot;</span>,<span class="ruby-identifier">session</span>[<span class="ruby-identifier">:recevice_code</span>]],<span class="ruby-identifier">:order=</span><span class="ruby-operator">&gt;</span><span class="ruby-value str">'id'</span>)
2771:         <span class="ruby-ivar">@sum_dollar</span> = <span class="ruby-value">0</span>
2772:         <span class="ruby-keyword kw">for</span> <span class="ruby-identifier">account_dollar</span> <span class="ruby-keyword kw">in</span> <span class="ruby-ivar">@accounts_dollar</span>
2773:             <span class="ruby-ivar">@sum_dollar</span> = <span class="ruby-ivar">@sum_dollar</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">account_dollar</span>.<span class="ruby-identifier">f_money</span>
2774:         <span class="ruby-keyword kw">end</span>        
2775:         <span class="ruby-ivar">@format_for03</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;07$$$&gt;&quot;</span>,<span class="ruby-ivar">@sum_dollar</span>,<span class="ruby-ivar">@format_for03</span>)      
2776:         <span class="ruby-comment cmt">#同期港币汇率</span>
2777:         <span class="ruby-ivar">@hk_rate</span> = <span class="ruby-constant">Money</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:first</span>,<span class="ruby-identifier">:conditions=</span><span class="ruby-operator">&gt;</span>[<span class="ruby-value str">&quot;used='Y' and currency = '0003'&quot;</span>])
2778:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@hk_rate</span> <span class="ruby-operator">!=</span> <span class="ruby-keyword kw">nil</span>
2779:             <span class="ruby-ivar">@hk_rate</span> = <span class="ruby-ivar">@hk_rate</span>.<span class="ruby-identifier">rate</span>
2780:         <span class="ruby-keyword kw">end</span>
2781:         <span class="ruby-ivar">@format_for03</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;08$$$&gt;&quot;</span>,<span class="ruby-ivar">@hk_rate</span>,<span class="ruby-ivar">@format_for03</span>)  
2782:         <span class="ruby-comment cmt">#同期美元汇率</span>
2783:         <span class="ruby-ivar">@dollar_rate</span> = <span class="ruby-constant">Money</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:first</span>,<span class="ruby-identifier">:conditions=</span><span class="ruby-operator">&gt;</span>[<span class="ruby-value str">&quot;used='Y' and currency = '0002'&quot;</span>])
2784:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@dollar_rate</span> <span class="ruby-operator">!=</span> <span class="ruby-keyword kw">nil</span>
2785:             <span class="ruby-ivar">@dollar_rate</span> = <span class="ruby-ivar">@dollar_rate</span>.<span class="ruby-identifier">rate</span>
2786:         <span class="ruby-keyword kw">end</span>     
2787:         <span class="ruby-ivar">@format_for03</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;09$$$&gt;&quot;</span>,<span class="ruby-ivar">@dollar_rate</span>,<span class="ruby-ivar">@format_for03</span>) 
2788:         <span class="ruby-comment cmt">#合计--人民币形式</span>
2789:         <span class="ruby-ivar">@total</span> = <span class="ruby-ivar">@sum_rmb</span>.<span class="ruby-identifier">to_f</span> <span class="ruby-operator">+</span> <span class="ruby-ivar">@sum_hk</span>.<span class="ruby-identifier">to_f</span><span class="ruby-operator">*</span><span class="ruby-ivar">@hk_rate</span>.<span class="ruby-identifier">to_f</span> <span class="ruby-operator">+</span> <span class="ruby-ivar">@sum_dollar</span>.<span class="ruby-identifier">to_f</span><span class="ruby-operator">*</span><span class="ruby-ivar">@dollar_rate</span>.<span class="ruby-identifier">to_f</span> 
2790:         <span class="ruby-ivar">@format_for03</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;10$$$&gt;&quot;</span>,<span class="ruby-ivar">@total</span>,<span class="ruby-ivar">@format_for03</span>) 
2791:         <span class="ruby-comment cmt">#需预缴的费用 空缺 ###</span>
2792:         <span class="ruby-comment cmt">#</span>
2793:         <span class="ruby-comment cmt">#立案费</span>
2794:         <span class="ruby-ivar">@arbitration_fee</span> = <span class="ruby-value">10000</span>
2795:         <span class="ruby-ivar">@format_for03</span> = <span class="ruby-identifier">add_record</span>(<span class="ruby-value str">&quot;&lt;12$$$&gt;&quot;</span>,<span class="ruby-ivar">@arbitration_fee</span>,<span class="ruby-ivar">@format_for03</span>)
2796:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000195" class="method-detail">
        <a name="M000195"></a>

        <div class="method-heading">
          <a href="#M000195" class="method-signature">
          <span class="method-name">independent_arbitrator</span><span class="method-args">(code)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
获取案件独立仲裁员
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000195-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000195-source">
<pre>
      <span class="ruby-comment cmt"># File app/controllers/format_letter_controller.rb, line 2903</span>
2903:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">independent_arbitrator</span>(<span class="ruby-identifier">code</span>)
2904:         <span class="ruby-ivar">@case_arbitman</span> = <span class="ruby-constant">TbCasearbitman</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:first</span>, <span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">&quot;used = 'Y' and recevice_code = ? and arbitmantype = '0001'&quot;</span>,<span class="ruby-identifier">code</span>])
2905:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@case_arbitman</span> <span class="ruby-operator">!=</span> <span class="ruby-keyword kw">nil</span>
2906:             <span class="ruby-identifier">arbitman_code</span> = <span class="ruby-ivar">@case_arbitman</span>.<span class="ruby-identifier">arbitman</span>
2907:             <span class="ruby-identifier">independent_arbitrator</span> = <span class="ruby-constant">TbArbitman</span>.<span class="ruby-identifier">find</span>([<span class="ruby-value str">&quot;used = 'Y' and code = ? &quot;</span>,<span class="ruby-identifier">arbitman_code</span>])
2908:             <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">independent_arbitrator</span> <span class="ruby-operator">!=</span> <span class="ruby-keyword kw">nil</span>
2909:                 <span class="ruby-identifier">independent_arbitrator</span> = <span class="ruby-identifier">independent_arbitrator</span>.<span class="ruby-identifier">name</span>
2910:             <span class="ruby-keyword kw">else</span>
2911:                 <span class="ruby-identifier">independent_arbitrator</span> = <span class="ruby-value str">&quot;no&quot;</span>
2912:             <span class="ruby-keyword kw">end</span>
2913:         <span class="ruby-keyword kw">else</span>
2914:             <span class="ruby-identifier">independent_arbitrator</span> = <span class="ruby-value str">&quot;no&quot;</span>
2915:         <span class="ruby-keyword kw">end</span>
2916:         <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">independent_arbitrator</span> 
2917:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000191" class="method-detail">
        <a name="M000191"></a>

        <div class="method-heading">
          <a href="#M000191" class="method-signature">
          <span class="method-name">num_papers</span><span class="method-args">(num_people)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
得到提交文书的份数
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000191-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000191-source">
<pre>
      <span class="ruby-comment cmt"># File app/controllers/format_letter_controller.rb, line 2849</span>
2849:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">num_papers</span>(<span class="ruby-identifier">num_people</span>)
2850:         <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">num_people</span>.<span class="ruby-identifier">to_i</span> <span class="ruby-operator">+</span> <span class="ruby-value">4</span>
2851:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000190" class="method-detail">
        <a name="M000190"></a>

        <div class="method-heading">
          <a href="#M000190" class="method-signature">
          <span class="method-name">respondent_arbit_fee</span><span class="method-args">(code)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
被申请人处理费、仲裁费
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000190-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000190-source">
<pre>
      <span class="ruby-comment cmt"># File app/controllers/format_letter_controller.rb, line 2841</span>
2841:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">respondent_arbit_fee</span>(<span class="ruby-identifier">code</span>)
2842:         <span class="ruby-ivar">@respondent_arbit_fee</span> = <span class="ruby-constant">TbShouldCharge</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:first</span>, <span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">&quot;used = 'Y' and recevice_code = ? and typ = '0001' and payment = '0002'&quot;</span>,<span class="ruby-identifier">code</span>])  
2843:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@respondent_arbit_fee</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span>
2844:             <span class="ruby-keyword kw">return</span> <span class="ruby-value str">&quot;no&quot;</span>
2845:         <span class="ruby-keyword kw">end</span>         
2846:         <span class="ruby-keyword kw">return</span> <span class="ruby-ivar">@respondent_arbit_fee</span>.<span class="ruby-identifier">rmb_money</span>
2847:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000194" class="method-detail">
        <a name="M000194"></a>

        <div class="method-heading">
          <a href="#M000194" class="method-signature">
          <span class="method-name">respondent_arbitrator</span><span class="method-args">(code)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
获取案件被申请人仲裁员
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000194-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000194-source">
<pre>
      <span class="ruby-comment cmt"># File app/controllers/format_letter_controller.rb, line 2886</span>
2886:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">respondent_arbitrator</span>(<span class="ruby-identifier">code</span>)
2887:         <span class="ruby-ivar">@case_arbitman</span> = <span class="ruby-constant">TbCasearbitman</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:first</span>, <span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">&quot;used = 'Y' and recevice_code = ? and arbitmantype = '0004'&quot;</span>,<span class="ruby-identifier">code</span>])
2888:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@case_arbitman</span> <span class="ruby-operator">!=</span> <span class="ruby-keyword kw">nil</span>
2889:             <span class="ruby-identifier">arbitman_code</span> = <span class="ruby-ivar">@case_arbitman</span>.<span class="ruby-identifier">arbitman</span>
2890:             <span class="ruby-identifier">respondent_arbitrator</span> = <span class="ruby-constant">TbArbitman</span>.<span class="ruby-identifier">find</span>([<span class="ruby-value str">&quot;used = 'Y' and code = ? &quot;</span>,<span class="ruby-identifier">arbitman_code</span>])
2891:             <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">respondent_arbitrator</span> <span class="ruby-operator">!=</span> <span class="ruby-keyword kw">nil</span>
2892:                 <span class="ruby-identifier">respondent_arbitrator</span> = <span class="ruby-identifier">respondent_arbitrator</span>.<span class="ruby-identifier">name</span>
2893:             <span class="ruby-keyword kw">else</span>
2894:                 <span class="ruby-identifier">respondent_arbitrator</span> = <span class="ruby-value str">&quot;no&quot;</span>
2895:             <span class="ruby-keyword kw">end</span>
2896:         <span class="ruby-keyword kw">else</span>
2897:             <span class="ruby-identifier">respondent_arbitrator</span> = <span class="ruby-value str">&quot;no&quot;</span>
2898:         <span class="ruby-keyword kw">end</span>
2899:         <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">respondent_arbitrator</span> 
2900:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000188" class="method-detail">
        <a name="M000188"></a>

        <div class="method-heading">
          <a href="#M000188" class="method-signature">
          <span class="method-name">respondent_litigation_fee</span><span class="method-args">(code)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
被申请人受理费
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000188-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000188-source">
<pre>
      <span class="ruby-comment cmt"># File app/controllers/format_letter_controller.rb, line 2825</span>
2825:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">respondent_litigation_fee</span>(<span class="ruby-identifier">code</span>)
2826:         <span class="ruby-ivar">@respondent_litigation_fee</span> = <span class="ruby-constant">TbShouldCharge</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:first</span>, <span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">&quot;used = 'Y' and recevice_code = ? and typ = '0001' and payment = '0002'&quot;</span>,<span class="ruby-identifier">code</span>])  
2827:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@respondent_litigation_fee</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span>
2828:             <span class="ruby-keyword kw">return</span> <span class="ruby-value str">&quot;no&quot;</span>
2829:         <span class="ruby-keyword kw">end</span>        
2830:         <span class="ruby-keyword kw">return</span> <span class="ruby-ivar">@respondent_litigation_fee</span>.<span class="ruby-identifier">rmb_money</span>
2831:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000139" class="method-detail">
        <a name="M000139"></a>

        <div class="method-heading">
          <a href="#M000139" class="method-signature">
          <span class="method-name">show</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000139-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000139-source">
<pre>
   <span class="ruby-comment cmt"># File app/controllers/format_letter_controller.rb, line 5</span>
5:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">show</span>
6:         <span class="ruby-ivar">@func</span> = <span class="ruby-value str">&quot;format_letter_&quot;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">params</span>[<span class="ruby-identifier">:letter_id</span>]
7:         <span class="ruby-ivar">@format_letter_str</span> = <span class="ruby-identifier">format_letter_dfmt31</span>
8:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000140" class="method-detail">
        <a name="M000140"></a>

        <div class="method-heading">
          <a href="#M000140" class="method-signature">
          <span class="method-name">up_doc</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000140-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000140-source">
<pre>
    <span class="ruby-comment cmt"># File app/controllers/format_letter_controller.rb, line 10</span>
10:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">up_doc</span>
11:         <span class="ruby-identifier">utf8_to_gbk</span>  = <span class="ruby-constant">Iconv</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value str">'gbk'</span>,<span class="ruby-value str">'utf-8'</span>)  <span class="ruby-comment cmt">#Iconv 编码转换</span>
12:         <span class="ruby-identifier">gbk_to_utf8</span> = <span class="ruby-constant">Iconv</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value str">'utf-8'</span>,<span class="ruby-value str">'gbk'</span>)
13:         <span class="ruby-identifier">f_name</span> = <span class="ruby-identifier">params</span>[<span class="ruby-value str">&quot;FileData&quot;</span>].<span class="ruby-identifier">original_filename</span>  <span class="ruby-comment cmt">#</span>
14:         <span class="ruby-identifier">file</span> = <span class="ruby-identifier">params</span>[<span class="ruby-value str">&quot;FileData&quot;</span>]  
15:         <span class="ruby-keyword kw">if</span> <span class="ruby-operator">!</span><span class="ruby-constant">File</span>.<span class="ruby-identifier">exists?</span>(<span class="ruby-node">&quot;#{RAILS_ROOT}/public/files&quot;</span>)
16:             <span class="ruby-constant">Dir</span>.<span class="ruby-identifier">mkdir</span>(<span class="ruby-node">&quot;#{RAILS_ROOT}/public/files/&quot;</span>)  
17:         <span class="ruby-keyword kw">end</span>
18:         <span class="ruby-identifier">content</span> = <span class="ruby-identifier">file</span>.<span class="ruby-identifier">read</span>  <span class="ruby-comment cmt">#gbk_to_utf8.iconv</span>
19:         <span class="ruby-identifier">f</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value str">&quot;F:\\mytest\\zc\\public\\&quot;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">f_name</span>, <span class="ruby-value str">&quot;wb&quot;</span>)
20:         <span class="ruby-identifier">f</span>.<span class="ruby-identifier">write</span>(<span class="ruby-identifier">content</span>)
21:         <span class="ruby-identifier">f</span>.<span class="ruby-identifier">close</span>
22:         <span class="ruby-keyword kw">if</span> <span class="ruby-operator">!</span><span class="ruby-identifier">file</span>.<span class="ruby-identifier">original_filename</span>.<span class="ruby-identifier">empty?</span>             
23:             <span class="ruby-identifier">flash</span>[<span class="ruby-identifier">:notice</span>] = <span class="ruby-value str">&quot;上传成功！&quot;</span>
24:         <span class="ruby-keyword kw">end</span>
25:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>


    </div>


  </div>


<div id="validator-badges">
  <p><small><a href="http://validator.w3.org/check/referer">[Validate]</a></small></p>
</div>

</body>
</html>